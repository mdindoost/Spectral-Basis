/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
Downloading https://github.com/shchur/gnn-benchmark/raw/master/data/npz/amazon_electronics_computers.npz
Processing...
Done!
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
======================================================================
INVESTIGATION 2: DIRECTIONS A & B - AMAZON-COMPUTERS
======================================================================
Device: cuda
GPU: NVIDIA GeForce RTX 4070 Ti SUPER
GPU Memory: 15.56 GB
Random splits: No (fixed benchmark)
======================================================================

[1/6] Loading amazon-computers...
Creating 60/20/20 split for amazon-computers...

Dataset Statistics:
  Nodes: 13,752
  Edges: 491,722
  Classes: 10
  Raw feature dimension: 767
  Train: 8,251 (60.0%)
  Val: 2,750 (20.0%)
  Test: 2,751 (20.0%)

[2/6] Building graph matrices...
Adjacency: (13752, 13752), nnz=505,474
Laplacian: (13752, 13752)
Degree matrix: (13752, 13752)

[3/6] Computing X-restricted eigenvectors...
Performing QR decomposition on X...
Original dimension: 767
Effective rank: 767/767
âœ“ Full rank - no dimension reduction needed
Computing projected matrices (Q^T L Q, Q^T D Q)...
Reduced Laplacian: (767, 767)
Reduced degree matrix: (767, 767)
Solving generalized eigenproblem in R^767...
Eigenvalue range: [0.055848, 1.185627]
Restricted eigenvectors U: (13752, 767)
D-orthonormality check: max |U^T D U - I| = 4.39e-09
âœ“ Excellent D-orthonormality

[4/6] Preparing data splits...

[5/6] Training 3 models (Directions A & B)...
Total runs: 15 = 3(models) Ã— 5(seeds)
Batch size: 128 (dataset has 8251 training samples)

======================================================================
USING FIXED BENCHMARK SPLITS
======================================================================
Train: 8,251 | Val: 2,750 | Test: 2,751
Parameter-to-sample ratio: 32.1:1
âš ï¸  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 1/1, Seed 1/5 (seed=0) ---

Training: (a) Standard MLP on X (scaled)...
  âœ“ Test acc: 0.8121 | Final val: 0.8095 | Ep20 val: 0.8098

Training: (b) Standard MLP on V (scaled)...
  ðŸ” This is experiment (b) - isolates pure basis effect!
  âœ“ Test acc: 0.7943 | Final val: 0.7749 | Ep20 val: 0.7756

Training: (c) RowNorm MLP on V (unscaled)...
  âœ“ Test acc: 0.7717 | Final val: 0.7760 | Ep20 val: 0.7771

--- Seed 1 Summary ---
  (a) Standard X: 0.8121
  (b) Standard V: 0.7943  [Diff from (a): -1.78%]
  (c) RowNorm V:  0.7717  [Diff from (b): -2.25%]
  â†’ Basis effect (a vs b): 2.2% difference
  â†’ RowNorm hurts: -2.8%

--- Split 1/1, Seed 2/5 (seed=1) ---

Training: (a) Standard MLP on X (scaled)...
  âœ“ Test acc: 0.7961 | Final val: 0.7844 | Ep20 val: 0.8120

Training: (b) Standard MLP on V (scaled)...
  ðŸ” This is experiment (b) - isolates pure basis effect!
  âœ“ Test acc: 0.8015 | Final val: 0.7927 | Ep20 val: 0.7731

Training: (c) RowNorm MLP on V (unscaled)...
  âœ“ Test acc: 0.7830 | Final val: 0.7669 | Ep20 val: 0.7880

--- Seed 2 Summary ---
  (a) Standard X: 0.7961
  (b) Standard V: 0.8015  [Diff from (a): +0.55%]
  (c) RowNorm V:  0.7830  [Diff from (b): -1.85%]
  â†’ Basis effect minimal: 0.7% difference
  â†’ RowNorm hurts: -2.3%

--- Split 1/1, Seed 3/5 (seed=2) ---

Training: (a) Standard MLP on X (scaled)...
  âœ“ Test acc: 0.8099 | Final val: 0.8091 | Ep20 val: 0.8135

Training: (b) Standard MLP on V (scaled)...
  ðŸ” This is experiment (b) - isolates pure basis effect!
  âœ“ Test acc: 0.8055 | Final val: 0.7931 | Ep20 val: 0.7771

Training: (c) RowNorm MLP on V (unscaled)...
  âœ“ Test acc: 0.7684 | Final val: 0.7629 | Ep20 val: 0.7804

--- Seed 3 Summary ---
  (a) Standard X: 0.8099
  (b) Standard V: 0.8055  [Diff from (a): -0.44%]
  (c) RowNorm V:  0.7684  [Diff from (b): -3.71%]
  â†’ Basis effect minimal: 0.5% difference
  â†’ RowNorm hurts: -4.6%

--- Split 1/1, Seed 4/5 (seed=3) ---

Training: (a) Standard MLP on X (scaled)...
  âœ“ Test acc: 0.7990 | Final val: 0.8000 | Ep20 val: 0.8262

Training: (b) Standard MLP on V (scaled)...
  ðŸ” This is experiment (b) - isolates pure basis effect!
  âœ“ Test acc: 0.7917 | Final val: 0.7785 | Ep20 val: 0.7713

Training: (c) RowNorm MLP on V (unscaled)...
  âœ“ Test acc: 0.7932 | Final val: 0.7840 | Ep20 val: 0.7760

--- Seed 4 Summary ---
  (a) Standard X: 0.7990
  (b) Standard V: 0.7917  [Diff from (a): -0.73%]
  (c) RowNorm V:  0.7932  [Diff from (b): +0.15%]
  â†’ Basis effect minimal: 0.9% difference
  â†’ RowNorm helps: +0.2%

--- Split 1/1, Seed 5/5 (seed=4) ---

Training: (a) Standard MLP on X (scaled)...
  âœ“ Test acc: 0.8073 | Final val: 0.8109 | Ep20 val: 0.8313

Training: (b) Standard MLP on V (scaled)...
  ðŸ” This is experiment (b) - isolates pure basis effect!
  âœ“ Test acc: 0.7961 | Final val: 0.7851 | Ep20 val: 0.7760

Training: (c) RowNorm MLP on V (unscaled)...
  âœ“ Test acc: 0.7757 | Final val: 0.7775 | Ep20 val: 0.7891

--- Seed 5 Summary ---
  (a) Standard X: 0.8073
  (b) Standard V: 0.7961  [Diff from (a): -1.13%]
  (c) RowNorm V:  0.7757  [Diff from (b): -2.04%]
  â†’ Basis effect (a vs b): 1.4% difference
  â†’ RowNorm hurts: -2.6%

[6/6] Aggregating results and generating outputs...
Aggregating: (a) Standard MLP on X (scaled)...
Aggregating: (b) Standard MLP on V (scaled)...
Aggregating: (c) RowNorm MLP on V (unscaled)...

âœ“ Saved aggregated metrics: results/investigation2_directions_AB/amazon-computers/fixed_splits/metrics/results_aggregated.json

======================================================================
FINAL SUMMARY
======================================================================
Dataset: amazon-computers
Split type: fixed_splits
Raw feature dimension: 767
Effective dimension (after QR): 767
span(U) = span(X) â€” same subspace, different basis
D-orthonormality: max |U^T D U - I| = 4.39e-09
Hidden dimension: 256
Epochs: 200
Total runs per model: 5

======================================================================
TEST ACCURACY RESULTS (Mean Â± Std)
======================================================================
(a) Standard MLP on X (scaled):  80.49Â±0.62%
(b) Standard MLP on V (scaled):  79.78Â±0.50%
(c) RowNorm MLP on V (unscaled): 77.84Â±0.88%

======================================================================
DIRECTION B: BASIS SENSITIVITY (a vs b)
======================================================================
Same model (Standard MLP), same preprocessing (StandardScaler)
Only difference: coordinate system (X vs V)

Basis Effect: -0.0071 (-0.9%)
â—‹ Minimal basis sensitivity for this dataset

======================================================================
DIRECTION A: MODEL SENSITIVITY (b vs c)
======================================================================
Same basis (V), different models
Question: Does RowNorm help on restricted eigenvectors?

Model Effect: -0.0194 (-2.4%)
âœ— RowNorm does NOT help on restricted eigenvectors

======================================================================
EFFECT INDEPENDENCE
======================================================================
Basis effect (aâ†’b):        -0.88%
Model effect (bâ†’c):        -2.43%
Expected combined:         -3.31%
Observed combined (aâ†’c):   -3.29%
Interaction term:          +0.02%

âœ“ Effects are ADDITIVE (independent)

======================================================================
âœ“ Investigation 2 Directions A&B complete for amazon-computers!
âœ“ Results saved to: results/investigation2_directions_AB/amazon-computers/fixed_splits/
======================================================================
