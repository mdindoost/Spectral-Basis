/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
Downloading https://github.com/shchur/gnn-benchmark/raw/master/data/npz/ms_academic_phy.npz
Processing...
Done!
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
======================================================================
INVESTIGATION 2: DIRECTIONS A & B - COAUTHOR-PHYSICS
======================================================================
Device: cuda
GPU: NVIDIA GeForce RTX 4070 Ti SUPER
GPU Memory: 15.56 GB
Random splits: No (fixed benchmark)
======================================================================

[1/6] Loading coauthor-physics...
Creating 60/20/20 split for coauthor-physics...

Dataset Statistics:
  Nodes: 34,493
  Edges: 495,924
  Classes: 5
  Raw feature dimension: 8415
  Train: 20,695 (60.0%)
  Val: 6,898 (20.0%)
  Test: 6,900 (20.0%)

[2/6] Building graph matrices...
Adjacency: (34493, 34493), nnz=530,417
Laplacian: (34493, 34493)
Degree matrix: (34493, 34493)

[3/6] Computing X-restricted eigenvectors...
Performing QR decomposition on X...
Original dimension: 8415
Effective rank: 7701/8415
âš ï¸  Rank deficiency detected: 714 dimensions removed
Computing projected matrices (Q^T L Q, Q^T D Q)...
Reduced Laplacian: (7701, 7701)
Reduced degree matrix: (7701, 7701)
Solving generalized eigenproblem in R^7701...
Eigenvalue range: [0.061744, 1.289481]
Restricted eigenvectors U: (34493, 7701)
D-orthonormality check: max |U^T D U - I| = 7.61e-08
âœ“ Excellent D-orthonormality

[4/6] Preparing data splits...

[5/6] Training 3 models (Directions A & B)...
Total runs: 15 = 3(models) Ã— 5(seeds)
Batch size: 128 (dataset has 20695 training samples)

======================================================================
USING FIXED BENCHMARK SPLITS
======================================================================
Train: 20,695 | Val: 6,898 | Test: 6,900
Parameter-to-sample ratio: 98.5:1
âš ï¸  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 1/1, Seed 1/5 (seed=0) ---

Training: (a) Standard MLP on X (scaled)...
  âœ“ Test acc: 0.9336 | Final val: 0.9353 | Ep20 val: 0.9282

Training: (b) Standard MLP on V (scaled)...
  ðŸ” This is experiment (b) - isolates pure basis effect!
  âœ“ Test acc: 0.7713 | Final val: 0.7708 | Ep20 val: 0.7622

Training: (c) RowNorm MLP on V (unscaled)...
  âœ“ Test acc: 0.7959 | Final val: 0.7850 | Ep20 val: 0.7834

--- Seed 1 Summary ---
  (a) Standard X: 0.9336
  (b) Standard V: 0.7713  [Diff from (a): -16.23%]
  (c) RowNorm V:  0.7959  [Diff from (b): +2.46%]
  â†’ Basis effect (a vs b): 17.4% difference
  â†’ RowNorm helps: +3.2%

--- Split 1/1, Seed 2/5 (seed=1) ---

Training: (a) Standard MLP on X (scaled)...
  âœ“ Test acc: 0.9304 | Final val: 0.9319 | Ep20 val: 0.9317

Training: (b) Standard MLP on V (scaled)...
  ðŸ” This is experiment (b) - isolates pure basis effect!
  âœ“ Test acc: 0.7680 | Final val: 0.7752 | Ep20 val: 0.7641

Training: (c) RowNorm MLP on V (unscaled)...
  âœ“ Test acc: 0.7874 | Final val: 0.7854 | Ep20 val: 0.7902

--- Seed 2 Summary ---
  (a) Standard X: 0.9304
  (b) Standard V: 0.7680  [Diff from (a): -16.25%]
  (c) RowNorm V:  0.7874  [Diff from (b): +1.94%]
  â†’ Basis effect (a vs b): 17.5% difference
  â†’ RowNorm helps: +2.5%

--- Split 1/1, Seed 3/5 (seed=2) ---

Training: (a) Standard MLP on X (scaled)...
  âœ“ Test acc: 0.9335 | Final val: 0.9375 | Ep20 val: 0.9314

Training: (b) Standard MLP on V (scaled)...
  ðŸ” This is experiment (b) - isolates pure basis effect!
  âœ“ Test acc: 0.7862 | Final val: 0.7757 | Ep20 val: 0.7675

Training: (c) RowNorm MLP on V (unscaled)...
  âœ“ Test acc: 0.7868 | Final val: 0.7836 | Ep20 val: 0.7840

--- Seed 3 Summary ---
  (a) Standard X: 0.9335
  (b) Standard V: 0.7862  [Diff from (a): -14.72%]
  (c) RowNorm V:  0.7868  [Diff from (b): +0.06%]
  â†’ Basis effect (a vs b): 15.8% difference
  â†’ RowNorm helps: +0.1%

--- Split 1/1, Seed 4/5 (seed=3) ---

Training: (a) Standard MLP on X (scaled)...
  âœ“ Test acc: 0.9346 | Final val: 0.9335 | Ep20 val: 0.9361

Training: (b) Standard MLP on V (scaled)...
  ðŸ” This is experiment (b) - isolates pure basis effect!
  âœ“ Test acc: 0.7700 | Final val: 0.7685 | Ep20 val: 0.7725

Training: (c) RowNorm MLP on V (unscaled)...
  âœ“ Test acc: 0.7870 | Final val: 0.7863 | Ep20 val: 0.7882

--- Seed 4 Summary ---
  (a) Standard X: 0.9346
  (b) Standard V: 0.7700  [Diff from (a): -16.46%]
  (c) RowNorm V:  0.7870  [Diff from (b): +1.70%]
  â†’ Basis effect (a vs b): 17.6% difference
  â†’ RowNorm helps: +2.2%

--- Split 1/1, Seed 5/5 (seed=4) ---

Training: (a) Standard MLP on X (scaled)...
  âœ“ Test acc: 0.9306 | Final val: 0.9335 | Ep20 val: 0.9293

Training: (b) Standard MLP on V (scaled)...
  ðŸ” This is experiment (b) - isolates pure basis effect!
  âœ“ Test acc: 0.7570 | Final val: 0.7496 | Ep20 val: 0.7511

Training: (c) RowNorm MLP on V (unscaled)...
  âœ“ Test acc: 0.7899 | Final val: 0.7882 | Ep20 val: 0.7820

--- Seed 5 Summary ---
  (a) Standard X: 0.9306
  (b) Standard V: 0.7570  [Diff from (a): -17.36%]
  (c) RowNorm V:  0.7899  [Diff from (b): +3.29%]
  â†’ Basis effect (a vs b): 18.7% difference
  â†’ RowNorm helps: +4.3%

[6/6] Aggregating results and generating outputs...
Aggregating: (a) Standard MLP on X (scaled)...
Aggregating: (b) Standard MLP on V (scaled)...
Aggregating: (c) RowNorm MLP on V (unscaled)...

âœ“ Saved aggregated metrics: results/investigation2_directions_AB/coauthor-physics/fixed_splits/metrics/results_aggregated.json

======================================================================
FINAL SUMMARY
======================================================================
Dataset: coauthor-physics
Split type: fixed_splits
Raw feature dimension: 8415
Effective dimension (after QR): 7701
Rank deficiency handled: 8415 â†’ 7701
span(U) = span(X) â€” same subspace, different basis
D-orthonormality: max |U^T D U - I| = 7.61e-08
Hidden dimension: 256
Epochs: 200
Total runs per model: 5

======================================================================
TEST ACCURACY RESULTS (Mean Â± Std)
======================================================================
(a) Standard MLP on X (scaled):  93.26Â±0.17%
(b) Standard MLP on V (scaled):  77.05Â±0.94%
(c) RowNorm MLP on V (unscaled): 78.94Â±0.35%

======================================================================
DIRECTION B: BASIS SENSITIVITY (a vs b)
======================================================================
Same model (Standard MLP), same preprocessing (StandardScaler)
Only difference: coordinate system (X vs V)

Basis Effect: -0.1621 (-17.4%)
âœ“ SIGNIFICANT basis sensitivity detected
  â†’ MLPs are sensitive to basis representation!

======================================================================
DIRECTION A: MODEL SENSITIVITY (b vs c)
======================================================================
Same basis (V), different models
Question: Does RowNorm help on restricted eigenvectors?

Model Effect: +0.0189 (+2.5%)
âœ“ RowNorm advantage persists on restricted eigenvectors

======================================================================
EFFECT INDEPENDENCE
======================================================================
Basis effect (aâ†’b):       -17.38%
Model effect (bâ†’c):        +2.45%
Expected combined:        -14.93%
Observed combined (aâ†’c):  -15.35%
Interaction term:          -0.43%

âœ“ Effects are ADDITIVE (independent)

======================================================================
âœ“ Investigation 2 Directions A&B complete for coauthor-physics!
âœ“ Results saved to: results/investigation2_directions_AB/coauthor-physics/fixed_splits/
======================================================================
