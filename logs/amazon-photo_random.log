/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
======================================================================
INVESTIGATION 2: DIRECTIONS A & B - AMAZON-PHOTO
======================================================================
Device: cuda
GPU: NVIDIA GeForce RTX 4070 Ti SUPER
GPU Memory: 15.56 GB
Random splits: Yes
======================================================================

[1/6] Loading amazon-photo...
Creating 60/20/20 split for amazon-photo...

Dataset Statistics:
  Nodes: 7,650
  Edges: 238,162
  Classes: 8
  Raw feature dimension: 745
  Train: 4,590 (60.0%)
  Val: 1,530 (20.0%)
  Test: 1,530 (20.0%)

[2/6] Building graph matrices...
Adjacency: (7650, 7650), nnz=245,812
Laplacian: (7650, 7650)
Degree matrix: (7650, 7650)

[3/6] Computing X-restricted eigenvectors...
Performing QR decomposition on X...
Original dimension: 745
Effective rank: 745/745
✓ Full rank - no dimension reduction needed
Computing projected matrices (Q^T L Q, Q^T D Q)...
Reduced Laplacian: (745, 745)
Reduced degree matrix: (745, 745)
Solving generalized eigenproblem in R^745...
Eigenvalue range: [0.051523, 1.214182]
Restricted eigenvectors U: (7650, 745)
D-orthonormality check: max |U^T D U - I| = 9.02e-09
✓ Excellent D-orthonormality

[4/6] Preparing data splits...

[5/6] Training 3 models (Directions A & B)...
Across 5 random splits × 5 seeds
Total runs: 75 = 3(models) × 5(seeds) × 5(splits)
Batch size: 128 (dataset has 4590 training samples)

======================================================================
RANDOM SPLIT 1/5
======================================================================
Train: 4,590 | Val: 1,530 | Test: 1,530
Parameter-to-sample ratio: 56.3:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 1/5, Seed 1/5 (seed=0) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8529 | Final val: 0.8641 | Ep20 val: 0.8830

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8667 | Final val: 0.8869 | Ep20 val: 0.8216

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8203 | Final val: 0.8203 | Ep20 val: 0.8118

--- Seed 1 Summary ---
  (a) Standard X: 0.8529
  (b) Standard V: 0.8667  [Diff from (a): +1.37%]
  (c) RowNorm V:  0.8203  [Diff from (b): -4.64%]
  → Basis effect (a vs b): 1.6% difference
  → RowNorm hurts: -5.4%

--- Split 1/5, Seed 2/5 (seed=1) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8791 | Final val: 0.8980 | Ep20 val: 0.8876

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8562 | Final val: 0.8667 | Ep20 val: 0.8052

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8190 | Final val: 0.8268 | Ep20 val: 0.8268

--- Seed 2 Summary ---
  (a) Standard X: 0.8791
  (b) Standard V: 0.8562  [Diff from (a): -2.29%]
  (c) RowNorm V:  0.8190  [Diff from (b): -3.73%]
  → Basis effect (a vs b): 2.6% difference
  → RowNorm hurts: -4.4%

--- Split 1/5, Seed 3/5 (seed=2) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8824 | Final val: 0.8993 | Ep20 val: 0.8889

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8353 | Final val: 0.8314 | Ep20 val: 0.8176

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8013 | Final val: 0.8255 | Ep20 val: 0.8170

--- Seed 3 Summary ---
  (a) Standard X: 0.8824
  (b) Standard V: 0.8353  [Diff from (a): -4.71%]
  (c) RowNorm V:  0.8013  [Diff from (b): -3.40%]
  → Basis effect (a vs b): 5.3% difference
  → RowNorm hurts: -4.1%

--- Split 1/5, Seed 4/5 (seed=3) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8889 | Final val: 0.9039 | Ep20 val: 0.8876

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8386 | Final val: 0.8503 | Ep20 val: 0.8268

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8072 | Final val: 0.8144 | Ep20 val: 0.8105

--- Seed 4 Summary ---
  (a) Standard X: 0.8889
  (b) Standard V: 0.8386  [Diff from (a): -5.03%]
  (c) RowNorm V:  0.8072  [Diff from (b): -3.14%]
  → Basis effect (a vs b): 5.7% difference
  → RowNorm hurts: -3.7%

--- Split 1/5, Seed 5/5 (seed=4) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8686 | Final val: 0.8915 | Ep20 val: 0.8993

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8425 | Final val: 0.8497 | Ep20 val: 0.8203

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8105 | Final val: 0.8255 | Ep20 val: 0.8209

--- Seed 5 Summary ---
  (a) Standard X: 0.8686
  (b) Standard V: 0.8425  [Diff from (a): -2.61%]
  (c) RowNorm V:  0.8105  [Diff from (b): -3.20%]
  → Basis effect (a vs b): 3.0% difference
  → RowNorm hurts: -3.8%

======================================================================
RANDOM SPLIT 2/5
======================================================================
Train: 4,590 | Val: 1,530 | Test: 1,530
Parameter-to-sample ratio: 56.3:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 2/5, Seed 1/5 (seed=5) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9013 | Final val: 0.8843 | Ep20 val: 0.8608

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8680 | Final val: 0.8725 | Ep20 val: 0.8131

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8092 | Final val: 0.8183 | Ep20 val: 0.8144

--- Seed 1 Summary ---
  (a) Standard X: 0.9013
  (b) Standard V: 0.8680  [Diff from (a): -3.33%]
  (c) RowNorm V:  0.8092  [Diff from (b): -5.88%]
  → Basis effect (a vs b): 3.7% difference
  → RowNorm hurts: -6.8%

--- Split 2/5, Seed 2/5 (seed=6) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.3490 | Final val: 0.3203 | Ep20 val: 0.8863

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8686 | Final val: 0.8765 | Ep20 val: 0.8131

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8111 | Final val: 0.8190 | Ep20 val: 0.8033

--- Seed 2 Summary ---
  (a) Standard X: 0.3490
  (b) Standard V: 0.8686  [Diff from (a): +51.96%]
  (c) RowNorm V:  0.8111  [Diff from (b): -5.75%]
  → Basis effect (a vs b): 148.9% difference
  → RowNorm hurts: -6.6%

--- Split 2/5, Seed 3/5 (seed=7) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8961 | Final val: 0.8745 | Ep20 val: 0.8359

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8183 | Final val: 0.8288 | Ep20 val: 0.7987

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8157 | Final val: 0.8229 | Ep20 val: 0.8314

--- Seed 3 Summary ---
  (a) Standard X: 0.8961
  (b) Standard V: 0.8183  [Diff from (a): -7.78%]
  (c) RowNorm V:  0.8157  [Diff from (b): -0.26%]
  → Basis effect (a vs b): 8.7% difference
  → RowNorm hurts: -0.3%

--- Split 2/5, Seed 4/5 (seed=8) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9033 | Final val: 0.8856 | Ep20 val: 0.8745

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8634 | Final val: 0.8614 | Ep20 val: 0.8007

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7954 | Final val: 0.7954 | Ep20 val: 0.8170

--- Seed 4 Summary ---
  (a) Standard X: 0.9033
  (b) Standard V: 0.8634  [Diff from (a): -3.99%]
  (c) RowNorm V:  0.7954  [Diff from (b): -6.80%]
  → Basis effect (a vs b): 4.4% difference
  → RowNorm hurts: -7.9%

--- Split 2/5, Seed 5/5 (seed=9) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8974 | Final val: 0.8686 | Ep20 val: 0.8627

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8431 | Final val: 0.8588 | Ep20 val: 0.7869

Training: (c) RowNorm MLP on V (unscaled)...
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
  ✓ Test acc: 0.7889 | Final val: 0.7745 | Ep20 val: 0.8065

--- Seed 5 Summary ---
  (a) Standard X: 0.8974
  (b) Standard V: 0.8431  [Diff from (a): -5.42%]
  (c) RowNorm V:  0.7889  [Diff from (b): -5.42%]
  → Basis effect (a vs b): 6.0% difference
  → RowNorm hurts: -6.4%

======================================================================
RANDOM SPLIT 3/5
======================================================================
Train: 4,590 | Val: 1,530 | Test: 1,530
Parameter-to-sample ratio: 56.3:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 3/5, Seed 1/5 (seed=10) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8876 | Final val: 0.8758 | Ep20 val: 0.8516

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8144 | Final val: 0.7993 | Ep20 val: 0.7876

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8137 | Final val: 0.8052 | Ep20 val: 0.8111

--- Seed 1 Summary ---
  (a) Standard X: 0.8876
  (b) Standard V: 0.8144  [Diff from (a): -7.32%]
  (c) RowNorm V:  0.8137  [Diff from (b): -0.07%]
  → Basis effect (a vs b): 8.2% difference
  → RowNorm hurts: -0.1%

--- Split 3/5, Seed 2/5 (seed=11) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.4340 | Final val: 0.4190 | Ep20 val: 0.8980

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8497 | Final val: 0.8399 | Ep20 val: 0.8157

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7928 | Final val: 0.7856 | Ep20 val: 0.8170

--- Seed 2 Summary ---
  (a) Standard X: 0.4340
  (b) Standard V: 0.8497  [Diff from (a): +41.57%]
  (c) RowNorm V:  0.7928  [Diff from (b): -5.69%]
  → Basis effect (a vs b): 95.8% difference
  → RowNorm hurts: -6.7%

--- Split 3/5, Seed 3/5 (seed=12) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9052 | Final val: 0.8915 | Ep20 val: 0.8993

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8719 | Final val: 0.8739 | Ep20 val: 0.8118

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8098 | Final val: 0.7961 | Ep20 val: 0.8170

--- Seed 3 Summary ---
  (a) Standard X: 0.9052
  (b) Standard V: 0.8719  [Diff from (a): -3.33%]
  (c) RowNorm V:  0.8098  [Diff from (b): -6.21%]
  → Basis effect (a vs b): 3.7% difference
  → RowNorm hurts: -7.1%

--- Split 3/5, Seed 4/5 (seed=13) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9039 | Final val: 0.8908 | Ep20 val: 0.8902

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8281 | Final val: 0.8379 | Ep20 val: 0.8033

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7719 | Final val: 0.7719 | Ep20 val: 0.8268

--- Seed 4 Summary ---
  (a) Standard X: 0.9039
  (b) Standard V: 0.8281  [Diff from (a): -7.58%]
  (c) RowNorm V:  0.7719  [Diff from (b): -5.62%]
  → Basis effect (a vs b): 8.4% difference
  → RowNorm hurts: -6.8%

--- Split 3/5, Seed 5/5 (seed=14) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8974 | Final val: 0.8784 | Ep20 val: 0.8843

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8176 | Final val: 0.8065 | Ep20 val: 0.7961

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8033 | Final val: 0.8072 | Ep20 val: 0.8111

--- Seed 5 Summary ---
  (a) Standard X: 0.8974
  (b) Standard V: 0.8176  [Diff from (a): -7.97%]
  (c) RowNorm V:  0.8033  [Diff from (b): -1.44%]
  → Basis effect (a vs b): 8.9% difference
  → RowNorm hurts: -1.8%

======================================================================
RANDOM SPLIT 4/5
======================================================================
Train: 4,590 | Val: 1,530 | Test: 1,530
Parameter-to-sample ratio: 56.3:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 4/5, Seed 1/5 (seed=15) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8902 | Final val: 0.8882 | Ep20 val: 0.8686

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8523 | Final val: 0.8464 | Ep20 val: 0.8196

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8052 | Final val: 0.8268 | Ep20 val: 0.8092

--- Seed 1 Summary ---
  (a) Standard X: 0.8902
  (b) Standard V: 0.8523  [Diff from (a): -3.79%]
  (c) RowNorm V:  0.8052  [Diff from (b): -4.71%]
  → Basis effect (a vs b): 4.3% difference
  → RowNorm hurts: -5.5%

--- Split 4/5, Seed 2/5 (seed=16) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8765 | Final val: 0.8948 | Ep20 val: 0.8804

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8627 | Final val: 0.8719 | Ep20 val: 0.8000

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8098 | Final val: 0.8118 | Ep20 val: 0.8092

--- Seed 2 Summary ---
  (a) Standard X: 0.8765
  (b) Standard V: 0.8627  [Diff from (a): -1.37%]
  (c) RowNorm V:  0.8098  [Diff from (b): -5.29%]
  → Basis effect (a vs b): 1.6% difference
  → RowNorm hurts: -6.1%

--- Split 4/5, Seed 3/5 (seed=17) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9026 | Final val: 0.9033 | Ep20 val: 0.8392

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8431 | Final val: 0.8379 | Ep20 val: 0.8190

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8111 | Final val: 0.8242 | Ep20 val: 0.8203

--- Seed 3 Summary ---
  (a) Standard X: 0.9026
  (b) Standard V: 0.8431  [Diff from (a): -5.95%]
  (c) RowNorm V:  0.8111  [Diff from (b): -3.20%]
  → Basis effect (a vs b): 6.6% difference
  → RowNorm hurts: -3.8%

--- Split 4/5, Seed 4/5 (seed=18) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8915 | Final val: 0.8941 | Ep20 val: 0.9026

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7889 | Final val: 0.7758 | Ep20 val: 0.7915

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8105 | Final val: 0.8105 | Ep20 val: 0.8124

--- Seed 4 Summary ---
  (a) Standard X: 0.8915
  (b) Standard V: 0.7889  [Diff from (a): -10.26%]
  (c) RowNorm V:  0.8105  [Diff from (b): +2.16%]
  → Basis effect (a vs b): 11.5% difference
  → RowNorm helps: +2.7%

--- Split 4/5, Seed 5/5 (seed=19) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8928 | Final val: 0.8948 | Ep20 val: 0.8810

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8621 | Final val: 0.8654 | Ep20 val: 0.8020

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8098 | Final val: 0.8046 | Ep20 val: 0.8137

--- Seed 5 Summary ---
  (a) Standard X: 0.8928
  (b) Standard V: 0.8621  [Diff from (a): -3.07%]
  (c) RowNorm V:  0.8098  [Diff from (b): -5.23%]
  → Basis effect (a vs b): 3.4% difference
  → RowNorm hurts: -6.1%

======================================================================
RANDOM SPLIT 5/5
======================================================================
Train: 4,590 | Val: 1,530 | Test: 1,530
Parameter-to-sample ratio: 56.3:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 5/5, Seed 1/5 (seed=20) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8641 | Final val: 0.8621 | Ep20 val: 0.8993

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8503 | Final val: 0.8477 | Ep20 val: 0.8222

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8209 | Final val: 0.8190 | Ep20 val: 0.8098

--- Seed 1 Summary ---
  (a) Standard X: 0.8641
  (b) Standard V: 0.8503  [Diff from (a): -1.37%]
  (c) RowNorm V:  0.8209  [Diff from (b): -2.94%]
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
  → Basis effect (a vs b): 1.6% difference
  → RowNorm hurts: -3.5%

--- Split 5/5, Seed 2/5 (seed=21) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8542 | Final val: 0.8673 | Ep20 val: 0.9007

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8301 | Final val: 0.8431 | Ep20 val: 0.8222

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8072 | Final val: 0.8196 | Ep20 val: 0.8301

--- Seed 2 Summary ---
  (a) Standard X: 0.8542
  (b) Standard V: 0.8301  [Diff from (a): -2.42%]
  (c) RowNorm V:  0.8072  [Diff from (b): -2.29%]
  → Basis effect (a vs b): 2.8% difference
  → RowNorm hurts: -2.8%

--- Split 5/5, Seed 3/5 (seed=22) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8895 | Final val: 0.8987 | Ep20 val: 0.8895

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8510 | Final val: 0.8438 | Ep20 val: 0.8098

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8150 | Final val: 0.8203 | Ep20 val: 0.8111

--- Seed 3 Summary ---
  (a) Standard X: 0.8895
  (b) Standard V: 0.8510  [Diff from (a): -3.86%]
  (c) RowNorm V:  0.8150  [Diff from (b): -3.59%]
  → Basis effect (a vs b): 4.3% difference
  → RowNorm hurts: -4.2%

--- Split 5/5, Seed 4/5 (seed=23) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8895 | Final val: 0.8908 | Ep20 val: 0.8961

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.6915 | Final val: 0.6824 | Ep20 val: 0.8144

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8229 | Final val: 0.8105 | Ep20 val: 0.8163

--- Seed 4 Summary ---
  (a) Standard X: 0.8895
  (b) Standard V: 0.6915  [Diff from (a): -19.80%]
  (c) RowNorm V:  0.8229  [Diff from (b): +13.14%]
  → Basis effect (a vs b): 22.3% difference
  → RowNorm helps: +19.0%

--- Split 5/5, Seed 5/5 (seed=24) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8791 | Final val: 0.9020 | Ep20 val: 0.9026

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8621 | Final val: 0.8706 | Ep20 val: 0.8261

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.8046 | Final val: 0.8092 | Ep20 val: 0.8268

--- Seed 5 Summary ---
  (a) Standard X: 0.8791
  (b) Standard V: 0.8621  [Diff from (a): -1.70%]
  (c) RowNorm V:  0.8046  [Diff from (b): -5.75%]
  → Basis effect (a vs b): 1.9% difference
  → RowNorm hurts: -6.7%

[6/6] Aggregating results and generating outputs...
Aggregating: (a) Standard MLP on X (scaled)...
Aggregating: (b) Standard MLP on V (scaled)...
Aggregating: (c) RowNorm MLP on V (unscaled)...

✓ Saved aggregated metrics: results/investigation2_directions_AB/amazon-photo/random_splits/metrics/results_aggregated.json

======================================================================
FINAL SUMMARY
======================================================================
Dataset: amazon-photo
Split type: random_splits
Raw feature dimension: 745
Effective dimension (after QR): 745
span(U) = span(X) — same subspace, different basis
D-orthonormality: max |U^T D U - I| = 9.02e-09
Hidden dimension: 256
Epochs: 200
Total runs per model: 25

======================================================================
TEST ACCURACY RESULTS (Mean ± Std)
======================================================================
(a) Standard MLP on X (scaled):  84.71±13.56%
(b) Standard MLP on V (scaled):  83.91±3.61%
(c) RowNorm MLP on V (unscaled): 80.75±1.09%

======================================================================
DIRECTION B: BASIS SENSITIVITY (a vs b)
======================================================================
Same model (Standard MLP), same preprocessing (StandardScaler)
Only difference: coordinate system (X vs V)

Basis Effect: -0.0080 (-0.9%)
○ Minimal basis sensitivity for this dataset

======================================================================
DIRECTION A: MODEL SENSITIVITY (b vs c)
======================================================================
Same basis (V), different models
Question: Does RowNorm help on restricted eigenvectors?

Model Effect: -0.0316 (-3.8%)
✗ RowNorm does NOT help on restricted eigenvectors

======================================================================
EFFECT INDEPENDENCE
======================================================================
Basis effect (a→b):        -0.95%
Model effect (b→c):        -3.76%
Expected combined:         -4.71%
Observed combined (a→c):   -4.68%
Interaction term:          +0.04%

✓ Effects are ADDITIVE (independent)

======================================================================
✓ Investigation 2 Directions A&B complete for amazon-photo!
✓ Results saved to: results/investigation2_directions_AB/amazon-photo/random_splits/
======================================================================
