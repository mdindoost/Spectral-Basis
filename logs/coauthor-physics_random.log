/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
======================================================================
INVESTIGATION 2: DIRECTIONS A & B - COAUTHOR-PHYSICS
======================================================================
Device: cuda
GPU: NVIDIA GeForce RTX 4070 Ti SUPER
GPU Memory: 15.56 GB
Random splits: Yes
======================================================================

[1/6] Loading coauthor-physics...
Creating 60/20/20 split for coauthor-physics...

Dataset Statistics:
  Nodes: 34,493
  Edges: 495,924
  Classes: 5
  Raw feature dimension: 8415
  Train: 20,695 (60.0%)
  Val: 6,898 (20.0%)
  Test: 6,900 (20.0%)

[2/6] Building graph matrices...
Adjacency: (34493, 34493), nnz=530,417
Laplacian: (34493, 34493)
Degree matrix: (34493, 34493)

[3/6] Computing X-restricted eigenvectors...
Performing QR decomposition on X...
Original dimension: 8415
Effective rank: 7701/8415
⚠️  Rank deficiency detected: 714 dimensions removed
Computing projected matrices (Q^T L Q, Q^T D Q)...
Reduced Laplacian: (7701, 7701)
Reduced degree matrix: (7701, 7701)
Solving generalized eigenproblem in R^7701...
Eigenvalue range: [0.061744, 1.289481]
Restricted eigenvectors U: (34493, 7701)
D-orthonormality check: max |U^T D U - I| = 7.61e-08
✓ Excellent D-orthonormality

[4/6] Preparing data splits...

[5/6] Training 3 models (Directions A & B)...
Across 5 random splits × 5 seeds
Total runs: 75 = 3(models) × 5(seeds) × 5(splits)
Batch size: 128 (dataset has 20695 training samples)

======================================================================
RANDOM SPLIT 1/5
======================================================================
Train: 20,695 | Val: 6,898 | Test: 6,900
Parameter-to-sample ratio: 98.5:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 1/5, Seed 1/5 (seed=0) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9301 | Final val: 0.9361 | Ep20 val: 0.9378

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7852 | Final val: 0.7833 | Ep20 val: 0.7831

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7912 | Final val: 0.7924 | Ep20 val: 0.7894

--- Seed 1 Summary ---
  (a) Standard X: 0.9301
  (b) Standard V: 0.7852  [Diff from (a): -14.49%]
  (c) RowNorm V:  0.7912  [Diff from (b): +0.59%]
  → Basis effect (a vs b): 15.6% difference
  → RowNorm helps: +0.8%

--- Split 1/5, Seed 2/5 (seed=1) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9390 | Final val: 0.9424 | Ep20 val: 0.9303

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7888 | Final val: 0.7936 | Ep20 val: 0.7812

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7854 | Final val: 0.7860 | Ep20 val: 0.7998

--- Seed 2 Summary ---
  (a) Standard X: 0.9390
  (b) Standard V: 0.7888  [Diff from (a): -15.01%]
  (c) RowNorm V:  0.7854  [Diff from (b): -0.35%]
  → Basis effect (a vs b): 16.0% difference
  → RowNorm hurts: -0.4%

--- Split 1/5, Seed 3/5 (seed=2) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9309 | Final val: 0.9346 | Ep20 val: 0.9380

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7829 | Final val: 0.7881 | Ep20 val: 0.7763

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7906 | Final val: 0.7953 | Ep20 val: 0.7968

--- Seed 3 Summary ---
  (a) Standard X: 0.9309
  (b) Standard V: 0.7829  [Diff from (a): -14.80%]
  (c) RowNorm V:  0.7906  [Diff from (b): +0.77%]
  → Basis effect (a vs b): 15.9% difference
  → RowNorm helps: +1.0%

--- Split 1/5, Seed 4/5 (seed=3) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9378 | Final val: 0.9378 | Ep20 val: 0.9387

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7778 | Final val: 0.7827 | Ep20 val: 0.7869

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7903 | Final val: 0.7918 | Ep20 val: 0.7979

--- Seed 4 Summary ---
  (a) Standard X: 0.9378
  (b) Standard V: 0.7778  [Diff from (a): -16.00%]
  (c) RowNorm V:  0.7903  [Diff from (b): +1.25%]
  → Basis effect (a vs b): 17.1% difference
  → RowNorm helps: +1.6%

--- Split 1/5, Seed 5/5 (seed=4) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9354 | Final val: 0.9384 | Ep20 val: 0.9377

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7871 | Final val: 0.7796 | Ep20 val: 0.7795

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7880 | Final val: 0.7947 | Ep20 val: 0.8005

--- Seed 5 Summary ---
  (a) Standard X: 0.9354
  (b) Standard V: 0.7871  [Diff from (a): -14.83%]
  (c) RowNorm V:  0.7880  [Diff from (b): +0.09%]
  → Basis effect (a vs b): 15.9% difference
  → RowNorm helps: +0.1%

======================================================================
RANDOM SPLIT 2/5
======================================================================
Train: 20,695 | Val: 6,898 | Test: 6,900
Parameter-to-sample ratio: 98.5:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 2/5, Seed 1/5 (seed=5) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9393 | Final val: 0.9368 | Ep20 val: 0.9375

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7816 | Final val: 0.7782 | Ep20 val: 0.7678

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7935 | Final val: 0.7925 | Ep20 val: 0.7978

--- Seed 1 Summary ---
  (a) Standard X: 0.9393
  (b) Standard V: 0.7816  [Diff from (a): -15.77%]
  (c) RowNorm V:  0.7935  [Diff from (b): +1.19%]
  → Basis effect (a vs b): 16.8% difference
  → RowNorm helps: +1.5%

--- Split 2/5, Seed 2/5 (seed=6) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9386 | Final val: 0.9345 | Ep20 val: 0.9406

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7786 | Final val: 0.7769 | Ep20 val: 0.7776

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7891 | Final val: 0.7879 | Ep20 val: 0.7866

--- Seed 2 Summary ---
  (a) Standard X: 0.9386
  (b) Standard V: 0.7786  [Diff from (a): -16.00%]
  (c) RowNorm V:  0.7891  [Diff from (b): +1.06%]
  → Basis effect (a vs b): 17.0% difference
  → RowNorm helps: +1.4%

--- Split 2/5, Seed 3/5 (seed=7) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9428 | Final val: 0.9397 | Ep20 val: 0.9345

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7910 | Final val: 0.7875 | Ep20 val: 0.7814

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7851 | Final val: 0.7840 | Ep20 val: 0.7873

--- Seed 3 Summary ---
  (a) Standard X: 0.9428
  (b) Standard V: 0.7910  [Diff from (a): -15.17%]
  (c) RowNorm V:  0.7851  [Diff from (b): -0.59%]
  → Basis effect (a vs b): 16.1% difference
  → RowNorm hurts: -0.8%

--- Split 2/5, Seed 4/5 (seed=8) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9401 | Final val: 0.9335 | Ep20 val: 0.9394

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7713 | Final val: 0.7720 | Ep20 val: 0.7714

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7820 | Final val: 0.7860 | Ep20 val: 0.7815

--- Seed 4 Summary ---
  (a) Standard X: 0.9401
  (b) Standard V: 0.7713  [Diff from (a): -16.88%]
  (c) RowNorm V:  0.7820  [Diff from (b): +1.07%]
  → Basis effect (a vs b): 18.0% difference
  → RowNorm helps: +1.4%

--- Split 2/5, Seed 5/5 (seed=9) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9343 | Final val: 0.9303 | Ep20 val: 0.9317

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7877 | Final val: 0.7847 | Ep20 val: 0.7562
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7887 | Final val: 0.7825 | Ep20 val: 0.7914

--- Seed 5 Summary ---
  (a) Standard X: 0.9343
  (b) Standard V: 0.7877  [Diff from (a): -14.67%]
  (c) RowNorm V:  0.7887  [Diff from (b): +0.10%]
  → Basis effect (a vs b): 15.7% difference
  → RowNorm helps: +0.1%

======================================================================
RANDOM SPLIT 3/5
======================================================================
Train: 20,695 | Val: 6,898 | Test: 6,900
Parameter-to-sample ratio: 98.5:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 3/5, Seed 1/5 (seed=10) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9339 | Final val: 0.9285 | Ep20 val: 0.9314

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7677 | Final val: 0.7676 | Ep20 val: 0.7621

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7919 | Final val: 0.7910 | Ep20 val: 0.7846

--- Seed 1 Summary ---
  (a) Standard X: 0.9339
  (b) Standard V: 0.7677  [Diff from (a): -16.62%]
  (c) RowNorm V:  0.7919  [Diff from (b): +2.42%]
  → Basis effect (a vs b): 17.8% difference
  → RowNorm helps: +3.2%

--- Split 3/5, Seed 2/5 (seed=11) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9339 | Final val: 0.9306 | Ep20 val: 0.9364

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7667 | Final val: 0.7631 | Ep20 val: 0.7531

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7939 | Final val: 0.7862 | Ep20 val: 0.7831

--- Seed 2 Summary ---
  (a) Standard X: 0.9339
  (b) Standard V: 0.7667  [Diff from (a): -16.72%]
  (c) RowNorm V:  0.7939  [Diff from (b): +2.72%]
  → Basis effect (a vs b): 17.9% difference
  → RowNorm helps: +3.6%

--- Split 3/5, Seed 3/5 (seed=12) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9370 | Final val: 0.9362 | Ep20 val: 0.9364

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7748 | Final val: 0.7699 | Ep20 val: 0.7621

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7907 | Final val: 0.7814 | Ep20 val: 0.7873

--- Seed 3 Summary ---
  (a) Standard X: 0.9370
  (b) Standard V: 0.7748  [Diff from (a): -16.22%]
  (c) RowNorm V:  0.7907  [Diff from (b): +1.59%]
  → Basis effect (a vs b): 17.3% difference
  → RowNorm helps: +2.1%

--- Split 3/5, Seed 4/5 (seed=13) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9374 | Final val: 0.9314 | Ep20 val: 0.9366

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7735 | Final val: 0.7759 | Ep20 val: 0.7657

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7959 | Final val: 0.7870 | Ep20 val: 0.7894

--- Seed 4 Summary ---
  (a) Standard X: 0.9374
  (b) Standard V: 0.7735  [Diff from (a): -16.39%]
  (c) RowNorm V:  0.7959  [Diff from (b): +2.25%]
  → Basis effect (a vs b): 17.5% difference
  → RowNorm helps: +2.9%

--- Split 3/5, Seed 5/5 (seed=14) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9393 | Final val: 0.9352 | Ep20 val: 0.9372

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7701 | Final val: 0.7678 | Ep20 val: 0.7570

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7932 | Final val: 0.7849 | Ep20 val: 0.7914

--- Seed 5 Summary ---
  (a) Standard X: 0.9393
  (b) Standard V: 0.7701  [Diff from (a): -16.91%]
  (c) RowNorm V:  0.7932  [Diff from (b): +2.30%]
  → Basis effect (a vs b): 18.0% difference
  → RowNorm helps: +3.0%

======================================================================
RANDOM SPLIT 4/5
======================================================================
Train: 20,695 | Val: 6,898 | Test: 6,900
Parameter-to-sample ratio: 98.5:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 4/5, Seed 1/5 (seed=15) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9380 | Final val: 0.9388 | Ep20 val: 0.9385

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7646 | Final val: 0.7715 | Ep20 val: 0.7675

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7823 | Final val: 0.7960 | Ep20 val: 0.7894

--- Seed 1 Summary ---
  (a) Standard X: 0.9380
  (b) Standard V: 0.7646  [Diff from (a): -17.33%]
  (c) RowNorm V:  0.7823  [Diff from (b): +1.77%]
  → Basis effect (a vs b): 18.5% difference
  → RowNorm helps: +2.3%

--- Split 4/5, Seed 2/5 (seed=16) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9357 | Final val: 0.9346 | Ep20 val: 0.9348

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7730 | Final val: 0.7796 | Ep20 val: 0.7712

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7819 | Final val: 0.7776 | Ep20 val: 0.7898

--- Seed 2 Summary ---
  (a) Standard X: 0.9357
  (b) Standard V: 0.7730  [Diff from (a): -16.26%]
  (c) RowNorm V:  0.7819  [Diff from (b): +0.88%]
  → Basis effect (a vs b): 17.4% difference
  → RowNorm helps: +1.1%

--- Split 4/5, Seed 3/5 (seed=17) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9387 | Final val: 0.9368 | Ep20 val: 0.9407

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7728 | Final val: 0.7782 | Ep20 val: 0.7724

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7936 | Final val: 0.7875 | Ep20 val: 0.7823

--- Seed 3 Summary ---
  (a) Standard X: 0.9387
  (b) Standard V: 0.7728  [Diff from (a): -16.59%]
  (c) RowNorm V:  0.7936  [Diff from (b): +2.09%]
  → Basis effect (a vs b): 17.7% difference
  → RowNorm helps: +2.7%

--- Split 4/5, Seed 4/5 (seed=18) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9342 | Final val: 0.9308 | Ep20 val: 0.9361

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7732 | Final val: 0.7818 | Ep20 val: 0.7688

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7836 | Final val: 0.7867 | Ep20 val: 0.7852

--- Seed 4 Summary ---
  (a) Standard X: 0.9342
  (b) Standard V: 0.7732  [Diff from (a): -16.10%]
  (c) RowNorm V:  0.7836  [Diff from (b): +1.04%]
  → Basis effect (a vs b): 17.2% difference
  → RowNorm helps: +1.3%

--- Split 4/5, Seed 5/5 (seed=19) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9313 | Final val: 0.9313 | Ep20 val: 0.9291

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7703 | Final val: 0.7704 | Ep20 val: 0.7783

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7852 | Final val: 0.7873 | Ep20 val: 0.7917

--- Seed 5 Summary ---
  (a) Standard X: 0.9313
  (b) Standard V: 0.7703  [Diff from (a): -16.10%]
  (c) RowNorm V:  0.7852  [Diff from (b): +1.49%]
  → Basis effect (a vs b): 17.3% difference
  → RowNorm helps: +1.9%

======================================================================
RANDOM SPLIT 5/5
======================================================================
Train: 20,695 | Val: 6,898 | Test: 6,900
Parameter-to-sample ratio: 98.5:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 5/5, Seed 1/5 (seed=20) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9365 | Final val: 0.9384 | Ep20 val: 0.9380

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7771 | Final val: 0.7791 | Ep20 val: 0.7667

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7920 | Final val: 0.7804 | Ep20 val: 0.7788

--- Seed 1 Summary ---
  (a) Standard X: 0.9365
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
  (b) Standard V: 0.7771  [Diff from (a): -15.94%]
  (c) RowNorm V:  0.7920  [Diff from (b): +1.49%]
  → Basis effect (a vs b): 17.0% difference
  → RowNorm helps: +1.9%

--- Split 5/5, Seed 2/5 (seed=21) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9320 | Final val: 0.9385 | Ep20 val: 0.9316

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7651 | Final val: 0.7585 | Ep20 val: 0.7686

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7893 | Final val: 0.7879 | Ep20 val: 0.7833

--- Seed 2 Summary ---
  (a) Standard X: 0.9320
  (b) Standard V: 0.7651  [Diff from (a): -16.70%]
  (c) RowNorm V:  0.7893  [Diff from (b): +2.42%]
  → Basis effect (a vs b): 17.9% difference
  → RowNorm helps: +3.2%

--- Split 5/5, Seed 3/5 (seed=22) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9148 | Final val: 0.9150 | Ep20 val: 0.9340

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7748 | Final val: 0.7680 | Ep20 val: 0.7707

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7829 | Final val: 0.7775 | Ep20 val: 0.7908

--- Seed 3 Summary ---
  (a) Standard X: 0.9148
  (b) Standard V: 0.7748  [Diff from (a): -14.00%]
  (c) RowNorm V:  0.7829  [Diff from (b): +0.81%]
  → Basis effect (a vs b): 15.3% difference
  → RowNorm helps: +1.0%

--- Split 5/5, Seed 4/5 (seed=23) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9317 | Final val: 0.9346 | Ep20 val: 0.9366

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7761 | Final val: 0.7714 | Ep20 val: 0.7744

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7828 | Final val: 0.7792 | Ep20 val: 0.7891

--- Seed 4 Summary ---
  (a) Standard X: 0.9317
  (b) Standard V: 0.7761  [Diff from (a): -15.57%]
  (c) RowNorm V:  0.7828  [Diff from (b): +0.67%]
  → Basis effect (a vs b): 16.7% difference
  → RowNorm helps: +0.9%

--- Split 5/5, Seed 5/5 (seed=24) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9297 | Final val: 0.9356 | Ep20 val: 0.9394

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7809 | Final val: 0.7737 | Ep20 val: 0.7701

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7890 | Final val: 0.7875 | Ep20 val: 0.7804

--- Seed 5 Summary ---
  (a) Standard X: 0.9297
  (b) Standard V: 0.7809  [Diff from (a): -14.88%]
  (c) RowNorm V:  0.7890  [Diff from (b): +0.81%]
  → Basis effect (a vs b): 16.0% difference
  → RowNorm helps: +1.0%

[6/6] Aggregating results and generating outputs...
Aggregating: (a) Standard MLP on X (scaled)...
Aggregating: (b) Standard MLP on V (scaled)...
Aggregating: (c) RowNorm MLP on V (unscaled)...

✓ Saved aggregated metrics: results/investigation2_directions_AB/coauthor-physics/random_splits/metrics/results_aggregated.json

======================================================================
FINAL SUMMARY
======================================================================
Dataset: coauthor-physics
Split type: random_splits
Raw feature dimension: 8415
Effective dimension (after QR): 7701
Rank deficiency handled: 8415 → 7701
span(U) = span(X) — same subspace, different basis
D-orthonormality: max |U^T D U - I| = 7.61e-08
Hidden dimension: 256
Epochs: 200
Total runs per model: 25

======================================================================
TEST ACCURACY RESULTS (Mean ± Std)
======================================================================
(a) Standard MLP on X (scaled):  93.49±0.53%
(b) Standard MLP on V (scaled):  77.65±0.74%
(c) RowNorm MLP on V (unscaled): 78.85±0.42%

======================================================================
DIRECTION B: BASIS SENSITIVITY (a vs b)
======================================================================
Same model (Standard MLP), same preprocessing (StandardScaler)
Only difference: coordinate system (X vs V)

Basis Effect: -0.1584 (-16.9%)
✓ SIGNIFICANT basis sensitivity detected
  → MLPs are sensitive to basis representation!

======================================================================
DIRECTION A: MODEL SENSITIVITY (b vs c)
======================================================================
Same basis (V), different models
Question: Does RowNorm help on restricted eigenvectors?

Model Effect: +0.0120 (+1.5%)
✓ RowNorm advantage persists on restricted eigenvectors

======================================================================
EFFECT INDEPENDENCE
======================================================================
Basis effect (a→b):       -16.94%
Model effect (b→c):        +1.54%
Expected combined:        -15.40%
Observed combined (a→c):  -15.66%
Interaction term:          -0.26%

✓ Effects are ADDITIVE (independent)

======================================================================
✓ Investigation 2 Directions A&B complete for coauthor-physics!
✓ Results saved to: results/investigation2_directions_AB/coauthor-physics/random_splits/
======================================================================
