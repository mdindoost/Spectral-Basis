/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
Downloading https://github.com/shchur/gnn-benchmark/raw/master/data/npz/ms_academic_cs.npz
Processing...
Done!
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
======================================================================
INVESTIGATION 2: DIRECTIONS A & B - COAUTHOR-CS
======================================================================
Device: cuda
GPU: NVIDIA GeForce RTX 4070 Ti SUPER
GPU Memory: 15.56 GB
Random splits: No (fixed benchmark)
======================================================================

[1/6] Loading coauthor-cs...
Creating 60/20/20 split for coauthor-cs...

Dataset Statistics:
  Nodes: 18,333
  Edges: 163,788
  Classes: 15
  Raw feature dimension: 6805
  Train: 10,999 (60.0%)
  Val: 3,666 (20.0%)
  Test: 3,668 (20.0%)

[2/6] Building graph matrices...
Adjacency: (18333, 18333), nnz=182,121
Laplacian: (18333, 18333)
Degree matrix: (18333, 18333)

[3/6] Computing X-restricted eigenvectors...
Performing QR decomposition on X...
Original dimension: 6805
Effective rank: 6803/6805
⚠️  Rank deficiency detected: 2 dimensions removed
Computing projected matrices (Q^T L Q, Q^T D Q)...
Reduced Laplacian: (6803, 6803)
Reduced degree matrix: (6803, 6803)
Solving generalized eigenproblem in R^6803...
Eigenvalue range: [0.059962, 1.231584]
Restricted eigenvectors U: (18333, 6803)
D-orthonormality check: max |U^T D U - I| = 1.68e-08
✓ Excellent D-orthonormality

[4/6] Preparing data splits...

[5/6] Training 3 models (Directions A & B)...
Total runs: 15 = 3(models) × 5(seeds)
Batch size: 128 (dataset has 10999 training samples)

======================================================================
USING FIXED BENCHMARK SPLITS
======================================================================
Train: 10,999 | Val: 3,666 | Test: 3,668
Parameter-to-sample ratio: 164.6:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 1/1, Seed 1/5 (seed=0) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8446 | Final val: 0.8546 | Ep20 val: 0.9056

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.5818 | Final val: 0.5723 | Ep20 val: 0.5682

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.6121 | Final val: 0.6058 | Ep20 val: 0.5908

--- Seed 1 Summary ---
  (a) Standard X: 0.8446
  (b) Standard V: 0.5818  [Diff from (a): -26.28%]
  (c) RowNorm V:  0.6121  [Diff from (b): +3.03%]
  → Basis effect (a vs b): 31.1% difference
  → RowNorm helps: +5.2%

--- Split 1/1, Seed 2/5 (seed=1) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8806 | Final val: 0.8732 | Ep20 val: 0.8985

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.5962 | Final val: 0.5824 | Ep20 val: 0.5786

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.6145 | Final val: 0.6042 | Ep20 val: 0.5887

--- Seed 2 Summary ---
  (a) Standard X: 0.8806
  (b) Standard V: 0.5962  [Diff from (a): -28.44%]
  (c) RowNorm V:  0.6145  [Diff from (b): +1.83%]
  → Basis effect (a vs b): 32.3% difference
  → RowNorm helps: +3.1%

--- Split 1/1, Seed 3/5 (seed=2) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8980 | Final val: 0.8933 | Ep20 val: 0.9037

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.5949 | Final val: 0.5745 | Ep20 val: 0.5723

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.6104 | Final val: 0.6165 | Ep20 val: 0.6020

--- Seed 3 Summary ---
  (a) Standard X: 0.8980
  (b) Standard V: 0.5949  [Diff from (a): -30.32%]
  (c) RowNorm V:  0.6104  [Diff from (b): +1.55%]
  → Basis effect (a vs b): 33.8% difference
  → RowNorm helps: +2.6%

--- Split 1/1, Seed 4/5 (seed=3) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9100 | Final val: 0.9067 | Ep20 val: 0.8917

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.5889 | Final val: 0.6064 | Ep20 val: 0.5745

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.6066 | Final val: 0.6053 | Ep20 val: 0.5927

--- Seed 4 Summary ---
  (a) Standard X: 0.9100
  (b) Standard V: 0.5889  [Diff from (a): -32.12%]
  (c) RowNorm V:  0.6066  [Diff from (b): +1.77%]
  → Basis effect (a vs b): 35.3% difference
  → RowNorm helps: +3.0%

--- Split 1/1, Seed 5/5 (seed=4) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.9160 | Final val: 0.9103 | Ep20 val: 0.8966

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.5960 | Final val: 0.5867 | Ep20 val: 0.5562

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.6189 | Final val: 0.5960 | Ep20 val: 0.6037

--- Seed 5 Summary ---
  (a) Standard X: 0.9160
  (b) Standard V: 0.5960  [Diff from (a): -32.01%]
  (c) RowNorm V:  0.6189  [Diff from (b): +2.29%]
  → Basis effect (a vs b): 34.9% difference
  → RowNorm helps: +3.8%

[6/6] Aggregating results and generating outputs...
Aggregating: (a) Standard MLP on X (scaled)...
Aggregating: (b) Standard MLP on V (scaled)...
Aggregating: (c) RowNorm MLP on V (unscaled)...

✓ Saved aggregated metrics: results/investigation2_directions_AB/coauthor-cs/fixed_splits/metrics/results_aggregated.json

======================================================================
FINAL SUMMARY
======================================================================
Dataset: coauthor-cs
Split type: fixed_splits
Raw feature dimension: 6805
Effective dimension (after QR): 6803
Rank deficiency handled: 6805 → 6803
span(U) = span(X) — same subspace, different basis
D-orthonormality: max |U^T D U - I| = 1.68e-08
Hidden dimension: 256
Epochs: 200
Total runs per model: 5

======================================================================
TEST ACCURACY RESULTS (Mean ± Std)
======================================================================
(a) Standard MLP on X (scaled):  88.99±2.57%
(b) Standard MLP on V (scaled):  59.15±0.56%
(c) RowNorm MLP on V (unscaled): 61.25±0.41%

======================================================================
DIRECTION B: BASIS SENSITIVITY (a vs b)
======================================================================
Same model (Standard MLP), same preprocessing (StandardScaler)
Only difference: coordinate system (X vs V)

Basis Effect: -0.2983 (-33.5%)
✓ SIGNIFICANT basis sensitivity detected
  → MLPs are sensitive to basis representation!

======================================================================
DIRECTION A: MODEL SENSITIVITY (b vs c)
======================================================================
Same basis (V), different models
Question: Does RowNorm help on restricted eigenvectors?

Model Effect: +0.0209 (+3.5%)
✓ RowNorm advantage persists on restricted eigenvectors

======================================================================
EFFECT INDEPENDENCE
======================================================================
Basis effect (a→b):       -33.52%
Model effect (b→c):        +3.54%
Expected combined:        -29.98%
Observed combined (a→c):  -31.17%
Interaction term:          -1.19%

⚠ Effects show INTERACTION (1.2%)

======================================================================
✓ Investigation 2 Directions A&B complete for coauthor-cs!
✓ Results saved to: results/investigation2_directions_AB/coauthor-cs/fixed_splits/
======================================================================
