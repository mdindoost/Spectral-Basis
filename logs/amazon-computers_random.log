/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
======================================================================
INVESTIGATION 2: DIRECTIONS A & B - AMAZON-COMPUTERS
======================================================================
Device: cuda
GPU: NVIDIA GeForce RTX 4070 Ti SUPER
GPU Memory: 15.56 GB
Random splits: Yes
======================================================================

[1/6] Loading amazon-computers...
Creating 60/20/20 split for amazon-computers...

Dataset Statistics:
  Nodes: 13,752
  Edges: 491,722
  Classes: 10
  Raw feature dimension: 767
  Train: 8,251 (60.0%)
  Val: 2,750 (20.0%)
  Test: 2,751 (20.0%)

[2/6] Building graph matrices...
Adjacency: (13752, 13752), nnz=505,474
Laplacian: (13752, 13752)
Degree matrix: (13752, 13752)

[3/6] Computing X-restricted eigenvectors...
Performing QR decomposition on X...
Original dimension: 767
Effective rank: 767/767
✓ Full rank - no dimension reduction needed
Computing projected matrices (Q^T L Q, Q^T D Q)...
Reduced Laplacian: (767, 767)
Reduced degree matrix: (767, 767)
Solving generalized eigenproblem in R^767...
Eigenvalue range: [0.055848, 1.185627]
Restricted eigenvectors U: (13752, 767)
D-orthonormality check: max |U^T D U - I| = 4.39e-09
✓ Excellent D-orthonormality

[4/6] Preparing data splits...

[5/6] Training 3 models (Directions A & B)...
Across 5 random splits × 5 seeds
Total runs: 75 = 3(models) × 5(seeds) × 5(splits)
Batch size: 128 (dataset has 8251 training samples)

======================================================================
RANDOM SPLIT 1/5
======================================================================
Train: 8,251 | Val: 2,750 | Test: 2,751
Parameter-to-sample ratio: 32.1:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 1/5, Seed 1/5 (seed=0) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8197 | Final val: 0.8145 | Ep20 val: 0.8087

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7815 | Final val: 0.7829 | Ep20 val: 0.7676

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7848 | Final val: 0.7760 | Ep20 val: 0.7825

--- Seed 1 Summary ---
  (a) Standard X: 0.8197
  (b) Standard V: 0.7815  [Diff from (a): -3.82%]
  (c) RowNorm V:  0.7848  [Diff from (b): +0.33%]
  → Basis effect (a vs b): 4.7% difference
  → RowNorm helps: +0.4%

--- Split 1/5, Seed 2/5 (seed=1) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8259 | Final val: 0.8113 | Ep20 val: 0.8142

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7539 | Final val: 0.7625 | Ep20 val: 0.7742

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7663 | Final val: 0.7633 | Ep20 val: 0.7775

--- Seed 2 Summary ---
  (a) Standard X: 0.8259
  (b) Standard V: 0.7539  [Diff from (a): -7.20%]
  (c) RowNorm V:  0.7663  [Diff from (b): +1.24%]
  → Basis effect (a vs b): 8.7% difference
  → RowNorm helps: +1.6%

--- Split 1/5, Seed 3/5 (seed=2) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8066 | Final val: 0.8036 | Ep20 val: 0.7960

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7655 | Final val: 0.7538 | Ep20 val: 0.7665

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7528 | Final val: 0.7611 | Ep20 val: 0.7811

--- Seed 3 Summary ---
  (a) Standard X: 0.8066
  (b) Standard V: 0.7655  [Diff from (a): -4.11%]
  (c) RowNorm V:  0.7528  [Diff from (b): -1.27%]
  → Basis effect (a vs b): 5.1% difference
  → RowNorm hurts: -1.7%

--- Split 1/5, Seed 4/5 (seed=3) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8190 | Final val: 0.8171 | Ep20 val: 0.7924

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7790 | Final val: 0.7975 | Ep20 val: 0.7684

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7717 | Final val: 0.7505 | Ep20 val: 0.7836

--- Seed 4 Summary ---
  (a) Standard X: 0.8190
  (b) Standard V: 0.7790  [Diff from (a): -4.00%]
  (c) RowNorm V:  0.7717  [Diff from (b): -0.73%]
  → Basis effect (a vs b): 4.9% difference
  → RowNorm hurts: -0.9%

--- Split 1/5, Seed 5/5 (seed=4) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8063 | Final val: 0.8087 | Ep20 val: 0.8149

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.8008 | Final val: 0.7935 | Ep20 val: 0.7709

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7619 | Final val: 0.7636 | Ep20 val: 0.7836

--- Seed 5 Summary ---
  (a) Standard X: 0.8063
  (b) Standard V: 0.8008  [Diff from (a): -0.55%]
  (c) RowNorm V:  0.7619  [Diff from (b): -3.89%]
  → Basis effect minimal: 0.7% difference
  → RowNorm hurts: -4.9%

======================================================================
RANDOM SPLIT 2/5
======================================================================
Train: 8,251 | Val: 2,750 | Test: 2,751
Parameter-to-sample ratio: 32.1:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 2/5, Seed 1/5 (seed=5) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8033 | Final val: 0.8051 | Ep20 val: 0.7949

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7783 | Final val: 0.7742 | Ep20 val: 0.7629

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7623 | Final val: 0.7742 | Ep20 val: 0.7745

--- Seed 1 Summary ---
  (a) Standard X: 0.8033
  (b) Standard V: 0.7783  [Diff from (a): -2.51%]
  (c) RowNorm V:  0.7623  [Diff from (b): -1.60%]
  → Basis effect (a vs b): 3.1% difference
  → RowNorm hurts: -2.1%

--- Split 2/5, Seed 2/5 (seed=6) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8142 | Final val: 0.8109 | Ep20 val: 0.8215

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7663 | Final val: 0.7633 | Ep20 val: 0.7771

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7688 | Final val: 0.7695 | Ep20 val: 0.7931

--- Seed 2 Summary ---
  (a) Standard X: 0.8142
  (b) Standard V: 0.7663  [Diff from (a): -4.80%]
  (c) RowNorm V:  0.7688  [Diff from (b): +0.25%]
  → Basis effect (a vs b): 5.9% difference
  → RowNorm helps: +0.3%

--- Split 2/5, Seed 3/5 (seed=7) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8066 | Final val: 0.8095 | Ep20 val: 0.8007

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7568 | Final val: 0.7676 | Ep20 val: 0.7898

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7728 | Final val: 0.7593 | Ep20 val: 0.7731

--- Seed 3 Summary ---
  (a) Standard X: 0.8066
  (b) Standard V: 0.7568  [Diff from (a): -4.98%]
  (c) RowNorm V:  0.7728  [Diff from (b): +1.60%]
  → Basis effect (a vs b): 6.2% difference
  → RowNorm helps: +2.1%

--- Split 2/5, Seed 4/5 (seed=8) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.7943 | Final val: 0.7858 | Ep20 val: 0.8116

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7815 | Final val: 0.7796 | Ep20 val: 0.7735

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7684 | Final val: 0.7785 | Ep20 val: 0.7785

--- Seed 4 Summary ---
  (a) Standard X: 0.7943
  (b) Standard V: 0.7815  [Diff from (a): -1.27%]
  (c) RowNorm V:  0.7684  [Diff from (b): -1.31%]
  → Basis effect (a vs b): 1.6% difference
  → RowNorm hurts: -1.7%

--- Split 2/5, Seed 5/5 (seed=9) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8204 | Final val: 0.8145 | Ep20 val: 0.8073

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7964 | Final val: 0.7825 | Ep20 val: 0.7789

Training: (c) RowNorm MLP on V (unscaled)...
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
  ✓ Test acc: 0.7812 | Final val: 0.7775 | Ep20 val: 0.7633

--- Seed 5 Summary ---
  (a) Standard X: 0.8204
  (b) Standard V: 0.7964  [Diff from (a): -2.40%]
  (c) RowNorm V:  0.7812  [Diff from (b): -1.53%]
  → Basis effect (a vs b): 2.9% difference
  → RowNorm hurts: -1.9%

======================================================================
RANDOM SPLIT 3/5
======================================================================
Train: 8,251 | Val: 2,750 | Test: 2,751
Parameter-to-sample ratio: 32.1:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 3/5, Seed 1/5 (seed=10) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8092 | Final val: 0.8240 | Ep20 val: 0.8393

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7830 | Final val: 0.7975 | Ep20 val: 0.7891

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7597 | Final val: 0.7811 | Ep20 val: 0.7840

--- Seed 1 Summary ---
  (a) Standard X: 0.8092
  (b) Standard V: 0.7830  [Diff from (a): -2.62%]
  (c) RowNorm V:  0.7597  [Diff from (b): -2.33%]
  → Basis effect (a vs b): 3.2% difference
  → RowNorm hurts: -3.0%

--- Split 3/5, Seed 2/5 (seed=11) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8252 | Final val: 0.8309 | Ep20 val: 0.8204

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7881 | Final val: 0.7938 | Ep20 val: 0.7796

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7477 | Final val: 0.7756 | Ep20 val: 0.7815

--- Seed 2 Summary ---
  (a) Standard X: 0.8252
  (b) Standard V: 0.7881  [Diff from (a): -3.71%]
  (c) RowNorm V:  0.7477  [Diff from (b): -4.03%]
  → Basis effect (a vs b): 4.5% difference
  → RowNorm hurts: -5.1%

--- Split 3/5, Seed 3/5 (seed=12) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8259 | Final val: 0.8342 | Ep20 val: 0.8375

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7735 | Final val: 0.7833 | Ep20 val: 0.7767

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7543 | Final val: 0.7647 | Ep20 val: 0.8055

--- Seed 3 Summary ---
  (a) Standard X: 0.8259
  (b) Standard V: 0.7735  [Diff from (a): -5.23%]
  (c) RowNorm V:  0.7543  [Diff from (b): -1.93%]
  → Basis effect (a vs b): 6.3% difference
  → RowNorm hurts: -2.5%

--- Split 3/5, Seed 4/5 (seed=13) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.7990 | Final val: 0.8160 | Ep20 val: 0.8240

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7943 | Final val: 0.8025 | Ep20 val: 0.7698

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7721 | Final val: 0.7742 | Ep20 val: 0.7905

--- Seed 4 Summary ---
  (a) Standard X: 0.7990
  (b) Standard V: 0.7943  [Diff from (a): -0.47%]
  (c) RowNorm V:  0.7721  [Diff from (b): -2.22%]
  → Basis effect minimal: 0.6% difference
  → RowNorm hurts: -2.8%

--- Split 3/5, Seed 5/5 (seed=14) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.5591 | Final val: 0.6000 | Ep20 val: 0.8171

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7968 | Final val: 0.8007 | Ep20 val: 0.7815

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7826 | Final val: 0.7815 | Ep20 val: 0.8022

--- Seed 5 Summary ---
  (a) Standard X: 0.5591
  (b) Standard V: 0.7968  [Diff from (a): +23.77%]
  (c) RowNorm V:  0.7826  [Diff from (b): -1.42%]
  → Basis effect (a vs b): 42.5% difference
  → RowNorm hurts: -1.8%

======================================================================
RANDOM SPLIT 4/5
======================================================================
Train: 8,251 | Val: 2,750 | Test: 2,751
Parameter-to-sample ratio: 32.1:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 4/5, Seed 1/5 (seed=15) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8103 | Final val: 0.8175 | Ep20 val: 0.7964

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7783 | Final val: 0.7949 | Ep20 val: 0.7800

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7721 | Final val: 0.7887 | Ep20 val: 0.7793

--- Seed 1 Summary ---
  (a) Standard X: 0.8103
  (b) Standard V: 0.7783  [Diff from (a): -3.20%]
  (c) RowNorm V:  0.7721  [Diff from (b): -0.62%]
  → Basis effect (a vs b): 3.9% difference
  → RowNorm hurts: -0.8%

--- Split 4/5, Seed 2/5 (seed=16) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8288 | Final val: 0.8236 | Ep20 val: 0.8244

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7688 | Final val: 0.7844 | Ep20 val: 0.7858

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7746 | Final val: 0.7975 | Ep20 val: 0.7971

--- Seed 2 Summary ---
  (a) Standard X: 0.8288
  (b) Standard V: 0.7688  [Diff from (a): -6.00%]
  (c) RowNorm V:  0.7746  [Diff from (b): +0.58%]
  → Basis effect (a vs b): 7.2% difference
  → RowNorm helps: +0.8%

--- Split 4/5, Seed 3/5 (seed=17) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8168 | Final val: 0.8280 | Ep20 val: 0.8331

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7517 | Final val: 0.7629 | Ep20 val: 0.7742

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7735 | Final val: 0.7902 | Ep20 val: 0.7971

--- Seed 3 Summary ---
  (a) Standard X: 0.8168
  (b) Standard V: 0.7517  [Diff from (a): -6.51%]
  (c) RowNorm V:  0.7735  [Diff from (b): +2.18%]
  → Basis effect (a vs b): 8.0% difference
  → RowNorm helps: +2.9%

--- Split 4/5, Seed 4/5 (seed=18) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8328 | Final val: 0.8364 | Ep20 val: 0.8378

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7855 | Final val: 0.7993 | Ep20 val: 0.7807

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7674 | Final val: 0.7731 | Ep20 val: 0.7960

--- Seed 4 Summary ---
  (a) Standard X: 0.8328
  (b) Standard V: 0.7855  [Diff from (a): -4.73%]
  (c) RowNorm V:  0.7674  [Diff from (b): -1.82%]
  → Basis effect (a vs b): 5.7% difference
  → RowNorm hurts: -2.3%

--- Split 4/5, Seed 5/5 (seed=19) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8164 | Final val: 0.8291 | Ep20 val: 0.8258

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7779 | Final val: 0.7945 | Ep20 val: 0.7844

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7728 | Final val: 0.7924 | Ep20 val: 0.7942

--- Seed 5 Summary ---
  (a) Standard X: 0.8164
  (b) Standard V: 0.7779  [Diff from (a): -3.85%]
  (c) RowNorm V:  0.7728  [Diff from (b): -0.51%]
  → Basis effect (a vs b): 4.7% difference
  → RowNorm hurts: -0.7%

======================================================================
RANDOM SPLIT 5/5
======================================================================
Train: 8,251 | Val: 2,750 | Test: 2,751
Parameter-to-sample ratio: 32.1:1
⚠️  WARNING: High parameter-to-sample ratio! Expect overfitting.

--- Split 5/5, Seed 1/5 (seed=20) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.7972 | Final val: 0.8022 | Ep20 val: 0.7942

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7568 | Final val: 0.7687 | Ep20 val: 0.7676

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7608 | Final val: 0.7727 | Ep20 val: 0.7767

--- Seed 1 Summary ---
  (a) Standard X: 0.7972
  (b) Standard V: 0.7568  [Diff from (a): -4.03%]
  (c) RowNorm V:  0.7608  [Diff from (b): +0.40%]
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
/home/md724/Spectral-Basis/experiments/investigation2_directions_AB.py:291: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.
  auc = np.trapz(val_accs, dx=1) / len(val_accs)
  → Basis effect (a vs b): 5.1% difference
  → RowNorm helps: +0.5%

--- Split 5/5, Seed 2/5 (seed=21) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8012 | Final val: 0.8153 | Ep20 val: 0.8040

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7830 | Final val: 0.7749 | Ep20 val: 0.7644

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7557 | Final val: 0.7647 | Ep20 val: 0.7727

--- Seed 2 Summary ---
  (a) Standard X: 0.8012
  (b) Standard V: 0.7830  [Diff from (a): -1.82%]
  (c) RowNorm V:  0.7557  [Diff from (b): -2.73%]
  → Basis effect (a vs b): 2.3% difference
  → RowNorm hurts: -3.5%

--- Split 5/5, Seed 3/5 (seed=22) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8106 | Final val: 0.8247 | Ep20 val: 0.8098

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7797 | Final val: 0.7847 | Ep20 val: 0.7673

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7535 | Final val: 0.7636 | Ep20 val: 0.7687

--- Seed 3 Summary ---
  (a) Standard X: 0.8106
  (b) Standard V: 0.7797  [Diff from (a): -3.09%]
  (c) RowNorm V:  0.7535  [Diff from (b): -2.62%]
  → Basis effect (a vs b): 3.8% difference
  → RowNorm hurts: -3.4%

--- Split 5/5, Seed 4/5 (seed=23) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8164 | Final val: 0.8095 | Ep20 val: 0.7855

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7637 | Final val: 0.7593 | Ep20 val: 0.7735

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7721 | Final val: 0.7720 | Ep20 val: 0.7716

--- Seed 4 Summary ---
  (a) Standard X: 0.8164
  (b) Standard V: 0.7637  [Diff from (a): -5.27%]
  (c) RowNorm V:  0.7721  [Diff from (b): +0.84%]
  → Basis effect (a vs b): 6.5% difference
  → RowNorm helps: +1.1%

--- Split 5/5, Seed 5/5 (seed=24) ---

Training: (a) Standard MLP on X (scaled)...
  ✓ Test acc: 0.8095 | Final val: 0.8113 | Ep20 val: 0.8095

Training: (b) Standard MLP on V (scaled)...
  🔍 This is experiment (b) - isolates pure basis effect!
  ✓ Test acc: 0.7804 | Final val: 0.7836 | Ep20 val: 0.7640

Training: (c) RowNorm MLP on V (unscaled)...
  ✓ Test acc: 0.7655 | Final val: 0.7640 | Ep20 val: 0.7713

--- Seed 5 Summary ---
  (a) Standard X: 0.8095
  (b) Standard V: 0.7804  [Diff from (a): -2.91%]
  (c) RowNorm V:  0.7655  [Diff from (b): -1.49%]
  → Basis effect (a vs b): 3.6% difference
  → RowNorm hurts: -1.9%

[6/6] Aggregating results and generating outputs...
Aggregating: (a) Standard MLP on X (scaled)...
Aggregating: (b) Standard MLP on V (scaled)...
Aggregating: (c) RowNorm MLP on V (unscaled)...

✓ Saved aggregated metrics: results/investigation2_directions_AB/amazon-computers/random_splits/metrics/results_aggregated.json

======================================================================
FINAL SUMMARY
======================================================================
Dataset: amazon-computers
Split type: random_splits
Raw feature dimension: 767
Effective dimension (after QR): 767
span(U) = span(X) — same subspace, different basis
D-orthonormality: max |U^T D U - I| = 4.39e-09
Hidden dimension: 256
Epochs: 200
Total runs per model: 25

======================================================================
TEST ACCURACY RESULTS (Mean ± Std)
======================================================================
(a) Standard MLP on X (scaled):  80.30±5.08%
(b) Standard MLP on V (scaled):  77.69±1.34%
(c) RowNorm MLP on V (unscaled): 76.70±0.94%

======================================================================
DIRECTION B: BASIS SENSITIVITY (a vs b)
======================================================================
Same model (Standard MLP), same preprocessing (StandardScaler)
Only difference: coordinate system (X vs V)

Basis Effect: -0.0261 (-3.3%)
✓ SIGNIFICANT basis sensitivity detected
  → MLPs are sensitive to basis representation!

======================================================================
DIRECTION A: MODEL SENSITIVITY (b vs c)
======================================================================
Same basis (V), different models
Question: Does RowNorm help on restricted eigenvectors?

Model Effect: -0.0098 (-1.3%)
✗ RowNorm does NOT help on restricted eigenvectors

======================================================================
EFFECT INDEPENDENCE
======================================================================
Basis effect (a→b):        -3.25%
Model effect (b→c):        -1.27%
Expected combined:         -4.52%
Observed combined (a→c):   -4.48%
Interaction term:          +0.04%

✓ Effects are ADDITIVE (independent)

======================================================================
✓ Investigation 2 Directions A&B complete for amazon-computers!
✓ Results saved to: results/investigation2_directions_AB/amazon-computers/random_splits/
======================================================================
