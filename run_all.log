nohup: ignoring input
========================================================
 FULL PAPER PIPELINE
 Start: Sun Feb 22 09:17:20 PM EST 2026
========================================================

--------------------------------------------------------
 DATASET: cora  |  Sun Feb 22 09:17:20 PM EST 2026
--------------------------------------------------------
[1/2] Training: cora fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER TRAINING EXPERIMENT
================================================================================
Dataset:      cora
k values:     [1, 2, 4, 6, 8, 10, 12, 20, 30]
Split type:   fixed  (1 split(s) x 15 seeds)
Component:    lcc
Device:       cuda
Output base:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc
================================================================================

[Step 1] Loading dataset...
Nodes: 2,708, Features: 1433, Classes: 7

[Step 2] Building graph matrices...

[Step 3] Extracting largest connected component...
Rebuilding graph matrices for LCC...
After step 3: nodes=2,485, classes=7, disconnected_components_to_skip=0

[Step 4] Preparing splits...
Fixed split: Train=122, Val=459, Test=915

[Step 5] Computing SGC normalized adjacency...
A_sgc = D^{-1/2}(A+I)D^{-1/2}

================================================================================
K = 1
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/1 (train=122, val=459, test=915) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=1.62e-10

  Aggregating results for k=1 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          69.57%     0.79%    15
  restricted_standard_mlp                                   46.42%     2.04%    15
  restricted_rownorm_mlp                                    31.40%     1.74%    15

  Framework Analysis (k=1):
    Part A (SGC+MLP - Restricted+Std): +23.148 pp
    Part B (RowNorm - Restricted+Std): -15.024 pp
    Remaining Gap:                     +38.171 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k1/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k1/diagnostics/fisher_diagnostic.json

================================================================================
K = 2
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/1 (train=122, val=459, test=915) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=1.95e-10

  Aggregating results for k=2 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          69.52%     1.84%    15
  restricted_standard_mlp                                   47.12%     1.15%    15
  restricted_rownorm_mlp                                    32.02%     1.17%    15

  Framework Analysis (k=2):
    Part A (SGC+MLP - Restricted+Std): +22.397 pp
    Part B (RowNorm - Restricted+Std): -15.097 pp
    Remaining Gap:                     +37.494 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k2/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k2/diagnostics/fisher_diagnostic.json

================================================================================
K = 4
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/1 (train=122, val=459, test=915) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.36e-10

  Aggregating results for k=4 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          74.17%     0.86%    15
  restricted_standard_mlp                                   48.42%     1.55%    15
  restricted_rownorm_mlp                                    31.92%     1.82%    15

  Framework Analysis (k=4):
    Part A (SGC+MLP - Restricted+Std): +25.756 pp
    Part B (RowNorm - Restricted+Std): -16.495 pp
    Remaining Gap:                     +42.251 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k4/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k4/diagnostics/fisher_diagnostic.json

================================================================================
K = 6
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/1 (train=122, val=459, test=915) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  Aggregating results for k=6 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          75.56%     1.21%    15
  restricted_standard_mlp                                   48.31%     1.31%    15
  restricted_rownorm_mlp                                    31.87%     1.20%    15

  Framework Analysis (k=6):
    Part A (SGC+MLP - Restricted+Std): +27.250 pp
    Part B (RowNorm - Restricted+Std): -16.437 pp
    Remaining Gap:                     +43.687 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k6/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k6/diagnostics/fisher_diagnostic.json

================================================================================
K = 8
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/1 (train=122, val=459, test=915) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  Aggregating results for k=8 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          76.20%     1.53%    15
  restricted_standard_mlp                                   46.62%     1.10%    15
  restricted_rownorm_mlp                                    33.12%     2.42%    15

  Framework Analysis (k=8):
    Part A (SGC+MLP - Restricted+Std): +29.574 pp
    Part B (RowNorm - Restricted+Std): -13.501 pp
    Remaining Gap:                     +43.075 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k8/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k8/diagnostics/fisher_diagnostic.json

================================================================================
K = 10
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/1 (train=122, val=459, test=915) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k10/training_curves/split0_dynamics.json

  Aggregating results for k=10 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          76.19%     1.09%    15
  restricted_standard_mlp                                   46.30%     1.48%    15
  restricted_rownorm_mlp                                    33.03%     1.38%    15
  log_magnitude                                             35.83%     1.59%    15
  dual_stream                                               35.52%     2.57%    15
  spectral_rownorm_alpha-1.0                                80.12%     0.57%    15
  spectral_rownorm_alpha-0.5                                76.59%     1.04%    15
  spectral_rownorm_alpha0.0                                 37.17%     1.80%    15
  spectral_rownorm_alpha0.5                                 29.01%     1.75%    15
  spectral_rownorm_alpha1.0                                 31.53%     1.70%    15
  nested_spheres_a-1.0_b-1.0                                78.97%     0.68%    15
  nested_spheres_a-1.0_b-0.5                                79.17%     0.77%    15
  nested_spheres_a-1.0_b0.0                                 79.84%     0.41%    15
  nested_spheres_a-1.0_b0.5                                 79.40%     0.72%    15
  nested_spheres_a-1.0_b1.0                                 79.11%     0.66%    15
  nested_spheres_a-0.5_b-1.0                                71.62%     1.09%    15
  nested_spheres_a-0.5_b-0.5                                72.90%     1.21%    15
  nested_spheres_a-0.5_b0.0                                 77.17%     1.11%    15
  nested_spheres_a-0.5_b0.5                                 72.68%     0.93%    15
  nested_spheres_a-0.5_b1.0                                 71.11%     1.52%    15
  nested_spheres_a0.0_b-1.0                                 36.26%     2.29%    15
  nested_spheres_a0.0_b-0.5                                 36.35%     2.62%    15
  nested_spheres_a0.0_b0.0                                  37.38%     2.26%    15
  nested_spheres_a0.0_b0.5                                  36.58%     1.55%    15
  nested_spheres_a0.0_b1.0                                  35.83%     1.59%    15
  nested_spheres_a0.5_b-1.0                                 30.57%     1.57%    15
  nested_spheres_a0.5_b-0.5                                 29.42%     2.21%    15
  nested_spheres_a0.5_b0.0                                  29.79%     2.03%    15
  nested_spheres_a0.5_b0.5                                  29.87%     2.12%    15
  nested_spheres_a0.5_b1.0                                  30.81%     1.11%    15
  nested_spheres_a1.0_b-1.0                                 31.53%     2.20%    15
  nested_spheres_a1.0_b-0.5                                 31.69%     1.84%    15
  nested_spheres_a1.0_b0.0                                  31.33%     1.07%    15
  nested_spheres_a1.0_b0.5                                  31.74%     1.05%    15
  nested_spheres_a1.0_b1.0                                  31.83%     1.39%    15

  Framework Analysis (k=10):
    Part A (SGC+MLP - Restricted+Std): +29.887 pp
    Part B (RowNorm - Restricted+Std): -13.275 pp
    Remaining Gap:                     +43.162 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k10/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k10/diagnostics/fisher_diagnostic.json

================================================================================
K = 12
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/1 (train=122, val=459, test=915) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  Aggregating results for k=12 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          77.09%     1.36%    15
  restricted_standard_mlp                                   47.11%     1.15%    15
  restricted_rownorm_mlp                                    33.63%     1.22%    15

  Framework Analysis (k=12):
    Part A (SGC+MLP - Restricted+Std): +29.974 pp
    Part B (RowNorm - Restricted+Std): -13.479 pp
    Remaining Gap:                     +43.454 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k12/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k12/diagnostics/fisher_diagnostic.json

================================================================================
K = 20
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/1 (train=122, val=459, test=915) ---
  Computing restricted eigenvectors...
  d_effective=1262, ortho_error=2.37e-10

  Aggregating results for k=20 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          76.93%     1.51%    15
  restricted_standard_mlp                                   46.78%     1.26%    15
  restricted_rownorm_mlp                                    35.05%     1.13%    15

  Framework Analysis (k=20):
    Part A (SGC+MLP - Restricted+Std): +30.157 pp
    Part B (RowNorm - Restricted+Std): -11.723 pp
    Remaining Gap:                     +41.880 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k20/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k20/diagnostics/fisher_diagnostic.json

================================================================================
K = 30
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/1 (train=122, val=459, test=915) ---
  Computing restricted eigenvectors...
  d_effective=862, ortho_error=2.17e-10

  Aggregating results for k=30 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          75.97%     1.44%    15
  restricted_standard_mlp                                   49.95%     0.77%    15
  restricted_rownorm_mlp                                    37.52%     1.53%    15

  Framework Analysis (k=30):
    Part A (SGC+MLP - Restricted+Std): +26.018 pp
    Part B (RowNorm - Restricted+Std): -12.430 pp
    Remaining Gap:                     +38.448 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k30/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/k30/diagnostics/fisher_diagnostic.json

================================================================================
MASTER TRAINING EXPERIMENT COMPLETE
================================================================================
Results saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc
[2/2] Analytics: cora fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER ANALYTICS (Exp 2 + Exp 8)
================================================================================
Dataset:       cora
Split type:    fixed
Component:     lcc
k values:      [1, 2, 4, 6, 8, 10, 12, 20, 30]
Results dir:   /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc
================================================================================

[Step 1] Loading dataset and graph...
Nodes: 2,708, Features: 1433, Classes: 7

[Step 2] Extracting LCC...
After LCC: nodes=2,485, classes=7

================================================================================
EXP 2: SPECTRAL ANALYSIS (all k values)
================================================================================

  k=1:
    WARNING: no cached matrices found, recomputing...
    d_effective=1427, ortho_error=1.6218537624013152e-10
    Condition U=4.1037  Condition X=16.6900  Separability=0.2482  SpanErr=2.19e-15
    Var ratio U=29.99  Var ratio X=144680373439.98  Reduction=4824525458.41x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/analytics/exp2_spectral_analysis_k1.json

  k=2:
    WARNING: no cached matrices found, recomputing...
    d_effective=1427, ortho_error=1.9516677163267104e-10
    Condition U=4.3284  Condition X=36.5553  Separability=0.2466  SpanErr=2.43e-15
    Var ratio U=297.14  Var ratio X=119232319349.61  Reduction=401271460.88x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/analytics/exp2_spectral_analysis_k2.json

  k=4:
    WARNING: no cached matrices found, recomputing...
    d_effective=1427, ortho_error=2.3602642063025314e-10
    Condition U=4.4249  Condition X=188.9851  Separability=0.2476  SpanErr=2.14e-15
    Var ratio U=289.00  Var ratio X=98488889734.92  Reduction=340790320.93x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/analytics/exp2_spectral_analysis_k4.json

  k=6:
    WARNING: no cached matrices found, recomputing...
    d_effective=1427, ortho_error=2.4083490757220716e-10
    Condition U=4.4553  Condition X=544.2585  Separability=0.2478  SpanErr=2.94e-15
    Var ratio U=4504.39  Var ratio X=85486230130.89  Reduction=18978409.11x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/analytics/exp2_spectral_analysis_k6.json

  k=8:
    WARNING: no cached matrices found, recomputing...
    d_effective=1427, ortho_error=2.4104429563465146e-10
    Condition U=4.4600  Condition X=983.4795  Separability=0.2477  SpanErr=2.27e-15
    Var ratio U=338328.91  Var ratio X=75837612243.33  Reduction=224153.51x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/analytics/exp2_spectral_analysis_k8.json

  k=10:
    WARNING: no cached matrices found, recomputing...
    d_effective=1427, ortho_error=2.4096946660279173e-10
    Condition U=4.4633  Condition X=1523.2460  Separability=0.2476  SpanErr=2.44e-15
    Var ratio U=7640053.30  Var ratio X=68255289926.70  Reduction=8933.88x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/analytics/exp2_spectral_analysis_k10.json

  k=12:
    WARNING: no cached matrices found, recomputing...
    d_effective=1427, ortho_error=2.4091018069327674e-10
    Condition U=4.4639  Condition X=2225.9265  Separability=0.2478  SpanErr=2.26e-15
    Var ratio U=160682847.75  Var ratio X=62107840472.63  Reduction=386.52x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/analytics/exp2_spectral_analysis_k12.json

  k=20:
    WARNING: no cached matrices found, recomputing...
    d_effective=1262, ortho_error=2.367255280688596e-10
    Condition U=5.2130  Condition X=7820.8102  Separability=0.2492  SpanErr=2.32e-15
    Var ratio U=1184543186.87  Var ratio X=46000712800.27  Reduction=38.83x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/analytics/exp2_spectral_analysis_k20.json

  k=30:
    WARNING: no cached matrices found, recomputing...
    d_effective=862, ortho_error=2.1708301822798148e-10
    Condition U=13.6091  Condition X=26422.6569  Separability=0.2474  SpanErr=2.40e-15
    Var ratio U=1027393993.00  Var ratio X=35444737367.78  Reduction=34.50x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/analytics/exp2_spectral_analysis_k30.json

================================================================================
EXP 8: k-SENSITIVITY ANALYSIS
================================================================================

     k    SGC+MLP      R+Std       R+RN     Part A     Part B    Rem.Gap     Fisher   n_runs
  -----------------------------------------------------------------------------------------------
     1     69.57%     46.42%     31.40%    +23.148    -15.024    +38.171    0.05175       15
     2     69.52%     47.12%     32.02%    +22.397    -15.097    +37.494    0.04167       15
     4     74.17%     48.42%     31.92%    +25.756    -16.495    +42.251    0.04140       15
     6     75.56%     48.31%     31.87%    +27.250    -16.437    +43.687    0.04042       15
     8     76.20%     46.62%     33.12%    +29.574    -13.501    +43.075    0.04130       15
    10     76.19%     46.30%     33.03%    +29.887    -13.275    +43.162    0.03999       15
    12     77.09%     47.11%     33.63%    +29.974    -13.479    +43.454    0.03928       15
    20     76.93%     46.78%     35.05%    +30.157    -11.723    +41.880    0.04279       15
    30     75.97%     49.95%     37.52%    +26.018    -12.430    +38.448    0.06532       15

  Saved JSON: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/analytics/exp8_k_sensitivity.json
  Saved CSV:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/analytics/exp8_k_sensitivity.csv

================================================================================
MASTER ANALYTICS COMPLETE
================================================================================
Analytics saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_fixed_lcc/analytics
[1/2] Training: cora random
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER TRAINING EXPERIMENT
================================================================================
Dataset:      cora
k values:     [1, 2, 4, 6, 8, 10, 12, 20, 30]
Split type:   random  (5 split(s) x 15 seeds)
Component:    lcc
Device:       cuda
Output base:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc
================================================================================

[Step 1] Loading dataset...
Nodes: 2,708, Features: 1433, Classes: 7

[Step 2] Building graph matrices...

[Step 3] Extracting largest connected component...
Rebuilding graph matrices for LCC...
After step 3: nodes=2,485, classes=7, disconnected_components_to_skip=0

[Step 4] Preparing splits...
Random split 0: Train=1491, Val=497, Test=497
Random split 1: Train=1491, Val=497, Test=497
Random split 2: Train=1491, Val=497, Test=497
Random split 3: Train=1491, Val=497, Test=497
Random split 4: Train=1491, Val=497, Test=497

[Step 5] Computing SGC normalized adjacency...
A_sgc = D^{-1/2}(A+I)D^{-1/2}

================================================================================
K = 1
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=1.62e-10

  --- Split 2/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=1.62e-10

  --- Split 3/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=1.62e-10

  --- Split 4/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=1.62e-10

  --- Split 5/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=1.62e-10

  Aggregating results for k=1 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          85.06%     1.34%    75
  restricted_standard_mlp                                   72.96%     3.00%    75
  restricted_rownorm_mlp                                    71.01%     2.39%    75

  Framework Analysis (k=1):
    Part A (SGC+MLP - Restricted+Std): +12.105 pp
    Part B (RowNorm - Restricted+Std): -1.945 pp
    Remaining Gap:                     +14.050 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k1/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k1/diagnostics/fisher_diagnostic.json

================================================================================
K = 2
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=1.95e-10

  --- Split 2/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=1.95e-10

  --- Split 3/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=1.95e-10

  --- Split 4/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=1.95e-10

  --- Split 5/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=1.95e-10

  Aggregating results for k=2 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          86.34%     1.61%    75
  restricted_standard_mlp                                   75.31%     2.40%    75
  restricted_rownorm_mlp                                    71.84%     3.21%    75

  Framework Analysis (k=2):
    Part A (SGC+MLP - Restricted+Std): +11.029 pp
    Part B (RowNorm - Restricted+Std): -3.469 pp
    Remaining Gap:                     +14.498 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k2/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k2/diagnostics/fisher_diagnostic.json

================================================================================
K = 4
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.36e-10

  --- Split 2/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.36e-10

  --- Split 3/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.36e-10

  --- Split 4/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.36e-10

  --- Split 5/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.36e-10

  Aggregating results for k=4 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          85.63%     1.60%    75
  restricted_standard_mlp                                   75.31%     1.86%    75
  restricted_rownorm_mlp                                    72.11%     2.76%    75

  Framework Analysis (k=4):
    Part A (SGC+MLP - Restricted+Std): +10.313 pp
    Part B (RowNorm - Restricted+Std): -3.203 pp
    Remaining Gap:                     +13.516 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k4/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k4/diagnostics/fisher_diagnostic.json

================================================================================
K = 6
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  --- Split 2/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  --- Split 3/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  --- Split 4/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  --- Split 5/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  Aggregating results for k=6 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          85.77%     1.56%    75
  restricted_standard_mlp                                   75.00%     1.98%    75
  restricted_rownorm_mlp                                    72.55%     2.53%    75

  Framework Analysis (k=6):
    Part A (SGC+MLP - Restricted+Std): +10.761 pp
    Part B (RowNorm - Restricted+Std): -2.455 pp
    Remaining Gap:                     +13.215 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k6/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k6/diagnostics/fisher_diagnostic.json

================================================================================
K = 8
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  --- Split 2/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  --- Split 3/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  --- Split 4/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  --- Split 5/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  Aggregating results for k=8 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          85.72%     1.74%    75
  restricted_standard_mlp                                   75.02%     1.76%    75
  restricted_rownorm_mlp                                    72.73%     2.45%    75

  Framework Analysis (k=8):
    Part A (SGC+MLP - Restricted+Std): +10.693 pp
    Part B (RowNorm - Restricted+Std): -2.294 pp
    Remaining Gap:                     +12.987 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k8/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k8/diagnostics/fisher_diagnostic.json

================================================================================
K = 10
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k10/training_curves/split0_dynamics.json

  --- Split 2/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k10/training_curves/split1_dynamics.json

  --- Split 3/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k10/training_curves/split2_dynamics.json

  --- Split 4/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k10/training_curves/split3_dynamics.json

  --- Split 5/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k10/training_curves/split4_dynamics.json

  Aggregating results for k=10 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          85.60%     1.87%    75
  restricted_standard_mlp                                   74.47%     1.94%    75
  restricted_rownorm_mlp                                    72.13%     2.31%    75
  log_magnitude                                             60.25%     2.55%    75
  dual_stream                                               59.15%     2.28%    75
  spectral_rownorm_alpha-1.0                                84.11%     1.46%    75
  spectral_rownorm_alpha-0.5                                82.44%     1.88%    75
  spectral_rownorm_alpha0.0                                 59.91%     2.33%    75
  spectral_rownorm_alpha0.5                                 50.40%     1.90%    75
  spectral_rownorm_alpha1.0                                 64.21%     2.72%    75
  nested_spheres_a-1.0_b-1.0                                84.12%     1.43%    75
  nested_spheres_a-1.0_b-0.5                                84.15%     1.47%    75
  nested_spheres_a-1.0_b0.0                                 83.98%     1.35%    75
  nested_spheres_a-1.0_b0.5                                 84.12%     1.32%    75
  nested_spheres_a-1.0_b1.0                                 83.94%     1.37%    75
  nested_spheres_a-0.5_b-1.0                                82.50%     1.74%    75
  nested_spheres_a-0.5_b-0.5                                82.48%     1.77%    75
  nested_spheres_a-0.5_b0.0                                 82.43%     1.77%    75
  nested_spheres_a-0.5_b0.5                                 82.45%     1.67%    75
  nested_spheres_a-0.5_b1.0                                 82.56%     1.71%    75
  nested_spheres_a0.0_b-1.0                                 60.31%     2.63%    75
  nested_spheres_a0.0_b-0.5                                 60.38%     2.50%    75
  nested_spheres_a0.0_b0.0                                  60.01%     2.23%    75
  nested_spheres_a0.0_b0.5                                  60.32%     2.55%    75
  nested_spheres_a0.0_b1.0                                  60.25%     2.55%    75
  nested_spheres_a0.5_b-1.0                                 50.45%     2.03%    75
  nested_spheres_a0.5_b-0.5                                 50.79%     2.16%    75
  nested_spheres_a0.5_b0.0                                  50.73%     1.94%    75
  nested_spheres_a0.5_b0.5                                  50.81%     2.39%    75
  nested_spheres_a0.5_b1.0                                  50.58%     2.14%    75
  nested_spheres_a1.0_b-1.0                                 63.82%     2.61%    75
  nested_spheres_a1.0_b-0.5                                 64.40%     2.78%    75
  nested_spheres_a1.0_b0.0                                  63.97%     2.70%    75
  nested_spheres_a1.0_b0.5                                  64.68%     2.57%    75
  nested_spheres_a1.0_b1.0                                  64.10%     2.82%    75

  Framework Analysis (k=10):
    Part A (SGC+MLP - Restricted+Std): +11.125 pp
    Part B (RowNorm - Restricted+Std): -2.347 pp
    Remaining Gap:                     +13.473 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k10/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k10/diagnostics/fisher_diagnostic.json

================================================================================
K = 12
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  --- Split 2/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  --- Split 3/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  --- Split 4/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  --- Split 5/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1427, ortho_error=2.41e-10

  Aggregating results for k=12 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          85.46%     1.94%    75
  restricted_standard_mlp                                   73.89%     1.82%    75
  restricted_rownorm_mlp                                    72.46%     2.44%    75

  Framework Analysis (k=12):
    Part A (SGC+MLP - Restricted+Std): +11.571 pp
    Part B (RowNorm - Restricted+Std): -1.430 pp
    Remaining Gap:                     +13.001 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k12/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k12/diagnostics/fisher_diagnostic.json

================================================================================
K = 20
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1262, ortho_error=2.37e-10

  --- Split 2/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1262, ortho_error=2.37e-10

  --- Split 3/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1262, ortho_error=2.37e-10

  --- Split 4/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1262, ortho_error=2.37e-10

  --- Split 5/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=1262, ortho_error=2.37e-10

  Aggregating results for k=20 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          84.63%     1.80%    75
  restricted_standard_mlp                                   74.18%     1.53%    75
  restricted_rownorm_mlp                                    73.58%     2.12%    75

  Framework Analysis (k=20):
    Part A (SGC+MLP - Restricted+Std): +10.455 pp
    Part B (RowNorm - Restricted+Std): -0.598 pp
    Remaining Gap:                     +11.053 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k20/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k20/diagnostics/fisher_diagnostic.json

================================================================================
K = 30
================================================================================
  X_diffused shape: (2485, 1433)

  --- Split 1/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=862, ortho_error=2.17e-10

  --- Split 2/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=862, ortho_error=2.17e-10

  --- Split 3/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=862, ortho_error=2.17e-10

  --- Split 4/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=862, ortho_error=2.17e-10

  --- Split 5/5 (train=1491, val=497, test=497) ---
  Computing restricted eigenvectors...
  d_effective=862, ortho_error=2.17e-10

  Aggregating results for k=30 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          83.88%     1.74%    75
  restricted_standard_mlp                                   73.63%     1.44%    75
  restricted_rownorm_mlp                                    73.53%     2.00%    75

  Framework Analysis (k=30):
    Part A (SGC+MLP - Restricted+Std): +10.254 pp
    Part B (RowNorm - Restricted+Std): -0.099 pp
    Remaining Gap:                     +10.353 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k30/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/k30/diagnostics/fisher_diagnostic.json

================================================================================
MASTER TRAINING EXPERIMENT COMPLETE
================================================================================
Results saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc
[2/2] Analytics: cora random
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER ANALYTICS (Exp 2 + Exp 8)
================================================================================
Dataset:       cora
Split type:    random
Component:     lcc
k values:      [1, 2, 4, 6, 8, 10, 12, 20, 30]
Results dir:   /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc
================================================================================

[Step 1] Loading dataset and graph...
Nodes: 2,708, Features: 1433, Classes: 7

[Step 2] Extracting LCC...
After LCC: nodes=2,485, classes=7

================================================================================
EXP 2: SPECTRAL ANALYSIS (all k values)
================================================================================

  k=1:
    WARNING: no cached matrices found, recomputing...
    d_effective=1427, ortho_error=1.6218537624013152e-10
    Condition U=163.3456  Condition X=inf  Separability=0.0879  SpanErr=1.65e-02
    Var ratio U=5.61  Var ratio X=122914993599.67  Reduction=21911170278.13x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/analytics/exp2_spectral_analysis_k1.json

  k=2:
    WARNING: no cached matrices found, recomputing...
    d_effective=1427, ortho_error=1.9516677163267104e-10
    Condition U=316.1259  Condition X=inf  Separability=0.0891  SpanErr=1.77e-02
    Var ratio U=6.94  Var ratio X=90645837173.84  Reduction=13053579863.82x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/analytics/exp2_spectral_analysis_k2.json

  k=4:
    WARNING: no cached matrices found, recomputing...
    d_effective=1427, ortho_error=2.3602642063025314e-10
    Condition U=1599.1919  Condition X=inf  Separability=0.0895  SpanErr=1.73e-02
    Var ratio U=6.02  Var ratio X=73656655409.13  Reduction=12238883517.05x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/analytics/exp2_spectral_analysis_k4.json

  k=6:
    WARNING: no cached matrices found, recomputing...
    d_effective=1427, ortho_error=2.4083490757220716e-10
    Condition U=10084.1059  Condition X=inf  Separability=0.0896  SpanErr=2.13e-02
    Var ratio U=4.83  Var ratio X=64366586867.81  Reduction=13325603809.18x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/analytics/exp2_spectral_analysis_k6.json

  k=8:
    WARNING: no cached matrices found, recomputing...
    d_effective=1427, ortho_error=2.4104429563465146e-10
    Condition U=23057.2763  Condition X=inf  Separability=0.0896  SpanErr=2.46e-02
    Var ratio U=7.47  Var ratio X=58023878408.34  Reduction=7771938818.61x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/analytics/exp2_spectral_analysis_k8.json

  k=10:
    WARNING: no cached matrices found, recomputing...
    d_effective=1427, ortho_error=2.4096946660279173e-10
    Condition U=26534.9643  Condition X=inf  Separability=0.0896  SpanErr=2.60e-02
    Var ratio U=6.94  Var ratio X=53255653272.12  Reduction=7674694691.62x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/analytics/exp2_spectral_analysis_k10.json

  k=12:
    WARNING: no cached matrices found, recomputing...
    d_effective=1427, ortho_error=2.4091018069327674e-10
    Condition U=57841.3790  Condition X=inf  Separability=0.0897  SpanErr=2.51e-02
    Var ratio U=6.49  Var ratio X=49460595158.22  Reduction=7623933168.33x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/analytics/exp2_spectral_analysis_k12.json

  k=20:
    WARNING: no cached matrices found, recomputing...
    d_effective=1262, ortho_error=2.367255280688596e-10
    Condition U=101292.7857  Condition X=inf  Separability=0.0934  SpanErr=9.24e-02
    Var ratio U=10.92  Var ratio X=39429140827.10  Reduction=3612213857.31x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/analytics/exp2_spectral_analysis_k20.json

  k=30:
    WARNING: no cached matrices found, recomputing...
    d_effective=862, ortho_error=2.1708301822798148e-10
    Condition U=841.0271  Condition X=inf  Separability=0.1066  SpanErr=2.48e-01
    Var ratio U=14.88  Var ratio X=32456898509.73  Reduction=2180955299.57x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/analytics/exp2_spectral_analysis_k30.json

================================================================================
EXP 8: k-SENSITIVITY ANALYSIS
================================================================================

     k    SGC+MLP      R+Std       R+RN     Part A     Part B    Rem.Gap     Fisher   n_runs
  -----------------------------------------------------------------------------------------------
     1     85.06%     72.96%     71.01%    +12.105     -1.945    +14.050    0.01251       75
     2     86.34%     75.31%     71.84%    +11.029     -3.469    +14.498    0.01300       75
     4     85.63%     75.31%     72.11%    +10.312     -3.203    +13.516    0.01311       75
     6     85.77%     75.00%     72.55%    +10.761     -2.455    +13.215    0.01282       75
     8     85.72%     75.02%     72.73%    +10.694     -2.294    +12.987    0.01286       75
    10     85.60%     74.47%     72.13%    +11.125     -2.347    +13.473    0.01275       75
    12     85.46%     73.89%     72.46%    +11.571     -1.430    +13.001    0.01273       75
    20     84.63%     74.18%     73.58%    +10.455     -0.598    +11.053    0.01348       75
    30     83.88%     73.63%     73.53%    +10.254     -0.099    +10.353    0.01710       75

  Saved JSON: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/analytics/exp8_k_sensitivity.json
  Saved CSV:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/analytics/exp8_k_sensitivity.csv

================================================================================
MASTER ANALYTICS COMPLETE
================================================================================
Analytics saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/cora_random_lcc/analytics
   cora complete  |  Sun Feb 22 09:40:14 PM EST 2026

--------------------------------------------------------
 DATASET: citeseer  |  Sun Feb 22 09:40:14 PM EST 2026
--------------------------------------------------------
[1/2] Training: citeseer fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER TRAINING EXPERIMENT
================================================================================
Dataset:      citeseer
k values:     [1, 2, 4, 6, 8, 10, 12, 20, 30]
Split type:   fixed  (1 split(s) x 15 seeds)
Component:    lcc
Device:       cuda
Output base:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc
================================================================================

[Step 1] Loading dataset...
Nodes: 3,327, Features: 3703, Classes: 6

[Step 2] Building graph matrices...

[Step 3] Extracting largest connected component...
Rebuilding graph matrices for LCC...
After step 3: nodes=2,120, classes=6, disconnected_components_to_skip=0

[Step 4] Preparing splits...
Fixed split: Train=80, Val=328, Test=663

[Step 5] Computing SGC normalized adjacency...
A_sgc = D^{-1/2}(A+I)D^{-1/2}

================================================================================
K = 1
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/1 (train=80, val=328, test=663) ---
  Computing restricted eigenvectors...
  d_effective=2035, ortho_error=2.24e-10

  Aggregating results for k=1 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          58.38%     2.21%    15
  restricted_standard_mlp                                   26.47%     3.06%    15
  restricted_rownorm_mlp                                    22.99%     1.26%    15

  Framework Analysis (k=1):
    Part A (SGC+MLP - Restricted+Std): +31.916 pp
    Part B (RowNorm - Restricted+Std): -3.479 pp
    Remaining Gap:                     +35.395 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k1/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k1/diagnostics/fisher_diagnostic.json

================================================================================
K = 2
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/1 (train=80, val=328, test=663) ---
  Computing restricted eigenvectors...
  d_effective=2035, ortho_error=2.24e-10

  Aggregating results for k=2 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          54.18%     1.54%    15
  restricted_standard_mlp                                   28.07%     2.59%    15
  restricted_rownorm_mlp                                    24.81%     1.60%    15

  Framework Analysis (k=2):
    Part A (SGC+MLP - Restricted+Std): +26.104 pp
    Part B (RowNorm - Restricted+Std): -3.268 pp
    Remaining Gap:                     +29.372 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k2/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k2/diagnostics/fisher_diagnostic.json

================================================================================
K = 4
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/1 (train=80, val=328, test=663) ---
  Computing restricted eigenvectors...
  d_effective=2033, ortho_error=2.24e-10

  Aggregating results for k=4 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          62.43%     0.92%    15
  restricted_standard_mlp                                   28.65%     2.94%    15
  restricted_rownorm_mlp                                    24.19%     1.50%    15

  Framework Analysis (k=4):
    Part A (SGC+MLP - Restricted+Std): +33.786 pp
    Part B (RowNorm - Restricted+Std): -4.455 pp
    Remaining Gap:                     +38.240 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k4/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k4/diagnostics/fisher_diagnostic.json

================================================================================
K = 6
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/1 (train=80, val=328, test=663) ---
  Computing restricted eigenvectors...
  d_effective=1989, ortho_error=2.23e-10

  Aggregating results for k=6 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          61.72%     1.41%    15
  restricted_standard_mlp                                   26.57%     2.78%    15
  restricted_rownorm_mlp                                    24.29%     1.62%    15

  Framework Analysis (k=6):
    Part A (SGC+MLP - Restricted+Std): +35.153 pp
    Part B (RowNorm - Restricted+Std): -2.272 pp
    Remaining Gap:                     +37.426 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k6/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k6/diagnostics/fisher_diagnostic.json

================================================================================
K = 8
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/1 (train=80, val=328, test=663) ---
  Computing restricted eigenvectors...
  d_effective=1897, ortho_error=2.21e-10

  Aggregating results for k=8 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          64.14%     2.04%    15
  restricted_standard_mlp                                   30.97%     2.99%    15
  restricted_rownorm_mlp                                    25.92%     2.03%    15

  Framework Analysis (k=8):
    Part A (SGC+MLP - Restricted+Std): +33.172 pp
    Part B (RowNorm - Restricted+Std): -5.048 pp
    Remaining Gap:                     +38.220 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k8/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k8/diagnostics/fisher_diagnostic.json

================================================================================
K = 10
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/1 (train=80, val=328, test=663) ---
  Computing restricted eigenvectors...
  d_effective=1782, ortho_error=2.18e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k10/training_curves/split0_dynamics.json

  Aggregating results for k=10 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          66.72%     1.88%    15
  restricted_standard_mlp                                   30.15%     3.76%    15
  restricted_rownorm_mlp                                    26.93%     1.47%    15
  log_magnitude                                             24.44%     1.48%    15
  dual_stream                                               24.01%     1.16%    15
  spectral_rownorm_alpha-1.0                                68.08%     1.11%    15
  spectral_rownorm_alpha-0.5                                68.46%     1.06%    15
  spectral_rownorm_alpha0.0                                 26.25%     2.59%    15
  spectral_rownorm_alpha0.5                                 21.19%     0.99%    15
  spectral_rownorm_alpha1.0                                 23.90%     1.31%    15
  nested_spheres_a-1.0_b-1.0                                66.34%     1.53%    15
  nested_spheres_a-1.0_b-0.5                                66.00%     1.81%    15
  nested_spheres_a-1.0_b0.0                                 67.76%     1.64%    15
  nested_spheres_a-1.0_b0.5                                 66.61%     1.74%    15
  nested_spheres_a-1.0_b1.0                                 66.86%     1.60%    15
  nested_spheres_a-0.5_b-1.0                                66.58%     0.98%    15
  nested_spheres_a-0.5_b-0.5                                66.67%     1.34%    15
  nested_spheres_a-0.5_b0.0                                 68.02%     1.75%    15
  nested_spheres_a-0.5_b0.5                                 67.48%     0.90%    15
  nested_spheres_a-0.5_b1.0                                 66.48%     1.51%    15
  nested_spheres_a0.0_b-1.0                                 26.37%     1.96%    15
  nested_spheres_a0.0_b-0.5                                 26.87%     2.31%    15
  nested_spheres_a0.0_b0.0                                  26.04%     2.04%    15
  nested_spheres_a0.0_b0.5                                  26.09%     1.79%    15
  nested_spheres_a0.0_b1.0                                  24.44%     1.48%    15
  nested_spheres_a0.5_b-1.0                                 22.08%     0.78%    15
  nested_spheres_a0.5_b-0.5                                 22.14%     0.90%    15
  nested_spheres_a0.5_b0.0                                  21.33%     1.23%    15
  nested_spheres_a0.5_b0.5                                  22.02%     0.78%    15
  nested_spheres_a0.5_b1.0                                  22.16%     0.84%    15
  nested_spheres_a1.0_b-1.0                                 24.97%     1.40%    15
  nested_spheres_a1.0_b-0.5                                 24.65%     1.23%    15
  nested_spheres_a1.0_b0.0                                  24.35%     1.49%    15
  nested_spheres_a1.0_b0.5                                  24.70%     1.56%    15
  nested_spheres_a1.0_b1.0                                  25.50%     1.48%    15

  Framework Analysis (k=10):
    Part A (SGC+MLP - Restricted+Std): +36.571 pp
    Part B (RowNorm - Restricted+Std): -3.218 pp
    Remaining Gap:                     +39.789 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k10/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k10/diagnostics/fisher_diagnostic.json

================================================================================
K = 12
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/1 (train=80, val=328, test=663) ---
  Computing restricted eigenvectors...
  d_effective=1653, ortho_error=2.15e-10

  Aggregating results for k=12 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          67.40%     2.26%    15
  restricted_standard_mlp                                   32.83%     2.84%    15
  restricted_rownorm_mlp                                    29.59%     1.34%    15

  Framework Analysis (k=12):
    Part A (SGC+MLP - Restricted+Std): +34.570 pp
    Part B (RowNorm - Restricted+Std): -3.238 pp
    Remaining Gap:                     +37.808 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k12/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k12/diagnostics/fisher_diagnostic.json

================================================================================
K = 20
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/1 (train=80, val=328, test=663) ---
  Computing restricted eigenvectors...
  d_effective=1246, ortho_error=1.99e-10

  Aggregating results for k=20 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          69.13%     1.47%    15
  restricted_standard_mlp                                   34.57%     1.08%    15
  restricted_rownorm_mlp                                    28.46%     2.59%    15

  Framework Analysis (k=20):
    Part A (SGC+MLP - Restricted+Std): +34.560 pp
    Part B (RowNorm - Restricted+Std): -6.114 pp
    Remaining Gap:                     +40.674 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k20/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k20/diagnostics/fisher_diagnostic.json

================================================================================
K = 30
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/1 (train=80, val=328, test=663) ---
  Computing restricted eigenvectors...
  d_effective=900, ortho_error=1.83e-10

  Aggregating results for k=30 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          69.52%     1.75%    15
  restricted_standard_mlp                                   36.38%     0.71%    15
  restricted_rownorm_mlp                                    31.14%     1.12%    15

  Framework Analysis (k=30):
    Part A (SGC+MLP - Restricted+Std): +33.142 pp
    Part B (RowNorm - Restricted+Std): -5.239 pp
    Remaining Gap:                     +38.381 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k30/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/k30/diagnostics/fisher_diagnostic.json

================================================================================
MASTER TRAINING EXPERIMENT COMPLETE
================================================================================
Results saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc
[2/2] Analytics: citeseer fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER ANALYTICS (Exp 2 + Exp 8)
================================================================================
Dataset:       citeseer
Split type:    fixed
Component:     lcc
k values:      [1, 2, 4, 6, 8, 10, 12, 20, 30]
Results dir:   /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc
================================================================================

[Step 1] Loading dataset and graph...
Nodes: 3,327, Features: 3703, Classes: 6

[Step 2] Extracting LCC...
After LCC: nodes=2,120, classes=6

================================================================================
EXP 2: SPECTRAL ANALYSIS (all k values)
================================================================================

  k=1:
    WARNING: no cached matrices found, recomputing...
    d_effective=2035, ortho_error=2.2393320531222116e-10
    Condition U=2.9187  Condition X=10.5046  Separability=0.2775  SpanErr=2.28e-15
    Var ratio U=1293142345.50  Var ratio X=144635137498.32  Reduction=111.85x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/analytics/exp2_spectral_analysis_k1.json

  k=2:
    WARNING: no cached matrices found, recomputing...
    d_effective=2035, ortho_error=2.2392232512657984e-10
    Condition U=2.9211  Condition X=24.9749  Separability=0.2769  SpanErr=2.09e-15
    Var ratio U=1438097286.19  Var ratio X=121476707460.06  Reduction=84.47x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/analytics/exp2_spectral_analysis_k2.json

  k=4:
    WARNING: no cached matrices found, recomputing...
    d_effective=2033, ortho_error=2.2394430754246741e-10
    Condition U=2.9235  Condition X=56.1993  Separability=0.2770  SpanErr=2.79e-15
    Var ratio U=1484501735.54  Var ratio X=113519464549.86  Reduction=76.47x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/analytics/exp2_spectral_analysis_k4.json

  k=6:
    WARNING: no cached matrices found, recomputing...
    d_effective=1989, ortho_error=2.2338697558410558e-10
    Condition U=2.9275  Condition X=119.5150  Separability=0.2778  SpanErr=2.12e-15
    Var ratio U=1121106347.66  Var ratio X=107691562987.68  Reduction=96.06x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/analytics/exp2_spectral_analysis_k6.json

  k=8:
    WARNING: no cached matrices found, recomputing...
    d_effective=1897, ortho_error=2.2129897914169305e-10
    Condition U=2.9289  Condition X=181.1557  Separability=0.2775  SpanErr=2.24e-15
    Var ratio U=711666624.59  Var ratio X=103072807421.57  Reduction=144.83x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/analytics/exp2_spectral_analysis_k8.json

  k=10:
    WARNING: no cached matrices found, recomputing...
    d_effective=1782, ortho_error=2.182025671260135e-10
    Condition U=3.0667  Condition X=277.0239  Separability=0.2779  SpanErr=2.64e-15
    Var ratio U=2067098618.71  Var ratio X=99278296353.95  Reduction=48.03x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/analytics/exp2_spectral_analysis_k10.json

  k=12:
    WARNING: no cached matrices found, recomputing...
    d_effective=1653, ortho_error=2.149936895179394e-10
    Condition U=3.1310  Condition X=438.7265  Separability=0.2764  SpanErr=2.85e-15
    Var ratio U=2161707136.45  Var ratio X=96047321983.88  Reduction=44.43x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/analytics/exp2_spectral_analysis_k12.json

  k=20:
    WARNING: no cached matrices found, recomputing...
    d_effective=1246, ortho_error=1.9887091973203042e-10
    Condition U=4.2973  Condition X=1403.3886  Separability=0.2779  SpanErr=1.99e-15
    Var ratio U=2122897637.58  Var ratio X=86261890082.10  Reduction=40.63x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/analytics/exp2_spectral_analysis_k20.json

  k=30:
    WARNING: no cached matrices found, recomputing...
    d_effective=900, ortho_error=1.8277324098647796e-10
    Condition U=7.2202  Condition X=4111.4289  Separability=0.2768  SpanErr=2.80e-15
    Var ratio U=210136.56  Var ratio X=77554942207.91  Reduction=369069.25x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/analytics/exp2_spectral_analysis_k30.json

================================================================================
EXP 8: k-SENSITIVITY ANALYSIS
================================================================================

     k    SGC+MLP      R+Std       R+RN     Part A     Part B    Rem.Gap     Fisher   n_runs
  -----------------------------------------------------------------------------------------------
     1     58.38%     26.47%     22.99%    +31.916     -3.479    +35.395    0.07332       15
     2     54.18%     28.07%     24.81%    +26.104     -3.268    +29.372    0.08026       15
     4     62.43%     28.65%     24.19%    +33.786     -4.455    +38.240    0.07936       15
     6     61.72%     26.57%     24.29%    +35.153     -2.272    +37.426    0.07243       15
     8     64.14%     30.97%     25.92%    +33.172     -5.048    +38.220    0.07015       15
    10     66.72%     30.15%     26.93%    +36.571     -3.218    +39.789    0.07188       15
    12     67.40%     32.83%     29.59%    +34.570     -3.238    +37.808    0.07419       15
    20     69.13%     34.57%     28.46%    +34.560     -6.114    +40.674    0.05438       15
    30     69.52%     36.38%     31.14%    +33.142     -5.239    +38.381    0.04578       15

  Saved JSON: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/analytics/exp8_k_sensitivity.json
  Saved CSV:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/analytics/exp8_k_sensitivity.csv

================================================================================
MASTER ANALYTICS COMPLETE
================================================================================
Analytics saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_fixed_lcc/analytics
[1/2] Training: citeseer random
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER TRAINING EXPERIMENT
================================================================================
Dataset:      citeseer
k values:     [1, 2, 4, 6, 8, 10, 12, 20, 30]
Split type:   random  (5 split(s) x 15 seeds)
Component:    lcc
Device:       cuda
Output base:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc
================================================================================

[Step 1] Loading dataset...
Nodes: 3,327, Features: 3703, Classes: 6

[Step 2] Building graph matrices...

[Step 3] Extracting largest connected component...
Rebuilding graph matrices for LCC...
After step 3: nodes=2,120, classes=6, disconnected_components_to_skip=0

[Step 4] Preparing splits...
Random split 0: Train=1272, Val=424, Test=424
Random split 1: Train=1272, Val=424, Test=424
Random split 2: Train=1272, Val=424, Test=424
Random split 3: Train=1272, Val=424, Test=424
Random split 4: Train=1272, Val=424, Test=424

[Step 5] Computing SGC normalized adjacency...
A_sgc = D^{-1/2}(A+I)D^{-1/2}

================================================================================
K = 1
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=2035, ortho_error=2.24e-10

  --- Split 2/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=2035, ortho_error=2.24e-10

  --- Split 3/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=2035, ortho_error=2.24e-10

  --- Split 4/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=2035, ortho_error=2.24e-10

  --- Split 5/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=2035, ortho_error=2.24e-10

  Aggregating results for k=1 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          73.56%     2.29%    75
  restricted_standard_mlp                                   63.20%     2.48%    75
  restricted_rownorm_mlp                                    65.83%     1.72%    75

  Framework Analysis (k=1):
    Part A (SGC+MLP - Restricted+Std): +10.362 pp
    Part B (RowNorm - Restricted+Std): +2.632 pp
    Remaining Gap:                     +7.730 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k1/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k1/diagnostics/fisher_diagnostic.json

================================================================================
K = 2
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=2035, ortho_error=2.24e-10

  --- Split 2/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=2035, ortho_error=2.24e-10

  --- Split 3/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=2035, ortho_error=2.24e-10

  --- Split 4/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=2035, ortho_error=2.24e-10

  --- Split 5/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=2035, ortho_error=2.24e-10

  Aggregating results for k=2 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          73.90%     2.39%    75
  restricted_standard_mlp                                   61.16%     2.42%    75
  restricted_rownorm_mlp                                    66.02%     1.47%    75

  Framework Analysis (k=2):
    Part A (SGC+MLP - Restricted+Std): +12.745 pp
    Part B (RowNorm - Restricted+Std): +4.862 pp
    Remaining Gap:                     +7.884 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k2/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k2/diagnostics/fisher_diagnostic.json

================================================================================
K = 4
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=2033, ortho_error=2.24e-10

  --- Split 2/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=2033, ortho_error=2.24e-10

  --- Split 3/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=2033, ortho_error=2.24e-10

  --- Split 4/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=2033, ortho_error=2.24e-10

  --- Split 5/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=2033, ortho_error=2.24e-10

  Aggregating results for k=4 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          73.94%     1.92%    75
  restricted_standard_mlp                                   61.44%     2.48%    75
  restricted_rownorm_mlp                                    66.02%     1.90%    75

  Framework Analysis (k=4):
    Part A (SGC+MLP - Restricted+Std): +12.494 pp
    Part B (RowNorm - Restricted+Std): +4.572 pp
    Remaining Gap:                     +7.921 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k4/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k4/diagnostics/fisher_diagnostic.json

================================================================================
K = 6
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1989, ortho_error=2.23e-10

  --- Split 2/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1989, ortho_error=2.23e-10

  --- Split 3/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1989, ortho_error=2.23e-10

  --- Split 4/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1989, ortho_error=2.23e-10

  --- Split 5/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1989, ortho_error=2.23e-10

  Aggregating results for k=6 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          74.54%     2.13%    75
  restricted_standard_mlp                                   60.53%     2.50%    75
  restricted_rownorm_mlp                                    65.29%     1.84%    75

  Framework Analysis (k=6):
    Part A (SGC+MLP - Restricted+Std): +14.009 pp
    Part B (RowNorm - Restricted+Std): +4.755 pp
    Remaining Gap:                     +9.255 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k6/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k6/diagnostics/fisher_diagnostic.json

================================================================================
K = 8
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1897, ortho_error=2.21e-10

  --- Split 2/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1897, ortho_error=2.21e-10

  --- Split 3/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1897, ortho_error=2.21e-10

  --- Split 4/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1897, ortho_error=2.21e-10

  --- Split 5/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1897, ortho_error=2.21e-10

  Aggregating results for k=8 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          74.44%     2.11%    75
  restricted_standard_mlp                                   61.20%     1.92%    75
  restricted_rownorm_mlp                                    63.00%     1.82%    75

  Framework Analysis (k=8):
    Part A (SGC+MLP - Restricted+Std): +13.236 pp
    Part B (RowNorm - Restricted+Std): +1.799 pp
    Remaining Gap:                     +11.437 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k8/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k8/diagnostics/fisher_diagnostic.json

================================================================================
K = 10
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1782, ortho_error=2.18e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k10/training_curves/split0_dynamics.json

  --- Split 2/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1782, ortho_error=2.18e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k10/training_curves/split1_dynamics.json

  --- Split 3/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1782, ortho_error=2.18e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k10/training_curves/split2_dynamics.json

  --- Split 4/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1782, ortho_error=2.18e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k10/training_curves/split3_dynamics.json

  --- Split 5/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1782, ortho_error=2.18e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k10/training_curves/split4_dynamics.json

  Aggregating results for k=10 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          74.04%     2.12%    75
  restricted_standard_mlp                                   60.04%     3.80%    75
  restricted_rownorm_mlp                                    62.96%     1.83%    75
  log_magnitude                                             39.54%     1.70%    75
  dual_stream                                               38.97%     2.09%    75
  spectral_rownorm_alpha-1.0                                74.57%     1.47%    75
  spectral_rownorm_alpha-0.5                                72.89%     2.16%    75
  spectral_rownorm_alpha0.0                                 39.39%     2.00%    75
  spectral_rownorm_alpha0.5                                 25.51%     1.73%    75
  spectral_rownorm_alpha1.0                                 40.25%     2.03%    75
  nested_spheres_a-1.0_b-1.0                                74.53%     1.65%    75
  nested_spheres_a-1.0_b-0.5                                74.58%     1.43%    75
  nested_spheres_a-1.0_b0.0                                 74.67%     1.47%    75
  nested_spheres_a-1.0_b0.5                                 74.75%     1.40%    75
  nested_spheres_a-1.0_b1.0                                 74.65%     1.78%    75
  nested_spheres_a-0.5_b-1.0                                72.88%     2.20%    75
  nested_spheres_a-0.5_b-0.5                                72.92%     2.29%    75
  nested_spheres_a-0.5_b0.0                                 72.87%     2.34%    75
  nested_spheres_a-0.5_b0.5                                 72.80%     2.15%    75
  nested_spheres_a-0.5_b1.0                                 72.92%     2.27%    75
  nested_spheres_a0.0_b-1.0                                 39.17%     1.58%    75
  nested_spheres_a0.0_b-0.5                                 39.64%     1.75%    75
  nested_spheres_a0.0_b0.0                                  39.92%     1.68%    75
  nested_spheres_a0.0_b0.5                                  39.38%     1.60%    75
  nested_spheres_a0.0_b1.0                                  39.54%     1.70%    75
  nested_spheres_a0.5_b-1.0                                 25.55%     1.76%    75
  nested_spheres_a0.5_b-0.5                                 25.56%     1.76%    75
  nested_spheres_a0.5_b0.0                                  25.26%     1.88%    75
  nested_spheres_a0.5_b0.5                                  25.56%     1.76%    75
  nested_spheres_a0.5_b1.0                                  25.57%     1.76%    75
  nested_spheres_a1.0_b-1.0                                 40.76%     2.02%    75
  nested_spheres_a1.0_b-0.5                                 41.38%     2.06%    75
  nested_spheres_a1.0_b0.0                                  40.01%     1.70%    75
  nested_spheres_a1.0_b0.5                                  40.88%     2.00%    75
  nested_spheres_a1.0_b1.0                                  41.06%     1.71%    75

  Framework Analysis (k=10):
    Part A (SGC+MLP - Restricted+Std): +14.000 pp
    Part B (RowNorm - Restricted+Std): +2.915 pp
    Remaining Gap:                     +11.085 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k10/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k10/diagnostics/fisher_diagnostic.json

================================================================================
K = 12
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1653, ortho_error=2.15e-10

  --- Split 2/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1653, ortho_error=2.15e-10

  --- Split 3/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1653, ortho_error=2.15e-10

  --- Split 4/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1653, ortho_error=2.15e-10

  --- Split 5/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1653, ortho_error=2.15e-10

  Aggregating results for k=12 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          73.91%     2.22%    75
  restricted_standard_mlp                                   60.74%     3.34%    75
  restricted_rownorm_mlp                                    63.49%     1.90%    75

  Framework Analysis (k=12):
    Part A (SGC+MLP - Restricted+Std): +13.170 pp
    Part B (RowNorm - Restricted+Std): +2.755 pp
    Remaining Gap:                     +10.415 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k12/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k12/diagnostics/fisher_diagnostic.json

================================================================================
K = 20
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1246, ortho_error=1.99e-10

  --- Split 2/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1246, ortho_error=1.99e-10

  --- Split 3/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1246, ortho_error=1.99e-10

  --- Split 4/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1246, ortho_error=1.99e-10

  --- Split 5/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=1246, ortho_error=1.99e-10

  Aggregating results for k=20 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          74.13%     2.10%    75
  restricted_standard_mlp                                   60.47%     2.57%    75
  restricted_rownorm_mlp                                    59.91%     1.39%    75

  Framework Analysis (k=20):
    Part A (SGC+MLP - Restricted+Std): +13.651 pp
    Part B (RowNorm - Restricted+Std): -0.563 pp
    Remaining Gap:                     +14.214 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k20/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k20/diagnostics/fisher_diagnostic.json

================================================================================
K = 30
================================================================================
  X_diffused shape: (2120, 3703)

  --- Split 1/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=900, ortho_error=1.83e-10

  --- Split 2/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=900, ortho_error=1.83e-10

  --- Split 3/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=900, ortho_error=1.83e-10

  --- Split 4/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=900, ortho_error=1.83e-10

  --- Split 5/5 (train=1272, val=424, test=424) ---
  Computing restricted eigenvectors...
  d_effective=900, ortho_error=1.83e-10

  Aggregating results for k=30 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          73.76%     2.10%    75
  restricted_standard_mlp                                   60.91%     1.34%    75
  restricted_rownorm_mlp                                    60.63%     2.32%    75

  Framework Analysis (k=30):
    Part A (SGC+MLP - Restricted+Std): +12.852 pp
    Part B (RowNorm - Restricted+Std): -0.280 pp
    Remaining Gap:                     +13.132 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k30/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/k30/diagnostics/fisher_diagnostic.json

================================================================================
MASTER TRAINING EXPERIMENT COMPLETE
================================================================================
Results saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc
[2/2] Analytics: citeseer random
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER ANALYTICS (Exp 2 + Exp 8)
================================================================================
Dataset:       citeseer
Split type:    random
Component:     lcc
k values:      [1, 2, 4, 6, 8, 10, 12, 20, 30]
Results dir:   /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc
================================================================================

[Step 1] Loading dataset and graph...
Nodes: 3,327, Features: 3703, Classes: 6

[Step 2] Extracting LCC...
After LCC: nodes=2,120, classes=6

================================================================================
EXP 2: SPECTRAL ANALYSIS (all k values)
================================================================================

  k=1:
    WARNING: no cached matrices found, recomputing...
    d_effective=2035, ortho_error=2.2393320531222116e-10
    Condition U=12.7305  Condition X=inf  Separability=0.0756  SpanErr=3.31e-15
    Var ratio U=107.59  Var ratio X=126821322551.69  Reduction=1178782363.98x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/analytics/exp2_spectral_analysis_k1.json

  k=2:
    WARNING: no cached matrices found, recomputing...
    d_effective=2035, ortho_error=2.2392232512657984e-10
    Condition U=25.8729  Condition X=inf  Separability=0.0757  SpanErr=3.27e-15
    Var ratio U=170.39  Var ratio X=116723562485.87  Reduction=685053336.01x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/analytics/exp2_spectral_analysis_k2.json

  k=4:
    WARNING: no cached matrices found, recomputing...
    d_effective=2033, ortho_error=2.2394430754246741e-10
    Condition U=12.7915  Condition X=inf  Separability=0.0756  SpanErr=3.36e-15
    Var ratio U=433705.20  Var ratio X=106697610247.36  Reduction=246014.14x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/analytics/exp2_spectral_analysis_k4.json

  k=6:
    WARNING: no cached matrices found, recomputing...
    d_effective=1989, ortho_error=2.2338697558410558e-10
    Condition U=450.4038  Condition X=inf  Separability=0.0759  SpanErr=4.22e-15
    Var ratio U=47779.56  Var ratio X=101019740864.96  Reduction=2114287.99x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/analytics/exp2_spectral_analysis_k6.json

  k=8:
    WARNING: no cached matrices found, recomputing...
    d_effective=1897, ortho_error=2.2129897914169305e-10
    Condition U=42.1432  Condition X=inf  Separability=0.0765  SpanErr=4.12e-15
    Var ratio U=47.84  Var ratio X=96830507187.50  Reduction=2024172879.40x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/analytics/exp2_spectral_analysis_k8.json

  k=10:
    WARNING: no cached matrices found, recomputing...
    d_effective=1782, ortho_error=2.182025671260135e-10
    Condition U=55.3179  Condition X=inf  Separability=0.0775  SpanErr=2.57e-03
    Var ratio U=120.49  Var ratio X=93419054126.09  Reduction=775341686.47x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/analytics/exp2_spectral_analysis_k10.json

  k=12:
    WARNING: no cached matrices found, recomputing...
    d_effective=1653, ortho_error=2.149936895179394e-10
    Condition U=100.6437  Condition X=inf  Separability=0.0784  SpanErr=5.07e-15
    Var ratio U=16.75  Var ratio X=90492034080.27  Reduction=5404004947.51x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/analytics/exp2_spectral_analysis_k12.json

  k=20:
    WARNING: no cached matrices found, recomputing...
    d_effective=1246, ortho_error=1.9887091973203042e-10
    Condition U=29317458653.8113  Condition X=inf  Separability=0.0826  SpanErr=1.56e-02
    Var ratio U=20.93  Var ratio X=81403449317.81  Reduction=3889838788.55x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/analytics/exp2_spectral_analysis_k20.json

  k=30:
    WARNING: no cached matrices found, recomputing...
    d_effective=900, ortho_error=1.8277324098647796e-10
    Condition U=615066103.5926  Condition X=inf  Separability=0.0903  SpanErr=1.08e-01
    Var ratio U=10.84  Var ratio X=73026060490.36  Reduction=6734826351.17x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/analytics/exp2_spectral_analysis_k30.json

================================================================================
EXP 8: k-SENSITIVITY ANALYSIS
================================================================================

     k    SGC+MLP      R+Std       R+RN     Part A     Part B    Rem.Gap     Fisher   n_runs
  -----------------------------------------------------------------------------------------------
     1     73.56%     63.20%     65.83%    +10.362     +2.632     +7.730    0.02447       75
     2     73.90%     61.16%     66.02%    +12.745     +4.862     +7.884    0.02406       75
     4     73.94%     61.44%     66.02%    +12.494     +4.572     +7.921    0.02497       75
     6     74.54%     60.53%     65.29%    +14.009     +4.755     +9.255    0.02441       75
     8     74.44%     61.20%     63.00%    +13.236     +1.799    +11.437    0.02617       75
    10     74.04%     60.04%     62.96%    +14.000     +2.915    +11.085    0.02663       75
    12     73.91%     60.74%     63.49%    +13.170     +2.755    +10.415    0.02493       75
    20     74.13%     60.47%     59.91%    +13.651     -0.563    +14.214    0.02612       75
    30     73.76%     60.91%     60.63%    +12.852     -0.280    +13.132    0.02698       75

  Saved JSON: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/analytics/exp8_k_sensitivity.json
  Saved CSV:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/analytics/exp8_k_sensitivity.csv

================================================================================
MASTER ANALYTICS COMPLETE
================================================================================
Analytics saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/citeseer_random_lcc/analytics
   citeseer complete  |  Sun Feb 22 09:59:29 PM EST 2026

--------------------------------------------------------
 DATASET: amazon-photo  |  Sun Feb 22 09:59:29 PM EST 2026
--------------------------------------------------------
[1/2] Training: amazon-photo fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER TRAINING EXPERIMENT
================================================================================
Dataset:      amazon-photo
k values:     [1, 2, 4, 6, 8, 10, 12, 20, 30]
Split type:   fixed  (1 split(s) x 15 seeds)
Component:    lcc
Device:       cuda
Output base:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc
================================================================================

[Step 1] Loading dataset...
Creating 60/20/20 split for amazon-photo...
Nodes: 7,650, Features: 745, Classes: 8

[Step 2] Building graph matrices...

[Step 3] Extracting largest connected component...
Rebuilding graph matrices for LCC...
After step 3: nodes=7,487, classes=8, disconnected_components_to_skip=0

[Step 4] Preparing splits...
Fixed split: Train=4487, Val=1504, Test=1496

[Step 5] Computing SGC normalized adjacency...
A_sgc = D^{-1/2}(A+I)D^{-1/2}

================================================================================
K = 1
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/1 (train=4487, val=1504, test=1496) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=2.21e-10

  Aggregating results for k=1 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          94.60%     0.21%    15
  restricted_standard_mlp                                   89.95%     0.35%    15
  restricted_rownorm_mlp                                    90.57%     0.41%    15

  Framework Analysis (k=1):
    Part A (SGC+MLP - Restricted+Std): +4.652 pp
    Part B (RowNorm - Restricted+Std): +0.628 pp
    Remaining Gap:                     +4.024 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k1/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k1/diagnostics/fisher_diagnostic.json

================================================================================
K = 2
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/1 (train=4487, val=1504, test=1496) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=5.02e-10

  Aggregating results for k=2 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          94.55%     0.23%    15
  restricted_standard_mlp                                   90.60%     0.35%    15
  restricted_rownorm_mlp                                    91.88%     0.40%    15

  Framework Analysis (k=2):
    Part A (SGC+MLP - Restricted+Std): +3.953 pp
    Part B (RowNorm - Restricted+Std): +1.275 pp
    Remaining Gap:                     +2.678 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k2/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k2/diagnostics/fisher_diagnostic.json

================================================================================
K = 4
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/1 (train=4487, val=1504, test=1496) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.58e-10

  Aggregating results for k=4 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          93.48%     0.28%    15
  restricted_standard_mlp                                   90.41%     0.31%    15
  restricted_rownorm_mlp                                    91.65%     0.32%    15

  Framework Analysis (k=4):
    Part A (SGC+MLP - Restricted+Std): +3.070 pp
    Part B (RowNorm - Restricted+Std): +1.243 pp
    Remaining Gap:                     +1.827 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k4/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k4/diagnostics/fisher_diagnostic.json

================================================================================
K = 6
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/1 (train=4487, val=1504, test=1496) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.72e-10

  Aggregating results for k=6 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          92.44%     0.38%    15
  restricted_standard_mlp                                   91.19%     0.39%    15
  restricted_rownorm_mlp                                    91.89%     0.31%    15

  Framework Analysis (k=6):
    Part A (SGC+MLP - Restricted+Std): +1.248 pp
    Part B (RowNorm - Restricted+Std): +0.695 pp
    Remaining Gap:                     +0.553 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k6/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k6/diagnostics/fisher_diagnostic.json

================================================================================
K = 8
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/1 (train=4487, val=1504, test=1496) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.91e-10

  Aggregating results for k=8 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          91.49%     0.27%    15
  restricted_standard_mlp                                   91.43%     0.28%    15
  restricted_rownorm_mlp                                    91.74%     0.40%    15

  Framework Analysis (k=8):
    Part A (SGC+MLP - Restricted+Std): +0.062 pp
    Part B (RowNorm - Restricted+Std): +0.316 pp
    Remaining Gap:                     -0.254 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k8/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k8/diagnostics/fisher_diagnostic.json

================================================================================
K = 10
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/1 (train=4487, val=1504, test=1496) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=7.67e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k10/training_curves/split0_dynamics.json

  Aggregating results for k=10 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          90.68%     0.40%    15
  restricted_standard_mlp                                   91.31%     0.32%    15
  restricted_rownorm_mlp                                    91.62%     0.48%    15
  log_magnitude                                             92.21%     0.26%    15
  dual_stream                                               92.05%     0.30%    15
  spectral_rownorm_alpha-1.0                                92.65%     0.17%    15
  spectral_rownorm_alpha-0.5                                92.21%     0.29%    15
  spectral_rownorm_alpha0.0                                 91.96%     0.23%    15
  spectral_rownorm_alpha0.5                                 92.00%     0.43%    15
  spectral_rownorm_alpha1.0                                 91.78%     0.30%    15
  nested_spheres_a-1.0_b-1.0                                92.38%     0.21%    15
  nested_spheres_a-1.0_b-0.5                                92.67%     0.26%    15
  nested_spheres_a-1.0_b0.0                                 92.72%     0.21%    15
  nested_spheres_a-1.0_b0.5                                 92.61%     0.28%    15
  nested_spheres_a-1.0_b1.0                                 92.52%     0.20%    15
  nested_spheres_a-0.5_b-1.0                                92.16%     0.23%    15
  nested_spheres_a-0.5_b-0.5                                92.25%     0.23%    15
  nested_spheres_a-0.5_b0.0                                 92.10%     0.21%    15
  nested_spheres_a-0.5_b0.5                                 92.21%     0.32%    15
  nested_spheres_a-0.5_b1.0                                 92.21%     0.23%    15
  nested_spheres_a0.0_b-1.0                                 92.22%     0.24%    15
  nested_spheres_a0.0_b-0.5                                 92.22%     0.39%    15
  nested_spheres_a0.0_b0.0                                  92.00%     0.20%    15
  nested_spheres_a0.0_b0.5                                  92.25%     0.20%    15
  nested_spheres_a0.0_b1.0                                  92.21%     0.26%    15
  nested_spheres_a0.5_b-1.0                                 91.96%     0.39%    15
  nested_spheres_a0.5_b-0.5                                 91.94%     0.29%    15
  nested_spheres_a0.5_b0.0                                  92.19%     0.30%    15
  nested_spheres_a0.5_b0.5                                  92.10%     0.32%    15
  nested_spheres_a0.5_b1.0                                  92.10%     0.23%    15
  nested_spheres_a1.0_b-1.0                                 91.66%     0.29%    15
  nested_spheres_a1.0_b-0.5                                 91.75%     0.28%    15
  nested_spheres_a1.0_b0.0                                  91.70%     0.35%    15
  nested_spheres_a1.0_b0.5                                  91.76%     0.23%    15
  nested_spheres_a1.0_b1.0                                  91.68%     0.31%    15

  Framework Analysis (k=10):
    Part A (SGC+MLP - Restricted+Std): -0.624 pp
    Part B (RowNorm - Restricted+Std): +0.316 pp
    Remaining Gap:                     -0.940 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k10/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k10/diagnostics/fisher_diagnostic.json

================================================================================
K = 12
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/1 (train=4487, val=1504, test=1496) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=8.03e-10

  Aggregating results for k=12 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          90.24%     0.53%    15
  restricted_standard_mlp                                   91.11%     0.43%    15
  restricted_rownorm_mlp                                    91.74%     0.36%    15

  Framework Analysis (k=12):
    Part A (SGC+MLP - Restricted+Std): -0.873 pp
    Part B (RowNorm - Restricted+Std): +0.633 pp
    Remaining Gap:                     -1.506 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k12/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k12/diagnostics/fisher_diagnostic.json

================================================================================
K = 20
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/1 (train=4487, val=1504, test=1496) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=8.03e-10

  Aggregating results for k=20 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          86.45%     0.96%    15
  restricted_standard_mlp                                   91.35%     0.39%    15
  restricted_rownorm_mlp                                    91.53%     0.38%    15

  Framework Analysis (k=20):
    Part A (SGC+MLP - Restricted+Std): -4.906 pp
    Part B (RowNorm - Restricted+Std): +0.178 pp
    Remaining Gap:                     -5.085 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k20/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k20/diagnostics/fisher_diagnostic.json

================================================================================
K = 30
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/1 (train=4487, val=1504, test=1496) ---
  Computing restricted eigenvectors...
  d_effective=480, ortho_error=7.39e-10

  Aggregating results for k=30 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          81.76%     1.09%    15
  restricted_standard_mlp                                   91.21%     0.37%    15
  restricted_rownorm_mlp                                    92.12%     0.34%    15

  Framework Analysis (k=30):
    Part A (SGC+MLP - Restricted+Std): -9.447 pp
    Part B (RowNorm - Restricted+Std): +0.905 pp
    Remaining Gap:                     -10.352 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k30/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/k30/diagnostics/fisher_diagnostic.json

================================================================================
MASTER TRAINING EXPERIMENT COMPLETE
================================================================================
Results saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc
[2/2] Analytics: amazon-photo fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER ANALYTICS (Exp 2 + Exp 8)
================================================================================
Dataset:       amazon-photo
Split type:    fixed
Component:     lcc
k values:      [1, 2, 4, 6, 8, 10, 12, 20, 30]
Results dir:   /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc
================================================================================

[Step 1] Loading dataset and graph...
Creating 60/20/20 split for amazon-photo...
Nodes: 7,650, Features: 745, Classes: 8

[Step 2] Extracting LCC...
After LCC: nodes=7,487, classes=8

================================================================================
EXP 2: SPECTRAL ANALYSIS (all k values)
================================================================================

  k=1:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=2.2065083093991689e-10
    Condition U=10.4392  Condition X=386.9904  Separability=0.1041  SpanErr=4.64e-01
    Var ratio U=6.08  Var ratio X=6.69  Reduction=1.10x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/analytics/exp2_spectral_analysis_k1.json

  k=2:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=5.016849158323566e-10
    Condition U=14.7639  Condition X=1764.6703  Separability=0.1210  SpanErr=4.24e-01
    Var ratio U=40.16  Var ratio X=7.66  Reduction=0.19x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/analytics/exp2_spectral_analysis_k2.json

  k=4:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=6.584427447720032e-10
    Condition U=17.5199  Condition X=23355.7324  Separability=0.1404  SpanErr=4.63e-01
    Var ratio U=58.39  Var ratio X=9.55  Reduction=0.16x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/analytics/exp2_spectral_analysis_k4.json

  k=6:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=6.721849743485109e-10
    Condition U=39.7064  Condition X=261068.1224  Separability=0.1500  SpanErr=4.79e-01
    Var ratio U=44.94  Var ratio X=10.41  Reduction=0.23x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/analytics/exp2_spectral_analysis_k6.json

  k=8:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=6.908064120736412e-10
    Condition U=53.7810  Condition X=2624942.5206  Separability=0.1547  SpanErr=4.87e-01
    Var ratio U=35.73  Var ratio X=10.83  Reduction=0.30x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/analytics/exp2_spectral_analysis_k8.json

  k=10:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=7.671042689949559e-10
    Condition U=63.8524  Condition X=24644500.9451  Separability=0.1574  SpanErr=4.92e-01
    Var ratio U=42.32  Var ratio X=11.04  Reduction=0.26x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/analytics/exp2_spectral_analysis_k10.json

  k=12:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=8.033332887791289e-10
    Condition U=90.4816  Condition X=224946578.3769  Separability=0.1591  SpanErr=4.96e-01
    Var ratio U=46.79  Var ratio X=11.15  Reduction=0.24x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/analytics/exp2_spectral_analysis_k12.json

  k=20:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=8.032524645429362e-10
    Condition U=107.0771  Condition X=1330244763630.9226  Separability=0.1616  SpanErr=5.05e-01
    Var ratio U=54.32  Var ratio X=11.19  Reduction=0.21x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/analytics/exp2_spectral_analysis_k20.json

  k=30:
    WARNING: no cached matrices found, recomputing...
    d_effective=480, ortho_error=7.385454470210107e-10
    Condition U=57.0470  Condition X=inf  Separability=0.2218  SpanErr=5.72e-01
    Var ratio U=42.86  Var ratio X=11.11  Reduction=0.26x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/analytics/exp2_spectral_analysis_k30.json

================================================================================
EXP 8: k-SENSITIVITY ANALYSIS
================================================================================

     k    SGC+MLP      R+Std       R+RN     Part A     Part B    Rem.Gap     Fisher   n_runs
  -----------------------------------------------------------------------------------------------
     1     94.60%     89.95%     90.57%     +4.652     +0.628     +4.024    0.14519       15
     2     94.55%     90.60%     91.88%     +3.953     +1.274     +2.678    0.11107       15
     4     93.48%     90.41%     91.65%     +3.070     +1.243     +1.827    0.09288       15
     6     92.44%     91.19%     91.89%     +1.248     +0.695     +0.553    0.08749       15
     8     91.49%     91.43%     91.74%     +0.062     +0.316     -0.254    0.08594       15
    10     90.68%     91.31%     91.62%     -0.624     +0.316     -0.940    0.08540       15
    12     90.24%     91.11%     91.74%     -0.873     +0.633     -1.506    0.08512       15
    20     86.45%     91.35%     91.53%     -4.906     +0.178     -5.085    0.08463       15
    30     81.76%     91.21%     92.12%     -9.447     +0.905    -10.352    0.06557       15

  Saved JSON: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/analytics/exp8_k_sensitivity.json
  Saved CSV:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/analytics/exp8_k_sensitivity.csv

================================================================================
MASTER ANALYTICS COMPLETE
================================================================================
Analytics saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_fixed_lcc/analytics
[1/2] Training: amazon-photo random
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER TRAINING EXPERIMENT
================================================================================
Dataset:      amazon-photo
k values:     [1, 2, 4, 6, 8, 10, 12, 20, 30]
Split type:   random  (5 split(s) x 15 seeds)
Component:    lcc
Device:       cuda
Output base:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc
================================================================================

[Step 1] Loading dataset...
Creating 60/20/20 split for amazon-photo...
Nodes: 7,650, Features: 745, Classes: 8

[Step 2] Building graph matrices...

[Step 3] Extracting largest connected component...
Rebuilding graph matrices for LCC...
After step 3: nodes=7,487, classes=8, disconnected_components_to_skip=0

[Step 4] Preparing splits...
Random split 0: Train=4492, Val=1497, Test=1498
Random split 1: Train=4492, Val=1497, Test=1498
Random split 2: Train=4492, Val=1497, Test=1498
Random split 3: Train=4492, Val=1497, Test=1498
Random split 4: Train=4492, Val=1497, Test=1498

[Step 5] Computing SGC normalized adjacency...
A_sgc = D^{-1/2}(A+I)D^{-1/2}

================================================================================
K = 1
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=2.21e-10

  --- Split 2/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=2.21e-10

  --- Split 3/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=2.21e-10

  --- Split 4/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=2.21e-10

  --- Split 5/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=2.21e-10

  Aggregating results for k=1 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          94.57%     0.59%    75
  restricted_standard_mlp                                   90.54%     0.90%    75
  restricted_rownorm_mlp                                    91.02%     0.61%    75

  Framework Analysis (k=1):
    Part A (SGC+MLP - Restricted+Std): +4.026 pp
    Part B (RowNorm - Restricted+Std): +0.476 pp
    Remaining Gap:                     +3.550 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k1/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k1/diagnostics/fisher_diagnostic.json

================================================================================
K = 2
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=5.02e-10

  --- Split 2/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=5.02e-10

  --- Split 3/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=5.02e-10

  --- Split 4/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=5.02e-10

  --- Split 5/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=5.02e-10

  Aggregating results for k=2 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          94.65%     0.63%    75
  restricted_standard_mlp                                   90.76%     0.67%    75
  restricted_rownorm_mlp                                    91.90%     0.74%    75

  Framework Analysis (k=2):
    Part A (SGC+MLP - Restricted+Std): +3.899 pp
    Part B (RowNorm - Restricted+Std): +1.148 pp
    Remaining Gap:                     +2.750 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k2/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k2/diagnostics/fisher_diagnostic.json

================================================================================
K = 4
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.58e-10

  --- Split 2/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.58e-10

  --- Split 3/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.58e-10

  --- Split 4/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.58e-10

  --- Split 5/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.58e-10

  Aggregating results for k=4 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          93.33%     0.80%    75
  restricted_standard_mlp                                   90.08%     0.59%    75
  restricted_rownorm_mlp                                    91.36%     0.61%    75

  Framework Analysis (k=4):
    Part A (SGC+MLP - Restricted+Std): +3.251 pp
    Part B (RowNorm - Restricted+Std): +1.275 pp
    Remaining Gap:                     +1.976 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k4/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k4/diagnostics/fisher_diagnostic.json

================================================================================
K = 6
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.72e-10

  --- Split 2/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.72e-10

  --- Split 3/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.72e-10

  --- Split 4/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.72e-10

  --- Split 5/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.72e-10

  Aggregating results for k=6 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          92.37%     0.75%    75
  restricted_standard_mlp                                   90.54%     0.52%    75
  restricted_rownorm_mlp                                    91.35%     0.54%    75

  Framework Analysis (k=6):
    Part A (SGC+MLP - Restricted+Std): +1.832 pp
    Part B (RowNorm - Restricted+Std): +0.810 pp
    Remaining Gap:                     +1.022 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k6/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k6/diagnostics/fisher_diagnostic.json

================================================================================
K = 8
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.91e-10

  --- Split 2/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.91e-10

  --- Split 3/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.91e-10

  --- Split 4/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.91e-10

  --- Split 5/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=6.91e-10

  Aggregating results for k=8 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          91.26%     0.85%    75
  restricted_standard_mlp                                   90.65%     0.42%    75
  restricted_rownorm_mlp                                    91.40%     0.48%    75

  Framework Analysis (k=8):
    Part A (SGC+MLP - Restricted+Std): +0.618 pp
    Part B (RowNorm - Restricted+Std): +0.757 pp
    Remaining Gap:                     -0.139 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k8/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k8/diagnostics/fisher_diagnostic.json

================================================================================
K = 10
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=7.67e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k10/training_curves/split0_dynamics.json

  --- Split 2/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=7.67e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k10/training_curves/split1_dynamics.json

  --- Split 3/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=7.67e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k10/training_curves/split2_dynamics.json

  --- Split 4/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=7.67e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k10/training_curves/split3_dynamics.json

  --- Split 5/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=7.67e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k10/training_curves/split4_dynamics.json

  Aggregating results for k=10 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          90.44%     0.91%    75
  restricted_standard_mlp                                   90.57%     0.53%    75
  restricted_rownorm_mlp                                    91.40%     0.51%    75
  log_magnitude                                             91.48%     0.50%    75
  dual_stream                                               91.42%     0.48%    75
  spectral_rownorm_alpha-1.0                                92.19%     0.34%    75
  spectral_rownorm_alpha-0.5                                91.78%     0.36%    75
  spectral_rownorm_alpha0.0                                 91.44%     0.43%    75
  spectral_rownorm_alpha0.5                                 91.23%     0.41%    75
  spectral_rownorm_alpha1.0                                 91.30%     0.43%    75
  nested_spheres_a-1.0_b-1.0                                92.15%     0.29%    75
  nested_spheres_a-1.0_b-0.5                                92.20%     0.30%    75
  nested_spheres_a-1.0_b0.0                                 92.18%     0.35%    75
  nested_spheres_a-1.0_b0.5                                 92.21%     0.32%    75
  nested_spheres_a-1.0_b1.0                                 92.12%     0.34%    75
  nested_spheres_a-0.5_b-1.0                                91.85%     0.38%    75
  nested_spheres_a-0.5_b-0.5                                91.83%     0.37%    75
  nested_spheres_a-0.5_b0.0                                 91.78%     0.41%    75
  nested_spheres_a-0.5_b0.5                                 91.84%     0.40%    75
  nested_spheres_a-0.5_b1.0                                 91.91%     0.39%    75
  nested_spheres_a0.0_b-1.0                                 91.48%     0.49%    75
  nested_spheres_a0.0_b-0.5                                 91.56%     0.55%    75
  nested_spheres_a0.0_b0.0                                  91.43%     0.45%    75
  nested_spheres_a0.0_b0.5                                  91.55%     0.48%    75
  nested_spheres_a0.0_b1.0                                  91.48%     0.50%    75
  nested_spheres_a0.5_b-1.0                                 91.22%     0.58%    75
  nested_spheres_a0.5_b-0.5                                 91.23%     0.55%    75
  nested_spheres_a0.5_b0.0                                  91.29%     0.39%    75
  nested_spheres_a0.5_b0.5                                  91.26%     0.53%    75
  nested_spheres_a0.5_b1.0                                  91.18%     0.53%    75
  nested_spheres_a1.0_b-1.0                                 91.12%     0.45%    75
  nested_spheres_a1.0_b-0.5                                 91.20%     0.48%    75
  nested_spheres_a1.0_b0.0                                  91.31%     0.42%    75
  nested_spheres_a1.0_b0.5                                  91.13%     0.49%    75
  nested_spheres_a1.0_b1.0                                  91.21%     0.49%    75

  Framework Analysis (k=10):
    Part A (SGC+MLP - Restricted+Std): -0.129 pp
    Part B (RowNorm - Restricted+Std): +0.832 pp
    Remaining Gap:                     -0.961 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k10/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k10/diagnostics/fisher_diagnostic.json

================================================================================
K = 12
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=8.03e-10

  --- Split 2/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=8.03e-10

  --- Split 3/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=8.03e-10

  --- Split 4/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=8.03e-10

  --- Split 5/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=8.03e-10

  Aggregating results for k=12 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          89.74%     0.92%    75
  restricted_standard_mlp                                   90.56%     0.54%    75
  restricted_rownorm_mlp                                    91.55%     0.45%    75

  Framework Analysis (k=12):
    Part A (SGC+MLP - Restricted+Std): -0.814 pp
    Part B (RowNorm - Restricted+Std): +0.997 pp
    Remaining Gap:                     -1.810 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k12/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k12/diagnostics/fisher_diagnostic.json

================================================================================
K = 20
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=8.03e-10

  --- Split 2/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=8.03e-10

  --- Split 3/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=8.03e-10

  --- Split 4/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=8.03e-10

  --- Split 5/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=745, ortho_error=8.03e-10

  Aggregating results for k=20 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          85.73%     0.93%    75
  restricted_standard_mlp                                   90.81%     0.47%    75
  restricted_rownorm_mlp                                    91.65%     0.42%    75

  Framework Analysis (k=20):
    Part A (SGC+MLP - Restricted+Std): -5.083 pp
    Part B (RowNorm - Restricted+Std): +0.831 pp
    Remaining Gap:                     -5.915 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k20/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k20/diagnostics/fisher_diagnostic.json

================================================================================
K = 30
================================================================================
  X_diffused shape: (7487, 745)

  --- Split 1/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=480, ortho_error=7.39e-10

  --- Split 2/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=480, ortho_error=7.39e-10

  --- Split 3/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=480, ortho_error=7.39e-10

  --- Split 4/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=480, ortho_error=7.39e-10

  --- Split 5/5 (train=4492, val=1497, test=1498) ---
  Computing restricted eigenvectors...
  d_effective=480, ortho_error=7.39e-10

  Aggregating results for k=30 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          81.08%     1.21%    75
  restricted_standard_mlp                                   92.00%     0.33%    75
  restricted_rownorm_mlp                                    92.38%     0.48%    75

  Framework Analysis (k=30):
    Part A (SGC+MLP - Restricted+Std): -10.912 pp
    Part B (RowNorm - Restricted+Std): +0.386 pp
    Remaining Gap:                     -11.299 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k30/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/k30/diagnostics/fisher_diagnostic.json

================================================================================
MASTER TRAINING EXPERIMENT COMPLETE
================================================================================
Results saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc
[2/2] Analytics: amazon-photo random
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER ANALYTICS (Exp 2 + Exp 8)
================================================================================
Dataset:       amazon-photo
Split type:    random
Component:     lcc
k values:      [1, 2, 4, 6, 8, 10, 12, 20, 30]
Results dir:   /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc
================================================================================

[Step 1] Loading dataset and graph...
Creating 60/20/20 split for amazon-photo...
Nodes: 7,650, Features: 745, Classes: 8

[Step 2] Extracting LCC...
After LCC: nodes=7,487, classes=8

================================================================================
EXP 2: SPECTRAL ANALYSIS (all k values)
================================================================================

  k=1:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=2.2065083093991689e-10
    Condition U=10.5981  Condition X=386.7014  Separability=0.1035  SpanErr=4.58e-01
    Var ratio U=5.60  Var ratio X=6.67  Reduction=1.19x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/analytics/exp2_spectral_analysis_k1.json

  k=2:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=5.016849158323566e-10
    Condition U=15.5271  Condition X=1746.2980  Separability=0.1198  SpanErr=4.16e-01
    Var ratio U=25.16  Var ratio X=7.90  Reduction=0.31x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/analytics/exp2_spectral_analysis_k2.json

  k=4:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=6.584427447720032e-10
    Condition U=26.4192  Condition X=23825.0267  Separability=0.1380  SpanErr=4.53e-01
    Var ratio U=58.21  Var ratio X=9.66  Reduction=0.17x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/analytics/exp2_spectral_analysis_k4.json

  k=6:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=6.721849743485109e-10
    Condition U=36.7454  Condition X=256581.7566  Separability=0.1470  SpanErr=4.69e-01
    Var ratio U=53.67  Var ratio X=10.31  Reduction=0.19x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/analytics/exp2_spectral_analysis_k6.json

  k=8:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=6.908064120736412e-10
    Condition U=42.6977  Condition X=2503376.6167  Separability=0.1514  SpanErr=4.79e-01
    Var ratio U=57.70  Var ratio X=10.74  Reduction=0.19x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/analytics/exp2_spectral_analysis_k8.json

  k=10:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=7.671042689949559e-10
    Condition U=55.2580  Condition X=23073296.9887  Separability=0.1538  SpanErr=4.85e-01
    Var ratio U=58.90  Var ratio X=10.96  Reduction=0.19x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/analytics/exp2_spectral_analysis_k10.json

  k=12:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=8.033332887791289e-10
    Condition U=116.3964  Condition X=210454038.4703  Separability=0.1555  SpanErr=4.89e-01
    Var ratio U=67.60  Var ratio X=11.06  Reduction=0.16x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/analytics/exp2_spectral_analysis_k12.json

  k=20:
    WARNING: no cached matrices found, recomputing...
    d_effective=745, ortho_error=8.032524645429362e-10
    Condition U=2260.0534  Condition X=1333780630208.6802  Separability=0.1585  SpanErr=5.02e-01
    Var ratio U=59.92  Var ratio X=11.06  Reduction=0.18x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/analytics/exp2_spectral_analysis_k20.json

  k=30:
    WARNING: no cached matrices found, recomputing...
    d_effective=480, ortho_error=7.385454470210107e-10
    Condition U=66.4903  Condition X=inf  Separability=0.2210  SpanErr=5.80e-01
    Var ratio U=46.67  Var ratio X=10.93  Reduction=0.23x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/analytics/exp2_spectral_analysis_k30.json

================================================================================
EXP 8: k-SENSITIVITY ANALYSIS
================================================================================

     k    SGC+MLP      R+Std       R+RN     Part A     Part B    Rem.Gap     Fisher   n_runs
  -----------------------------------------------------------------------------------------------
     1     94.57%     90.54%     91.02%     +4.026     +0.476     +3.550    0.13679       75
     2     94.65%     90.76%     91.90%     +3.898     +1.148     +2.750    0.10323       75
     4     93.33%     90.08%     91.36%     +3.251     +1.276     +1.976    0.08498       75
     6     92.37%     90.54%     91.35%     +1.832     +0.810     +1.022    0.08014       75
     8     91.26%     90.65%     91.40%     +0.618     +0.757     -0.139    0.07895       75
    10     90.44%     90.57%     91.40%     -0.129     +0.832     -0.961    0.07862       75
    12     89.74%     90.56%     91.55%     -0.814     +0.997     -1.810    0.07849       75
    20     85.73%     90.81%     91.65%     -5.083     +0.831     -5.915    0.07827       75
    30     81.08%     92.00%     92.38%    -10.912     +0.386    -11.299    0.05828       75

  Saved JSON: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/analytics/exp8_k_sensitivity.json
  Saved CSV:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/analytics/exp8_k_sensitivity.csv

================================================================================
MASTER ANALYTICS COMPLETE
================================================================================
Analytics saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-photo_random_lcc/analytics
   amazon-photo complete  |  Sun Feb 22 10:24:48 PM EST 2026

--------------------------------------------------------
 DATASET: wikics  |  Sun Feb 22 10:24:48 PM EST 2026
--------------------------------------------------------
[1/2] Training: wikics fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/torch_geometric/datasets/wikics.py:45: UserWarning: The WikiCS dataset now returns an undirected graph by default. Please explicitly specify 'is_undirected=False' to restore the old behavior.
  warnings.warn(
================================================================================
MASTER TRAINING EXPERIMENT
================================================================================
Dataset:      wikics
k values:     [1, 2, 4, 6, 8, 10, 12, 20, 30]
Split type:   fixed  (1 split(s) x 15 seeds)
Component:    lcc
Device:       cuda
Output base:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc
================================================================================

[Step 1] Loading dataset...
WikiCS using split 0: Train=580, Val=1769, Test=5847
Nodes: 11,701, Features: 300, Classes: 10

[Step 2] Building graph matrices...

[Step 3] Extracting largest connected component...
Rebuilding graph matrices for LCC...
After step 3: nodes=11,311, classes=10, disconnected_components_to_skip=0

[Step 4] Preparing splits...
Fixed split: Train=561, Val=1709, Test=5647

[Step 5] Computing SGC normalized adjacency...
A_sgc = D^{-1/2}(A+I)D^{-1/2}

================================================================================
K = 1
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/1 (train=561, val=1709, test=5647) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=2.91e-10

  Aggregating results for k=1 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          78.08%     0.26%    15
  restricted_standard_mlp                                   52.74%     0.39%    15
  restricted_rownorm_mlp                                    51.18%     0.39%    15

  Framework Analysis (k=1):
    Part A (SGC+MLP - Restricted+Std): +25.339 pp
    Part B (RowNorm - Restricted+Std): -1.564 pp
    Remaining Gap:                     +26.903 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k1/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k1/diagnostics/fisher_diagnostic.json

================================================================================
K = 2
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/1 (train=561, val=1709, test=5647) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=3.45e-10

  Aggregating results for k=2 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          78.91%     0.26%    15
  restricted_standard_mlp                                   58.22%     1.13%    15
  restricted_rownorm_mlp                                    56.53%     0.46%    15

  Framework Analysis (k=2):
    Part A (SGC+MLP - Restricted+Std): +20.692 pp
    Part B (RowNorm - Restricted+Std): -1.691 pp
    Remaining Gap:                     +22.382 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k2/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k2/diagnostics/fisher_diagnostic.json

================================================================================
K = 4
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/1 (train=561, val=1709, test=5647) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=6.96e-10

  Aggregating results for k=4 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          78.12%     0.42%    15
  restricted_standard_mlp                                   60.32%     0.34%    15
  restricted_rownorm_mlp                                    58.95%     0.39%    15

  Framework Analysis (k=4):
    Part A (SGC+MLP - Restricted+Std): +17.801 pp
    Part B (RowNorm - Restricted+Std): -1.361 pp
    Remaining Gap:                     +19.162 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k4/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k4/diagnostics/fisher_diagnostic.json

================================================================================
K = 6
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/1 (train=561, val=1709, test=5647) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=8.59e-10

  Aggregating results for k=6 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          77.50%     0.32%    15
  restricted_standard_mlp                                   62.99%     0.49%    15
  restricted_rownorm_mlp                                    60.80%     0.46%    15

  Framework Analysis (k=6):
    Part A (SGC+MLP - Restricted+Std): +14.509 pp
    Part B (RowNorm - Restricted+Std): -2.188 pp
    Remaining Gap:                     +16.697 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k6/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k6/diagnostics/fisher_diagnostic.json

================================================================================
K = 8
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/1 (train=561, val=1709, test=5647) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.24e-10

  Aggregating results for k=8 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          76.30%     0.32%    15
  restricted_standard_mlp                                   64.94%     0.48%    15
  restricted_rownorm_mlp                                    62.34%     0.50%    15

  Framework Analysis (k=8):
    Part A (SGC+MLP - Restricted+Std): +11.365 pp
    Part B (RowNorm - Restricted+Std): -2.591 pp
    Remaining Gap:                     +13.957 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k8/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k8/diagnostics/fisher_diagnostic.json

================================================================================
K = 10
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/1 (train=561, val=1709, test=5647) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.28e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k10/training_curves/split0_dynamics.json

  Aggregating results for k=10 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          75.52%     0.29%    15
  restricted_standard_mlp                                   66.89%     0.57%    15
  restricted_rownorm_mlp                                    63.36%     0.35%    15
  log_magnitude                                             62.91%     0.30%    15
  dual_stream                                               63.17%     0.34%    15
  spectral_rownorm_alpha-1.0                                65.74%     0.27%    15
  spectral_rownorm_alpha-0.5                                64.74%     0.35%    15
  spectral_rownorm_alpha0.0                                 63.35%     0.42%    15
  spectral_rownorm_alpha0.5                                 61.61%     0.40%    15
  spectral_rownorm_alpha1.0                                 60.47%     0.40%    15
  nested_spheres_a-1.0_b-1.0                                65.53%     0.46%    15
  nested_spheres_a-1.0_b-0.5                                65.57%     0.44%    15
  nested_spheres_a-1.0_b0.0                                 65.53%     0.42%    15
  nested_spheres_a-1.0_b0.5                                 65.75%     0.36%    15
  nested_spheres_a-1.0_b1.0                                 65.68%     0.44%    15
  nested_spheres_a-0.5_b-1.0                                64.58%     0.36%    15
  nested_spheres_a-0.5_b-0.5                                64.64%     0.30%    15
  nested_spheres_a-0.5_b0.0                                 64.53%     0.35%    15
  nested_spheres_a-0.5_b0.5                                 64.60%     0.39%    15
  nested_spheres_a-0.5_b1.0                                 64.46%     0.34%    15
  nested_spheres_a0.0_b-1.0                                 63.26%     0.34%    15
  nested_spheres_a0.0_b-0.5                                 63.29%     0.45%    15
  nested_spheres_a0.0_b0.0                                  63.19%     0.36%    15
  nested_spheres_a0.0_b0.5                                  63.33%     0.45%    15
  nested_spheres_a0.0_b1.0                                  62.91%     0.30%    15
  nested_spheres_a0.5_b-1.0                                 61.46%     0.35%    15
  nested_spheres_a0.5_b-0.5                                 61.41%     0.41%    15
  nested_spheres_a0.5_b0.0                                  61.42%     0.22%    15
  nested_spheres_a0.5_b0.5                                  61.59%     0.36%    15
  nested_spheres_a0.5_b1.0                                  61.31%     0.48%    15
  nested_spheres_a1.0_b-1.0                                 60.20%     0.42%    15
  nested_spheres_a1.0_b-0.5                                 60.44%     0.40%    15
  nested_spheres_a1.0_b0.0                                  60.54%     0.38%    15
  nested_spheres_a1.0_b0.5                                  60.29%     0.35%    15
  nested_spheres_a1.0_b1.0                                  60.27%     0.35%    15

  Framework Analysis (k=10):
    Part A (SGC+MLP - Restricted+Std): +8.628 pp
    Part B (RowNorm - Restricted+Std): -3.524 pp
    Remaining Gap:                     +12.152 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k10/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k10/diagnostics/fisher_diagnostic.json

================================================================================
K = 12
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/1 (train=561, val=1709, test=5647) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.29e-10

  Aggregating results for k=12 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          74.78%     0.52%    15
  restricted_standard_mlp                                   67.57%     0.55%    15
  restricted_rownorm_mlp                                    63.88%     0.39%    15

  Framework Analysis (k=12):
    Part A (SGC+MLP - Restricted+Std): +7.207 pp
    Part B (RowNorm - Restricted+Std): -3.689 pp
    Remaining Gap:                     +10.897 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k12/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k12/diagnostics/fisher_diagnostic.json

================================================================================
K = 20
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/1 (train=561, val=1709, test=5647) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.25e-10

  Aggregating results for k=20 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          72.36%     0.50%    15
  restricted_standard_mlp                                   67.96%     0.49%    15
  restricted_rownorm_mlp                                    65.18%     0.65%    15

  Framework Analysis (k=20):
    Part A (SGC+MLP - Restricted+Std): +4.393 pp
    Part B (RowNorm - Restricted+Std): -2.780 pp
    Remaining Gap:                     +7.173 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k20/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k20/diagnostics/fisher_diagnostic.json

================================================================================
K = 30
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/1 (train=561, val=1709, test=5647) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.19e-10

  Aggregating results for k=30 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          69.68%     0.62%    15
  restricted_standard_mlp                                   69.28%     0.35%    15
  restricted_rownorm_mlp                                    66.58%     0.48%    15

  Framework Analysis (k=30):
    Part A (SGC+MLP - Restricted+Std): +0.395 pp
    Part B (RowNorm - Restricted+Std): -2.704 pp
    Remaining Gap:                     +3.099 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k30/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/k30/diagnostics/fisher_diagnostic.json

================================================================================
MASTER TRAINING EXPERIMENT COMPLETE
================================================================================
Results saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc
[2/2] Analytics: wikics fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/torch_geometric/datasets/wikics.py:45: UserWarning: The WikiCS dataset now returns an undirected graph by default. Please explicitly specify 'is_undirected=False' to restore the old behavior.
  warnings.warn(
================================================================================
MASTER ANALYTICS (Exp 2 + Exp 8)
================================================================================
Dataset:       wikics
Split type:    fixed
Component:     lcc
k values:      [1, 2, 4, 6, 8, 10, 12, 20, 30]
Results dir:   /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc
================================================================================

[Step 1] Loading dataset and graph...
WikiCS using split 0: Train=580, Val=1769, Test=5847
Nodes: 11,701, Features: 300, Classes: 10

[Step 2] Extracting LCC...
After LCC: nodes=11,311, classes=10

================================================================================
EXP 2: SPECTRAL ANALYSIS (all k values)
================================================================================

  k=1:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=2.914060104330929e-10
    Condition U=37.6626  Condition X=2122.0974  Separability=0.2059  SpanErr=3.81e-01
    Var ratio U=10.90  Var ratio X=876.81  Reduction=80.47x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/analytics/exp2_spectral_analysis_k1.json

  k=2:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=3.452316210683648e-10
    Condition U=53.4795  Condition X=6096.5271  Separability=0.2135  SpanErr=4.11e-01
    Var ratio U=18.69  Var ratio X=1131.67  Reduction=60.54x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/analytics/exp2_spectral_analysis_k2.json

  k=4:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=6.955186426793603e-10
    Condition U=176.4779  Condition X=43340.0417  Separability=0.2240  SpanErr=4.08e-01
    Var ratio U=250.48  Var ratio X=3377.36  Reduction=13.48x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/analytics/exp2_spectral_analysis_k4.json

  k=6:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=8.586974464819264e-10
    Condition U=610.2722  Condition X=213176.1433  Separability=0.2382  SpanErr=3.99e-01
    Var ratio U=265.50  Var ratio X=6545.87  Reduction=24.65x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/analytics/exp2_spectral_analysis_k6.json

  k=8:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=9.241524212555419e-10
    Condition U=1367.8567  Condition X=873803.6985  Separability=0.2507  SpanErr=3.89e-01
    Var ratio U=1695.33  Var ratio X=11038.95  Reduction=6.51x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/analytics/exp2_spectral_analysis_k8.json

  k=10:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=9.28288113044573e-10
    Condition U=2738.3314  Condition X=3501759.1317  Separability=0.2596  SpanErr=3.64e-01
    Var ratio U=7525.21  Var ratio X=18090.26  Reduction=2.40x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/analytics/exp2_spectral_analysis_k10.json

  k=12:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=9.286902358240923e-10
    Condition U=5322.9425  Condition X=12347222.1792  Separability=0.2658  SpanErr=3.32e-01
    Var ratio U=24503.22  Var ratio X=30311.04  Reduction=1.24x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/analytics/exp2_spectral_analysis_k12.json

  k=20:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=9.247416166147104e-10
    Condition U=47901.0040  Condition X=1201147694.8707  Separability=0.2791  SpanErr=3.23e-01
    Var ratio U=9854875.62  Var ratio X=270816.68  Reduction=0.03x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/analytics/exp2_spectral_analysis_k20.json

  k=30:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=9.19268106081006e-10
    Condition U=2369987.6341  Condition X=442067118945.3215  Separability=0.2862  SpanErr=3.27e-01
    Var ratio U=202128062.86  Var ratio X=2485916.00  Reduction=0.01x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/analytics/exp2_spectral_analysis_k30.json

================================================================================
EXP 8: k-SENSITIVITY ANALYSIS
================================================================================

     k    SGC+MLP      R+Std       R+RN     Part A     Part B    Rem.Gap     Fisher   n_runs
  -----------------------------------------------------------------------------------------------
     1     78.08%     52.74%     51.18%    +25.338     -1.564    +26.903    0.15595       15
     2     78.91%     58.22%     56.53%    +20.692     -1.691    +22.382    0.13550       15
     4     78.12%     60.32%     58.95%    +17.801     -1.361    +19.162    0.09083       15
     6     77.50%     62.99%     60.80%    +14.509     -2.188    +16.697    0.07247       15
     8     76.30%     64.94%     62.34%    +11.365     -2.591    +13.957    0.06385       15
    10     75.52%     66.89%     63.36%     +8.628     -3.524    +12.152    0.05973       15
    12     74.78%     67.57%     63.88%     +7.207     -3.689    +10.897    0.05772       15
    20     72.36%     67.96%     65.18%     +4.393     -2.780     +7.173    0.05609       15
    30     69.68%     69.28%     66.58%     +0.396     -2.704     +3.099    0.05680       15

  Saved JSON: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/analytics/exp8_k_sensitivity.json
  Saved CSV:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/analytics/exp8_k_sensitivity.csv

================================================================================
MASTER ANALYTICS COMPLETE
================================================================================
Analytics saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_fixed_lcc/analytics
[1/2] Training: wikics random
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/torch_geometric/datasets/wikics.py:45: UserWarning: The WikiCS dataset now returns an undirected graph by default. Please explicitly specify 'is_undirected=False' to restore the old behavior.
  warnings.warn(
================================================================================
MASTER TRAINING EXPERIMENT
================================================================================
Dataset:      wikics
k values:     [1, 2, 4, 6, 8, 10, 12, 20, 30]
Split type:   random  (5 split(s) x 15 seeds)
Component:    lcc
Device:       cuda
Output base:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc
================================================================================

[Step 1] Loading dataset...
WikiCS using split 0: Train=580, Val=1769, Test=5847
Nodes: 11,701, Features: 300, Classes: 10

[Step 2] Building graph matrices...

[Step 3] Extracting largest connected component...
Rebuilding graph matrices for LCC...
After step 3: nodes=11,311, classes=10, disconnected_components_to_skip=0

[Step 4] Preparing splits...
Random split 0: Train=6786, Val=2262, Test=2263
Random split 1: Train=6786, Val=2262, Test=2263
Random split 2: Train=6786, Val=2262, Test=2263
Random split 3: Train=6786, Val=2262, Test=2263
Random split 4: Train=6786, Val=2262, Test=2263

[Step 5] Computing SGC normalized adjacency...
A_sgc = D^{-1/2}(A+I)D^{-1/2}

================================================================================
K = 1
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=2.91e-10

  --- Split 2/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=2.91e-10

  --- Split 3/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=2.91e-10

  --- Split 4/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=2.91e-10

  --- Split 5/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=2.91e-10

  Aggregating results for k=1 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          83.49%     0.89%    75
  restricted_standard_mlp                                   77.62%     0.95%    75
  restricted_rownorm_mlp                                    79.61%     0.75%    75

  Framework Analysis (k=1):
    Part A (SGC+MLP - Restricted+Std): +5.869 pp
    Part B (RowNorm - Restricted+Std): +1.993 pp
    Remaining Gap:                     +3.876 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k1/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k1/diagnostics/fisher_diagnostic.json

================================================================================
K = 2
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=3.45e-10

  --- Split 2/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=3.45e-10

  --- Split 3/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=3.45e-10

  --- Split 4/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=3.45e-10

  --- Split 5/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=3.45e-10

  Aggregating results for k=2 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          84.23%     1.07%    75
  restricted_standard_mlp                                   80.01%     0.92%    75
  restricted_rownorm_mlp                                    80.97%     1.15%    75

  Framework Analysis (k=2):
    Part A (SGC+MLP - Restricted+Std): +4.214 pp
    Part B (RowNorm - Restricted+Std): +0.961 pp
    Remaining Gap:                     +3.253 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k2/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k2/diagnostics/fisher_diagnostic.json

================================================================================
K = 4
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=6.96e-10

  --- Split 2/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=6.96e-10

  --- Split 3/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=6.96e-10

  --- Split 4/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=6.96e-10

  --- Split 5/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=6.96e-10

  Aggregating results for k=4 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          83.19%     1.05%    75
  restricted_standard_mlp                                   79.82%     1.24%    75
  restricted_rownorm_mlp                                    79.84%     1.10%    75

  Framework Analysis (k=4):
    Part A (SGC+MLP - Restricted+Std): +3.375 pp
    Part B (RowNorm - Restricted+Std): +0.025 pp
    Remaining Gap:                     +3.351 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k4/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k4/diagnostics/fisher_diagnostic.json

================================================================================
K = 6
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=8.59e-10

  --- Split 2/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=8.59e-10

  --- Split 3/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=8.59e-10

  --- Split 4/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=8.59e-10

  --- Split 5/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=8.59e-10

  Aggregating results for k=6 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          82.28%     1.11%    75
  restricted_standard_mlp                                   80.07%     0.93%    75
  restricted_rownorm_mlp                                    79.95%     1.15%    75

  Framework Analysis (k=6):
    Part A (SGC+MLP - Restricted+Std): +2.207 pp
    Part B (RowNorm - Restricted+Std): -0.124 pp
    Remaining Gap:                     +2.331 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k6/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k6/diagnostics/fisher_diagnostic.json

================================================================================
K = 8
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.24e-10

  --- Split 2/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.24e-10

  --- Split 3/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.24e-10

  --- Split 4/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.24e-10

  --- Split 5/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.24e-10

  Aggregating results for k=8 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          81.30%     1.00%    75
  restricted_standard_mlp                                   80.31%     0.94%    75
  restricted_rownorm_mlp                                    79.94%     1.05%    75

  Framework Analysis (k=8):
    Part A (SGC+MLP - Restricted+Std): +0.983 pp
    Part B (RowNorm - Restricted+Std): -0.376 pp
    Remaining Gap:                     +1.359 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k8/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k8/diagnostics/fisher_diagnostic.json

================================================================================
K = 10
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.28e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k10/training_curves/split0_dynamics.json

  --- Split 2/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.28e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k10/training_curves/split1_dynamics.json

  --- Split 3/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.28e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k10/training_curves/split2_dynamics.json

  --- Split 4/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.28e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k10/training_curves/split3_dynamics.json

  --- Split 5/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.28e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k10/training_curves/split4_dynamics.json

  Aggregating results for k=10 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          80.74%     1.00%    75
  restricted_standard_mlp                                   80.41%     0.89%    75
  restricted_rownorm_mlp                                    80.01%     1.03%    75
  log_magnitude                                             81.33%     1.04%    75
  dual_stream                                               81.07%     0.99%    75
  spectral_rownorm_alpha-1.0                                80.65%     1.04%    75
  spectral_rownorm_alpha-0.5                                80.79%     0.99%    75
  spectral_rownorm_alpha0.0                                 80.90%     1.00%    75
  spectral_rownorm_alpha0.5                                 80.90%     0.89%    75
  spectral_rownorm_alpha1.0                                 80.67%     0.92%    75
  nested_spheres_a-1.0_b-1.0                                81.08%     1.06%    75
  nested_spheres_a-1.0_b-0.5                                81.04%     1.04%    75
  nested_spheres_a-1.0_b0.0                                 80.66%     1.02%    75
  nested_spheres_a-1.0_b0.5                                 81.02%     1.07%    75
  nested_spheres_a-1.0_b1.0                                 81.01%     1.06%    75
  nested_spheres_a-0.5_b-1.0                                81.16%     1.03%    75
  nested_spheres_a-0.5_b-0.5                                81.08%     1.06%    75
  nested_spheres_a-0.5_b0.0                                 80.73%     1.03%    75
  nested_spheres_a-0.5_b0.5                                 81.19%     1.09%    75
  nested_spheres_a-0.5_b1.0                                 81.12%     1.06%    75
  nested_spheres_a0.0_b-1.0                                 81.25%     1.05%    75
  nested_spheres_a0.0_b-0.5                                 81.25%     0.99%    75
  nested_spheres_a0.0_b0.0                                  80.93%     0.95%    75
  nested_spheres_a0.0_b0.5                                  81.28%     1.09%    75
  nested_spheres_a0.0_b1.0                                  81.33%     1.04%    75
  nested_spheres_a0.5_b-1.0                                 81.37%     0.94%    75
  nested_spheres_a0.5_b-0.5                                 81.21%     0.95%    75
  nested_spheres_a0.5_b0.0                                  80.92%     0.90%    75
  nested_spheres_a0.5_b0.5                                  81.19%     0.96%    75
  nested_spheres_a0.5_b1.0                                  81.35%     0.97%    75
  nested_spheres_a1.0_b-1.0                                 81.19%     0.93%    75
  nested_spheres_a1.0_b-0.5                                 81.15%     0.88%    75
  nested_spheres_a1.0_b0.0                                  80.67%     0.88%    75
  nested_spheres_a1.0_b0.5                                  81.10%     0.93%    75
  nested_spheres_a1.0_b1.0                                  81.19%     0.88%    75

  Framework Analysis (k=10):
    Part A (SGC+MLP - Restricted+Std): +0.330 pp
    Part B (RowNorm - Restricted+Std): -0.401 pp
    Remaining Gap:                     +0.731 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k10/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k10/diagnostics/fisher_diagnostic.json

================================================================================
K = 12
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.29e-10

  --- Split 2/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.29e-10

  --- Split 3/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.29e-10

  --- Split 4/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.29e-10

  --- Split 5/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.29e-10

  Aggregating results for k=12 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          80.34%     1.04%    75
  restricted_standard_mlp                                   80.63%     0.98%    75
  restricted_rownorm_mlp                                    80.24%     1.04%    75

  Framework Analysis (k=12):
    Part A (SGC+MLP - Restricted+Std): -0.281 pp
    Part B (RowNorm - Restricted+Std): -0.381 pp
    Remaining Gap:                     +0.100 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k12/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k12/diagnostics/fisher_diagnostic.json

================================================================================
K = 20
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.25e-10

  --- Split 2/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.25e-10

  --- Split 3/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.25e-10

  --- Split 4/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.25e-10

  --- Split 5/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.25e-10

  Aggregating results for k=20 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          78.53%     1.16%    75
  restricted_standard_mlp                                   81.12%     1.06%    75
  restricted_rownorm_mlp                                    80.84%     1.06%    75

  Framework Analysis (k=20):
    Part A (SGC+MLP - Restricted+Std): -2.591 pp
    Part B (RowNorm - Restricted+Std): -0.275 pp
    Remaining Gap:                     -2.317 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k20/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k20/diagnostics/fisher_diagnostic.json

================================================================================
K = 30
================================================================================
  X_diffused shape: (11311, 300)

  --- Split 1/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.19e-10

  --- Split 2/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.19e-10

  --- Split 3/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.19e-10

  --- Split 4/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.19e-10

  --- Split 5/5 (train=6786, val=2262, test=2263) ---
  Computing restricted eigenvectors...
  d_effective=300, ortho_error=9.19e-10

  Aggregating results for k=30 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          74.26%     1.00%    75
  restricted_standard_mlp                                   81.49%     0.99%    75
  restricted_rownorm_mlp                                    81.07%     1.02%    75

  Framework Analysis (k=30):
    Part A (SGC+MLP - Restricted+Std): -7.227 pp
    Part B (RowNorm - Restricted+Std): -0.424 pp
    Remaining Gap:                     -6.803 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k30/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/k30/diagnostics/fisher_diagnostic.json

================================================================================
MASTER TRAINING EXPERIMENT COMPLETE
================================================================================
Results saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc
[2/2] Analytics: wikics random
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/torch_geometric/datasets/wikics.py:45: UserWarning: The WikiCS dataset now returns an undirected graph by default. Please explicitly specify 'is_undirected=False' to restore the old behavior.
  warnings.warn(
================================================================================
MASTER ANALYTICS (Exp 2 + Exp 8)
================================================================================
Dataset:       wikics
Split type:    random
Component:     lcc
k values:      [1, 2, 4, 6, 8, 10, 12, 20, 30]
Results dir:   /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc
================================================================================

[Step 1] Loading dataset and graph...
WikiCS using split 0: Train=580, Val=1769, Test=5847
Nodes: 11,701, Features: 300, Classes: 10

[Step 2] Extracting LCC...
After LCC: nodes=11,311, classes=10

================================================================================
EXP 2: SPECTRAL ANALYSIS (all k values)
================================================================================

  k=1:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=2.914060104330929e-10
    Condition U=10.0229  Condition X=996.2274  Separability=0.1370  SpanErr=6.92e-01
    Var ratio U=11.25  Var ratio X=664.66  Reduction=59.06x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/analytics/exp2_spectral_analysis_k1.json

  k=2:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=3.452316210683648e-10
    Condition U=8.1717  Condition X=2316.0428  Separability=0.1564  SpanErr=7.01e-01
    Var ratio U=13.55  Var ratio X=931.69  Reduction=68.76x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/analytics/exp2_spectral_analysis_k2.json

  k=4:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=6.955186426793603e-10
    Condition U=11.0686  Condition X=9466.4304  Separability=0.1775  SpanErr=7.13e-01
    Var ratio U=36.29  Var ratio X=2329.67  Reduction=64.20x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/analytics/exp2_spectral_analysis_k4.json

  k=6:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=8.586974464819264e-10
    Condition U=18.9435  Condition X=33912.9187  Separability=0.1971  SpanErr=7.06e-01
    Var ratio U=44.58  Var ratio X=4488.96  Reduction=100.70x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/analytics/exp2_spectral_analysis_k6.json

  k=8:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=9.241524212555419e-10
    Condition U=42.7449  Condition X=115796.0830  Separability=0.2122  SpanErr=6.96e-01
    Var ratio U=46.77  Var ratio X=7817.48  Reduction=167.16x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/analytics/exp2_spectral_analysis_k8.json

  k=10:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=9.28288113044573e-10
    Condition U=80.8541  Condition X=387627.1739  Separability=0.2226  SpanErr=6.88e-01
    Var ratio U=52.41  Var ratio X=13408.12  Reduction=255.82x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/analytics/exp2_spectral_analysis_k10.json

  k=12:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=9.286902358240923e-10
    Condition U=111.6496  Condition X=1282546.8187  Separability=0.2299  SpanErr=6.81e-01
    Var ratio U=70.46  Var ratio X=22976.41  Reduction=326.10x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/analytics/exp2_spectral_analysis_k12.json

  k=20:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=9.247416166147104e-10
    Condition U=125.7671  Condition X=143109164.5770  Separability=0.2477  SpanErr=6.65e-01
    Var ratio U=54.72  Var ratio X=197025.81  Reduction=3600.77x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/analytics/exp2_spectral_analysis_k20.json

  k=30:
    WARNING: no cached matrices found, recomputing...
    d_effective=300, ortho_error=9.19268106081006e-10
    Condition U=125.6715  Condition X=47312067053.6776  Separability=0.2580  SpanErr=6.58e-01
    Var ratio U=51.87  Var ratio X=1469018.29  Reduction=28323.65x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/analytics/exp2_spectral_analysis_k30.json

================================================================================
EXP 8: k-SENSITIVITY ANALYSIS
================================================================================

     k    SGC+MLP      R+Std       R+RN     Part A     Part B    Rem.Gap     Fisher   n_runs
  -----------------------------------------------------------------------------------------------
     1     83.49%     77.62%     79.61%     +5.869     +1.993     +3.876    0.11086       75
     2     84.23%     80.01%     80.97%     +4.215     +0.961     +3.253    0.11150       75
     4     83.19%     79.82%     79.84%     +3.376     +0.025     +3.351    0.09738       75
     6     82.28%     80.07%     79.95%     +2.207     -0.124     +2.331    0.09168       75
     8     81.30%     80.31%     79.94%     +0.983     -0.377     +1.359    0.08976       75
    10     80.74%     80.41%     80.01%     +0.330     -0.401     +0.731    0.08898       75
    12     80.34%     80.63%     80.24%     -0.281     -0.381     +0.100    0.08845       75
    20     78.53%     81.12%     80.84%     -2.591     -0.275     -2.317    0.08715       75
    30     74.26%     81.49%     81.07%     -7.227     -0.424     -6.803    0.08711       75

  Saved JSON: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/analytics/exp8_k_sensitivity.json
  Saved CSV:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/analytics/exp8_k_sensitivity.csv

================================================================================
MASTER ANALYTICS COMPLETE
================================================================================
Analytics saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/wikics_random_lcc/analytics
   wikics complete  |  Sun Feb 22 10:48:00 PM EST 2026

--------------------------------------------------------
 DATASET: amazon-computers  |  Sun Feb 22 10:48:00 PM EST 2026
--------------------------------------------------------
[1/2] Training: amazon-computers fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER TRAINING EXPERIMENT
================================================================================
Dataset:      amazon-computers
k values:     [1, 2, 4, 6, 8, 10, 12, 20, 30]
Split type:   fixed  (1 split(s) x 15 seeds)
Component:    lcc
Device:       cuda
Output base:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc
================================================================================

[Step 1] Loading dataset...
Creating 60/20/20 split for amazon-computers...
Nodes: 13,752, Features: 767, Classes: 10

[Step 2] Building graph matrices...

[Step 3] Extracting largest connected component...
Rebuilding graph matrices for LCC...
After step 3: nodes=13,381, classes=10, disconnected_components_to_skip=0

[Step 4] Preparing splits...
Fixed split: Train=8031, Val=2674, Test=2676

[Step 5] Computing SGC normalized adjacency...
A_sgc = D^{-1/2}(A+I)D^{-1/2}

================================================================================
K = 1
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/1 (train=8031, val=2674, test=2676) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=1.75e-10

  Aggregating results for k=1 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          92.64%     0.29%    15
  restricted_standard_mlp                                   89.31%     0.34%    15
  restricted_rownorm_mlp                                    89.18%     0.44%    15

  Framework Analysis (k=1):
    Part A (SGC+MLP - Restricted+Std): +3.331 pp
    Part B (RowNorm - Restricted+Std): -0.125 pp
    Remaining Gap:                     +3.455 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k1/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k1/diagnostics/fisher_diagnostic.json

================================================================================
K = 2
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/1 (train=8031, val=2674, test=2676) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=3.61e-10

  Aggregating results for k=2 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          92.63%     0.25%    15
  restricted_standard_mlp                                   89.14%     0.30%    15
  restricted_rownorm_mlp                                    89.90%     0.28%    15

  Framework Analysis (k=2):
    Part A (SGC+MLP - Restricted+Std): +3.483 pp
    Part B (RowNorm - Restricted+Std): +0.757 pp
    Remaining Gap:                     +2.725 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k2/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k2/diagnostics/fisher_diagnostic.json

================================================================================
K = 4
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/1 (train=8031, val=2674, test=2676) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.05e-10

  Aggregating results for k=4 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          90.48%     0.47%    15
  restricted_standard_mlp                                   88.78%     0.31%    15
  restricted_rownorm_mlp                                    89.46%     0.50%    15

  Framework Analysis (k=4):
    Part A (SGC+MLP - Restricted+Std): +1.692 pp
    Part B (RowNorm - Restricted+Std): +0.673 pp
    Remaining Gap:                     +1.019 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k4/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k4/diagnostics/fisher_diagnostic.json

================================================================================
K = 6
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/1 (train=8031, val=2674, test=2676) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.62e-10

  Aggregating results for k=6 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          87.68%     0.66%    15
  restricted_standard_mlp                                   89.14%     0.27%    15
  restricted_rownorm_mlp                                    89.13%     0.42%    15

  Framework Analysis (k=6):
    Part A (SGC+MLP - Restricted+Std): -1.452 pp
    Part B (RowNorm - Restricted+Std): -0.005 pp
    Remaining Gap:                     -1.447 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k6/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k6/diagnostics/fisher_diagnostic.json

================================================================================
K = 8
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/1 (train=8031, val=2674, test=2676) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.51e-10

  Aggregating results for k=8 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          85.26%     0.77%    15
  restricted_standard_mlp                                   89.33%     0.26%    15
  restricted_rownorm_mlp                                    89.13%     0.37%    15

  Framework Analysis (k=8):
    Part A (SGC+MLP - Restricted+Std): -4.071 pp
    Part B (RowNorm - Restricted+Std): -0.209 pp
    Remaining Gap:                     -3.861 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k8/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k8/diagnostics/fisher_diagnostic.json

================================================================================
K = 10
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/1 (train=8031, val=2674, test=2676) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.43e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k10/training_curves/split0_dynamics.json

  Aggregating results for k=10 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          83.95%     0.59%    15
  restricted_standard_mlp                                   89.50%     0.22%    15
  restricted_rownorm_mlp                                    89.39%     0.29%    15
  log_magnitude                                             90.44%     0.26%    15
  dual_stream                                               90.28%     0.26%    15
  spectral_rownorm_alpha-1.0                                90.84%     0.23%    15
  spectral_rownorm_alpha-0.5                                90.75%     0.19%    15
  spectral_rownorm_alpha0.0                                 90.40%     0.12%    15
  spectral_rownorm_alpha0.5                                 90.18%     0.19%    15
  spectral_rownorm_alpha1.0                                 89.95%     0.16%    15
  nested_spheres_a-1.0_b-1.0                                90.96%     0.20%    15
  nested_spheres_a-1.0_b-0.5                                90.95%     0.14%    15
  nested_spheres_a-1.0_b0.0                                 90.99%     0.16%    15
  nested_spheres_a-1.0_b0.5                                 90.95%     0.25%    15
  nested_spheres_a-1.0_b1.0                                 91.12%     0.20%    15
  nested_spheres_a-0.5_b-1.0                                90.90%     0.26%    15
  nested_spheres_a-0.5_b-0.5                                90.83%     0.19%    15
  nested_spheres_a-0.5_b0.0                                 90.62%     0.24%    15
  nested_spheres_a-0.5_b0.5                                 90.85%     0.17%    15
  nested_spheres_a-0.5_b1.0                                 90.98%     0.18%    15
  nested_spheres_a0.0_b-1.0                                 90.51%     0.26%    15
  nested_spheres_a0.0_b-0.5                                 90.43%     0.19%    15
  nested_spheres_a0.0_b0.0                                  90.52%     0.22%    15
  nested_spheres_a0.0_b0.5                                  90.54%     0.15%    15
  nested_spheres_a0.0_b1.0                                  90.44%     0.26%    15
  nested_spheres_a0.5_b-1.0                                 90.30%     0.22%    15
  nested_spheres_a0.5_b-0.5                                 90.24%     0.21%    15
  nested_spheres_a0.5_b0.0                                  90.10%     0.19%    15
  nested_spheres_a0.5_b0.5                                  90.25%     0.19%    15
  nested_spheres_a0.5_b1.0                                  90.25%     0.20%    15
  nested_spheres_a1.0_b-1.0                                 89.94%     0.23%    15
  nested_spheres_a1.0_b-0.5                                 89.99%     0.21%    15
  nested_spheres_a1.0_b0.0                                  89.84%     0.24%    15
  nested_spheres_a1.0_b0.5                                  89.96%     0.28%    15
  nested_spheres_a1.0_b1.0                                  90.10%     0.22%    15

  Framework Analysis (k=10):
    Part A (SGC+MLP - Restricted+Std): -5.548 pp
    Part B (RowNorm - Restricted+Std): -0.112 pp
    Remaining Gap:                     -5.436 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k10/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k10/diagnostics/fisher_diagnostic.json

================================================================================
K = 12
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/1 (train=8031, val=2674, test=2676) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.38e-10

  Aggregating results for k=12 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          82.75%     0.66%    15
  restricted_standard_mlp                                   89.58%     0.30%    15
  restricted_rownorm_mlp                                    89.52%     0.30%    15

  Framework Analysis (k=12):
    Part A (SGC+MLP - Restricted+Std): -6.836 pp
    Part B (RowNorm - Restricted+Std): -0.060 pp
    Remaining Gap:                     -6.776 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k12/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k12/diagnostics/fisher_diagnostic.json

================================================================================
K = 20
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/1 (train=8031, val=2674, test=2676) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.30e-10

  Aggregating results for k=20 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          79.82%     0.86%    15
  restricted_standard_mlp                                   89.77%     0.26%    15
  restricted_rownorm_mlp                                    89.86%     0.18%    15

  Framework Analysis (k=20):
    Part A (SGC+MLP - Restricted+Std): -9.948 pp
    Part B (RowNorm - Restricted+Std): +0.085 pp
    Remaining Gap:                     -10.032 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k20/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k20/diagnostics/fisher_diagnostic.json

================================================================================
K = 30
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/1 (train=8031, val=2674, test=2676) ---
  Computing restricted eigenvectors...
  d_effective=761, ortho_error=7.11e-10

  Aggregating results for k=30 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          75.11%     1.75%    15
  restricted_standard_mlp                                   89.92%     0.28%    15
  restricted_rownorm_mlp                                    90.04%     0.36%    15

  Framework Analysis (k=30):
    Part A (SGC+MLP - Restricted+Std): -14.816 pp
    Part B (RowNorm - Restricted+Std): +0.120 pp
    Remaining Gap:                     -14.935 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k30/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/k30/diagnostics/fisher_diagnostic.json

================================================================================
MASTER TRAINING EXPERIMENT COMPLETE
================================================================================
Results saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc
[2/2] Analytics: amazon-computers fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER ANALYTICS (Exp 2 + Exp 8)
================================================================================
Dataset:       amazon-computers
Split type:    fixed
Component:     lcc
k values:      [1, 2, 4, 6, 8, 10, 12, 20, 30]
Results dir:   /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc
================================================================================

[Step 1] Loading dataset and graph...
Creating 60/20/20 split for amazon-computers...
Nodes: 13,752, Features: 767, Classes: 10

[Step 2] Extracting LCC...
After LCC: nodes=13,381, classes=10

================================================================================
EXP 2: SPECTRAL ANALYSIS (all k values)
================================================================================

  k=1:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=1.7521073480963878e-10
    Condition U=9.8365  Condition X=297.0543  Separability=0.1256  SpanErr=5.69e-01
    Var ratio U=4.74  Var ratio X=5.41  Reduction=1.14x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/analytics/exp2_spectral_analysis_k1.json

  k=2:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=3.605753473578943e-10
    Condition U=15.3714  Condition X=1118.5560  Separability=0.1435  SpanErr=5.53e-01
    Var ratio U=17.68  Var ratio X=6.32  Reduction=0.36x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/analytics/exp2_spectral_analysis_k2.json

  k=4:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=6.047821132781905e-10
    Condition U=19.6703  Condition X=9652.3094  Separability=0.1698  SpanErr=6.13e-01
    Var ratio U=44.22  Var ratio X=6.86  Reduction=0.16x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/analytics/exp2_spectral_analysis_k4.json

  k=6:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=6.621420078900542e-10
    Condition U=20.9606  Condition X=63782.0410  Separability=0.1868  SpanErr=6.29e-01
    Var ratio U=37.30  Var ratio X=7.21  Reduction=0.19x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/analytics/exp2_spectral_analysis_k6.json

  k=8:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=6.505876948281752e-10
    Condition U=30.7128  Condition X=379214.5848  Separability=0.1970  SpanErr=6.35e-01
    Var ratio U=81.11  Var ratio X=7.38  Reduction=0.09x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/analytics/exp2_spectral_analysis_k8.json

  k=10:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=6.428663157365122e-10
    Condition U=38.5597  Condition X=2142084.8691  Separability=0.2036  SpanErr=6.37e-01
    Var ratio U=111.31  Var ratio X=7.62  Reduction=0.07x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/analytics/exp2_spectral_analysis_k10.json

  k=12:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=6.376574823718784e-10
    Condition U=42.3623  Condition X=11611615.6244  Separability=0.2078  SpanErr=6.37e-01
    Var ratio U=121.39  Var ratio X=7.80  Reduction=0.06x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/analytics/exp2_spectral_analysis_k12.json

  k=20:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=6.299794019781757e-10
    Condition U=60.9933  Condition X=8335333595.9539  Separability=0.2168  SpanErr=6.30e-01
    Var ratio U=124.29  Var ratio X=8.51  Reduction=0.07x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/analytics/exp2_spectral_analysis_k20.json

  k=30:
    WARNING: no cached matrices found, recomputing...
    d_effective=761, ortho_error=7.10797865011159e-10
    Condition U=65.5177  Condition X=24776756315455.2305  Separability=0.2219  SpanErr=6.21e-01
    Var ratio U=124.04  Var ratio X=8.69  Reduction=0.07x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/analytics/exp2_spectral_analysis_k30.json

================================================================================
EXP 8: k-SENSITIVITY ANALYSIS
================================================================================

     k    SGC+MLP      R+Std       R+RN     Part A     Part B    Rem.Gap     Fisher   n_runs
  -----------------------------------------------------------------------------------------------
     1     92.64%     89.31%     89.18%     +3.331     -0.125     +3.455    0.08787       15
     2     92.63%     89.14%     89.90%     +3.483     +0.757     +2.725    0.06840       15
     4     90.48%     88.78%     89.46%     +1.692     +0.673     +1.019    0.05433       15
     6     87.68%     89.14%     89.13%     -1.452     -0.005     -1.447    0.04914       15
     8     85.26%     89.33%     89.13%     -4.071     -0.209     -3.861    0.04625       15
    10     83.95%     89.50%     89.39%     -5.548     -0.112     -5.436    0.04445       15
    12     82.75%     89.58%     89.52%     -6.836     -0.060     -6.776    0.04327       15
    20     79.82%     89.77%     89.86%     -9.948     +0.085    -10.032    0.04108       15
    30     75.11%     89.92%     90.04%    -14.816     +0.120    -14.935    0.04020       15

  Saved JSON: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/analytics/exp8_k_sensitivity.json
  Saved CSV:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/analytics/exp8_k_sensitivity.csv

================================================================================
MASTER ANALYTICS COMPLETE
================================================================================
Analytics saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_fixed_lcc/analytics
[1/2] Training: amazon-computers random
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER TRAINING EXPERIMENT
================================================================================
Dataset:      amazon-computers
k values:     [1, 2, 4, 6, 8, 10, 12, 20, 30]
Split type:   random  (5 split(s) x 15 seeds)
Component:    lcc
Device:       cuda
Output base:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc
================================================================================

[Step 1] Loading dataset...
Creating 60/20/20 split for amazon-computers...
Nodes: 13,752, Features: 767, Classes: 10

[Step 2] Building graph matrices...

[Step 3] Extracting largest connected component...
Rebuilding graph matrices for LCC...
After step 3: nodes=13,381, classes=10, disconnected_components_to_skip=0

[Step 4] Preparing splits...
Random split 0: Train=8028, Val=2676, Test=2677
Random split 1: Train=8028, Val=2676, Test=2677
Random split 2: Train=8028, Val=2676, Test=2677
Random split 3: Train=8028, Val=2676, Test=2677
Random split 4: Train=8028, Val=2676, Test=2677

[Step 5] Computing SGC normalized adjacency...
A_sgc = D^{-1/2}(A+I)D^{-1/2}

================================================================================
K = 1
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=1.75e-10

  --- Split 2/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=1.75e-10

  --- Split 3/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=1.75e-10

  --- Split 4/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=1.75e-10

  --- Split 5/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=1.75e-10

  Aggregating results for k=1 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          92.20%     0.42%    75
  restricted_standard_mlp                                   88.81%     0.43%    75
  restricted_rownorm_mlp                                    88.71%     0.53%    75

  Framework Analysis (k=1):
    Part A (SGC+MLP - Restricted+Std): +3.389 pp
    Part B (RowNorm - Restricted+Std): -0.107 pp
    Remaining Gap:                     +3.496 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k1/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k1/diagnostics/fisher_diagnostic.json

================================================================================
K = 2
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=3.61e-10

  --- Split 2/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=3.61e-10

  --- Split 3/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=3.61e-10

  --- Split 4/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=3.61e-10

  --- Split 5/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=3.61e-10

  Aggregating results for k=2 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          92.30%     0.50%    75
  restricted_standard_mlp                                   89.17%     0.54%    75
  restricted_rownorm_mlp                                    89.85%     0.56%    75

  Framework Analysis (k=2):
    Part A (SGC+MLP - Restricted+Std): +3.124 pp
    Part B (RowNorm - Restricted+Std): +0.673 pp
    Remaining Gap:                     +2.451 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k2/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k2/diagnostics/fisher_diagnostic.json

================================================================================
K = 4
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.05e-10

  --- Split 2/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.05e-10

  --- Split 3/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.05e-10

  --- Split 4/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.05e-10

  --- Split 5/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.05e-10

  Aggregating results for k=4 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          90.18%     0.63%    75
  restricted_standard_mlp                                   88.72%     0.55%    75
  restricted_rownorm_mlp                                    89.31%     0.52%    75

  Framework Analysis (k=4):
    Part A (SGC+MLP - Restricted+Std): +1.452 pp
    Part B (RowNorm - Restricted+Std): +0.581 pp
    Remaining Gap:                     +0.872 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k4/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k4/diagnostics/fisher_diagnostic.json

================================================================================
K = 6
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.62e-10

  --- Split 2/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.62e-10

  --- Split 3/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.62e-10

  --- Split 4/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.62e-10

  --- Split 5/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.62e-10

  Aggregating results for k=6 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          87.19%     0.92%    75
  restricted_standard_mlp                                   89.27%     0.61%    75
  restricted_rownorm_mlp                                    89.36%     0.61%    75

  Framework Analysis (k=6):
    Part A (SGC+MLP - Restricted+Std): -2.085 pp
    Part B (RowNorm - Restricted+Std): +0.082 pp
    Remaining Gap:                     -2.167 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k6/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k6/diagnostics/fisher_diagnostic.json

================================================================================
K = 8
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.51e-10

  --- Split 2/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.51e-10

  --- Split 3/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.51e-10

  --- Split 4/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.51e-10

  --- Split 5/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.51e-10

  Aggregating results for k=8 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          84.14%     0.93%    75
  restricted_standard_mlp                                   89.43%     0.66%    75
  restricted_rownorm_mlp                                    89.30%     0.47%    75

  Framework Analysis (k=8):
    Part A (SGC+MLP - Restricted+Std): -5.288 pp
    Part B (RowNorm - Restricted+Std): -0.127 pp
    Remaining Gap:                     -5.161 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k8/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k8/diagnostics/fisher_diagnostic.json

================================================================================
K = 10
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.43e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k10/training_curves/split0_dynamics.json

  --- Split 2/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.43e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k10/training_curves/split1_dynamics.json

  --- Split 3/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.43e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k10/training_curves/split2_dynamics.json

  --- Split 4/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.43e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k10/training_curves/split3_dynamics.json

  --- Split 5/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.43e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k10/training_curves/split4_dynamics.json

  Aggregating results for k=10 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          82.72%     0.60%    75
  restricted_standard_mlp                                   89.40%     0.56%    75
  restricted_rownorm_mlp                                    89.40%     0.55%    75
  log_magnitude                                             90.43%     0.50%    75
  dual_stream                                               90.35%     0.52%    75
  spectral_rownorm_alpha-1.0                                90.88%     0.52%    75
  spectral_rownorm_alpha-0.5                                90.69%     0.48%    75
  spectral_rownorm_alpha0.0                                 90.34%     0.52%    75
  spectral_rownorm_alpha0.5                                 90.07%     0.57%    75
  spectral_rownorm_alpha1.0                                 89.92%     0.62%    75
  nested_spheres_a-1.0_b-1.0                                90.87%     0.50%    75
  nested_spheres_a-1.0_b-0.5                                90.83%     0.51%    75
  nested_spheres_a-1.0_b0.0                                 90.80%     0.44%    75
  nested_spheres_a-1.0_b0.5                                 90.80%     0.52%    75
  nested_spheres_a-1.0_b1.0                                 90.81%     0.46%    75
  nested_spheres_a-0.5_b-1.0                                90.75%     0.51%    75
  nested_spheres_a-0.5_b-0.5                                90.73%     0.52%    75
  nested_spheres_a-0.5_b0.0                                 90.64%     0.45%    75
  nested_spheres_a-0.5_b0.5                                 90.69%     0.45%    75
  nested_spheres_a-0.5_b1.0                                 90.74%     0.51%    75
  nested_spheres_a0.0_b-1.0                                 90.48%     0.52%    75
  nested_spheres_a0.0_b-0.5                                 90.43%     0.54%    75
  nested_spheres_a0.0_b0.0                                  90.43%     0.52%    75
  nested_spheres_a0.0_b0.5                                  90.43%     0.49%    75
  nested_spheres_a0.0_b1.0                                  90.43%     0.50%    75
  nested_spheres_a0.5_b-1.0                                 90.22%     0.58%    75
  nested_spheres_a0.5_b-0.5                                 90.19%     0.65%    75
  nested_spheres_a0.5_b0.0                                  90.15%     0.60%    75
  nested_spheres_a0.5_b0.5                                  90.14%     0.63%    75
  nested_spheres_a0.5_b1.0                                  90.20%     0.59%    75
  nested_spheres_a1.0_b-1.0                                 89.90%     0.64%    75
  nested_spheres_a1.0_b-0.5                                 89.92%     0.63%    75
  nested_spheres_a1.0_b0.0                                  89.91%     0.70%    75
  nested_spheres_a1.0_b0.5                                  89.89%     0.64%    75
  nested_spheres_a1.0_b1.0                                  89.89%     0.57%    75

  Framework Analysis (k=10):
    Part A (SGC+MLP - Restricted+Std): -6.676 pp
    Part B (RowNorm - Restricted+Std): -0.004 pp
    Remaining Gap:                     -6.672 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k10/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k10/diagnostics/fisher_diagnostic.json

================================================================================
K = 12
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.38e-10

  --- Split 2/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.38e-10

  --- Split 3/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.38e-10

  --- Split 4/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.38e-10

  --- Split 5/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.38e-10

  Aggregating results for k=12 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          81.73%     0.79%    75
  restricted_standard_mlp                                   89.55%     0.54%    75
  restricted_rownorm_mlp                                    89.51%     0.55%    75

  Framework Analysis (k=12):
    Part A (SGC+MLP - Restricted+Std): -7.824 pp
    Part B (RowNorm - Restricted+Std): -0.042 pp
    Remaining Gap:                     -7.782 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k12/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k12/diagnostics/fisher_diagnostic.json

================================================================================
K = 20
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.30e-10

  --- Split 2/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.30e-10

  --- Split 3/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.30e-10

  --- Split 4/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.30e-10

  --- Split 5/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=767, ortho_error=6.30e-10

  Aggregating results for k=20 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          78.72%     0.77%    75
  restricted_standard_mlp                                   89.70%     0.55%    75
  restricted_rownorm_mlp                                    89.62%     0.52%    75

  Framework Analysis (k=20):
    Part A (SGC+MLP - Restricted+Std): -10.985 pp
    Part B (RowNorm - Restricted+Std): -0.083 pp
    Remaining Gap:                     -10.902 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k20/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k20/diagnostics/fisher_diagnostic.json

================================================================================
K = 30
================================================================================
  X_diffused shape: (13381, 767)

  --- Split 1/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=761, ortho_error=7.11e-10

  --- Split 2/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=761, ortho_error=7.11e-10

  --- Split 3/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=761, ortho_error=7.11e-10

  --- Split 4/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=761, ortho_error=7.11e-10

  --- Split 5/5 (train=8028, val=2676, test=2677) ---
  Computing restricted eigenvectors...
  d_effective=761, ortho_error=7.11e-10

  Aggregating results for k=30 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          74.34%     2.35%    75
  restricted_standard_mlp                                   89.84%     0.56%    75
  restricted_rownorm_mlp                                    89.75%     0.59%    75

  Framework Analysis (k=30):
    Part A (SGC+MLP - Restricted+Std): -15.498 pp
    Part B (RowNorm - Restricted+Std): -0.091 pp
    Remaining Gap:                     -15.407 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k30/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/k30/diagnostics/fisher_diagnostic.json

================================================================================
MASTER TRAINING EXPERIMENT COMPLETE
================================================================================
Results saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc
[2/2] Analytics: amazon-computers random
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER ANALYTICS (Exp 2 + Exp 8)
================================================================================
Dataset:       amazon-computers
Split type:    random
Component:     lcc
k values:      [1, 2, 4, 6, 8, 10, 12, 20, 30]
Results dir:   /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc
================================================================================

[Step 1] Loading dataset and graph...
Creating 60/20/20 split for amazon-computers...
Nodes: 13,752, Features: 767, Classes: 10

[Step 2] Extracting LCC...
After LCC: nodes=13,381, classes=10

================================================================================
EXP 2: SPECTRAL ANALYSIS (all k values)
================================================================================

  k=1:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=1.7521073480963878e-10
    Condition U=9.3802  Condition X=306.3285  Separability=0.1285  SpanErr=5.68e-01
    Var ratio U=4.74  Var ratio X=5.44  Reduction=1.15x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/analytics/exp2_spectral_analysis_k1.json

  k=2:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=3.605753473578943e-10
    Condition U=14.3588  Condition X=1168.3208  Separability=0.1454  SpanErr=5.53e-01
    Var ratio U=21.37  Var ratio X=6.22  Reduction=0.29x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/analytics/exp2_spectral_analysis_k2.json

  k=4:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=6.047821132781905e-10
    Condition U=18.2526  Condition X=9849.8125  Separability=0.1708  SpanErr=6.09e-01
    Var ratio U=33.74  Var ratio X=7.04  Reduction=0.21x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/analytics/exp2_spectral_analysis_k4.json

  k=6:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=6.621420078900542e-10
    Condition U=54.9374  Condition X=63784.1422  Separability=0.1871  SpanErr=6.23e-01
    Var ratio U=94.73  Var ratio X=7.38  Reduction=0.08x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/analytics/exp2_spectral_analysis_k6.json

  k=8:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=6.505876948281752e-10
    Condition U=90.0729  Condition X=376537.9552  Separability=0.1967  SpanErr=6.27e-01
    Var ratio U=106.23  Var ratio X=7.56  Reduction=0.07x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/analytics/exp2_spectral_analysis_k8.json

  k=10:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=6.428663157365122e-10
    Condition U=98.0926  Condition X=2107727.2168  Separability=0.2028  SpanErr=6.27e-01
    Var ratio U=112.08  Var ratio X=7.83  Reduction=0.07x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/analytics/exp2_spectral_analysis_k10.json

  k=12:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=6.376574823718784e-10
    Condition U=102.0310  Condition X=11413712.2822  Separability=0.2072  SpanErr=6.26e-01
    Var ratio U=108.14  Var ratio X=8.05  Reduction=0.07x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/analytics/exp2_spectral_analysis_k12.json

  k=20:
    WARNING: no cached matrices found, recomputing...
    d_effective=767, ortho_error=6.299794019781757e-10
    Condition U=108.0800  Condition X=8179119356.9984  Separability=0.2153  SpanErr=6.18e-01
    Var ratio U=207.65  Var ratio X=8.66  Reduction=0.04x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/analytics/exp2_spectral_analysis_k20.json

  k=30:
    WARNING: no cached matrices found, recomputing...
    d_effective=761, ortho_error=7.10797865011159e-10
    Condition U=109.0507  Condition X=24969772969810.0039  Separability=0.2207  SpanErr=6.08e-01
    Var ratio U=788.65  Var ratio X=8.82  Reduction=0.01x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/analytics/exp2_spectral_analysis_k30.json

================================================================================
EXP 8: k-SENSITIVITY ANALYSIS
================================================================================

     k    SGC+MLP      R+Std       R+RN     Part A     Part B    Rem.Gap     Fisher   n_runs
  -----------------------------------------------------------------------------------------------
     1     92.20%     88.81%     88.71%     +3.389     -0.107     +3.496    0.09731       75
     2     92.30%     89.17%     89.85%     +3.124     +0.673     +2.451    0.07508       75
     4     90.18%     88.72%     89.31%     +1.452     +0.581     +0.872    0.05832       75
     6     87.19%     89.27%     89.36%     -2.085     +0.082     -2.167    0.05142       75
     8     84.14%     89.43%     89.30%     -5.288     -0.127     -5.161    0.04746       75
    10     82.72%     89.40%     89.40%     -6.676     -0.004     -6.672    0.04493       75
    12     81.73%     89.55%     89.51%     -7.824     -0.042     -7.782    0.04322       75
    20     78.72%     89.70%     89.62%    -10.985     -0.083    -10.902    0.03995       75
    30     74.34%     89.84%     89.75%    -15.498     -0.091    -15.407    0.03868       75

  Saved JSON: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/analytics/exp8_k_sensitivity.json
  Saved CSV:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/analytics/exp8_k_sensitivity.csv

================================================================================
MASTER ANALYTICS COMPLETE
================================================================================
Analytics saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/amazon-computers_random_lcc/analytics
   amazon-computers complete  |  Sun Feb 22 11:24:34 PM EST 2026

--------------------------------------------------------
 DATASET: coauthor-cs  |  Sun Feb 22 11:24:34 PM EST 2026
--------------------------------------------------------
[1/2] Training: coauthor-cs fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER TRAINING EXPERIMENT
================================================================================
Dataset:      coauthor-cs
k values:     [1, 2, 4, 6, 8, 10, 12, 20, 30]
Split type:   fixed  (1 split(s) x 15 seeds)
Component:    lcc
Device:       cuda
Output base:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc
================================================================================

[Step 1] Loading dataset...
Creating 60/20/20 split for coauthor-cs...
Nodes: 18,333, Features: 6805, Classes: 15

[Step 2] Building graph matrices...

[Step 3] Extracting largest connected component...
Rebuilding graph matrices for LCC...
After step 3: nodes=18,333, classes=15, disconnected_components_to_skip=0

[Step 4] Preparing splits...
Fixed split: Train=10999, Val=3666, Test=3668

[Step 5] Computing SGC normalized adjacency...
A_sgc = D^{-1/2}(A+I)D^{-1/2}

================================================================================
K = 1
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/1 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=2.25e-10

  Aggregating results for k=1 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          93.27%     0.13%    15
  restricted_standard_mlp                                   82.48%     0.39%    15
  restricted_rownorm_mlp                                    80.93%     2.22%    15

  Framework Analysis (k=1):
    Part A (SGC+MLP - Restricted+Std): +10.792 pp
    Part B (RowNorm - Restricted+Std): -1.543 pp
    Remaining Gap:                     +12.336 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k1/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k1/diagnostics/fisher_diagnostic.json

================================================================================
K = 2
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/1 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.10e-10

  Aggregating results for k=2 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          92.85%     0.19%    15
  restricted_standard_mlp                                   78.82%     1.41%    15
  restricted_rownorm_mlp                                    78.91%     2.37%    15

  Framework Analysis (k=2):
    Part A (SGC+MLP - Restricted+Std): +14.031 pp
    Part B (RowNorm - Restricted+Std): +0.091 pp
    Remaining Gap:                     +13.940 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k2/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k2/diagnostics/fisher_diagnostic.json

================================================================================
K = 4
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/1 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.14e-10

  Aggregating results for k=4 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          91.84%     0.20%    15
  restricted_standard_mlp                                   79.70%     1.14%    15
  restricted_rownorm_mlp                                    74.99%     2.17%    15

  Framework Analysis (k=4):
    Part A (SGC+MLP - Restricted+Std): +12.143 pp
    Part B (RowNorm - Restricted+Std): -4.713 pp
    Remaining Gap:                     +16.856 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k4/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k4/diagnostics/fisher_diagnostic.json

================================================================================
K = 6
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/1 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.44e-10

  Aggregating results for k=6 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          91.27%     0.15%    15
  restricted_standard_mlp                                   78.28%     1.55%    15
  restricted_rownorm_mlp                                    72.78%     1.88%    15

  Framework Analysis (k=6):
    Part A (SGC+MLP - Restricted+Std): +12.999 pp
    Part B (RowNorm - Restricted+Std): -5.494 pp
    Remaining Gap:                     +18.493 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k6/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k6/diagnostics/fisher_diagnostic.json

================================================================================
K = 8
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/1 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.80e-10

  Aggregating results for k=8 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          91.05%     0.21%    15
  restricted_standard_mlp                                   77.32%     1.69%    15
  restricted_rownorm_mlp                                    71.74%     2.29%    15

  Framework Analysis (k=8):
    Part A (SGC+MLP - Restricted+Std): +13.720 pp
    Part B (RowNorm - Restricted+Std): -5.582 pp
    Remaining Gap:                     +19.302 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k8/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k8/diagnostics/fisher_diagnostic.json

================================================================================
K = 10
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/1 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.87e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k10/training_curves/split0_dynamics.json

  Aggregating results for k=10 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          90.83%     0.30%    15
  restricted_standard_mlp                                   77.77%     2.43%    15
  restricted_rownorm_mlp                                    72.68%     1.57%    15
  log_magnitude                                             70.31%     0.33%    15
  dual_stream                                               69.79%     0.50%    15
  spectral_rownorm_alpha-1.0                                87.59%     0.22%    15
  spectral_rownorm_alpha-0.5                                84.00%     0.33%    15
  spectral_rownorm_alpha0.0                                 70.44%     0.55%    15
  spectral_rownorm_alpha0.5                                 58.09%     0.74%    15
  spectral_rownorm_alpha1.0                                 61.57%     1.02%    15
  nested_spheres_a-1.0_b-1.0                                87.89%     0.28%    15
  nested_spheres_a-1.0_b-0.5                                87.72%     0.20%    15
  nested_spheres_a-1.0_b0.0                                 87.76%     0.18%    15
  nested_spheres_a-1.0_b0.5                                 87.97%     0.27%    15
  nested_spheres_a-1.0_b1.0                                 87.82%     0.21%    15
  nested_spheres_a-0.5_b-1.0                                83.98%     0.22%    15
  nested_spheres_a-0.5_b-0.5                                83.94%     0.28%    15
  nested_spheres_a-0.5_b0.0                                 83.92%     0.27%    15
  nested_spheres_a-0.5_b0.5                                 83.70%     0.32%    15
  nested_spheres_a-0.5_b1.0                                 83.72%     0.31%    15
  nested_spheres_a0.0_b-1.0                                 70.45%     0.37%    15
  nested_spheres_a0.0_b-0.5                                 70.52%     0.62%    15
  nested_spheres_a0.0_b0.0                                  70.47%     0.65%    15
  nested_spheres_a0.0_b0.5                                  70.56%     0.38%    15
  nested_spheres_a0.0_b1.0                                  70.31%     0.33%    15
  nested_spheres_a0.5_b-1.0                                 57.38%     0.77%    15
  nested_spheres_a0.5_b-0.5                                 57.73%     0.85%    15
  nested_spheres_a0.5_b0.0                                  58.69%     0.71%    15
  nested_spheres_a0.5_b0.5                                  57.77%     0.96%    15
  nested_spheres_a0.5_b1.0                                  57.14%     0.85%    15
  nested_spheres_a1.0_b-1.0                                 58.96%     1.17%    15
  nested_spheres_a1.0_b-0.5                                 61.39%     0.88%    15
  nested_spheres_a1.0_b0.0                                  62.16%     0.71%    15
  nested_spheres_a1.0_b0.5                                  60.87%     1.08%    15
  nested_spheres_a1.0_b1.0                                  59.28%     1.12%    15

  Framework Analysis (k=10):
    Part A (SGC+MLP - Restricted+Std): +13.063 pp
    Part B (RowNorm - Restricted+Std): -5.095 pp
    Remaining Gap:                     +18.157 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k10/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k10/diagnostics/fisher_diagnostic.json

================================================================================
K = 12
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/1 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.86e-10

  Aggregating results for k=12 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          90.59%     0.24%    15
  restricted_standard_mlp                                   77.14%     1.68%    15
  restricted_rownorm_mlp                                    71.17%     2.42%    15

  Framework Analysis (k=12):
    Part A (SGC+MLP - Restricted+Std): +13.448 pp
    Part B (RowNorm - Restricted+Std): -5.967 pp
    Remaining Gap:                     +19.415 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k12/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k12/diagnostics/fisher_diagnostic.json

================================================================================
K = 20
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/1 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6210, ortho_error=3.73e-10

  Aggregating results for k=20 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          89.85%     0.28%    15
  restricted_standard_mlp                                   78.88%     1.39%    15
  restricted_rownorm_mlp                                    72.17%     1.36%    15

  Framework Analysis (k=20):
    Part A (SGC+MLP - Restricted+Std): +10.972 pp
    Part B (RowNorm - Restricted+Std): -6.708 pp
    Remaining Gap:                     +17.681 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k20/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k20/diagnostics/fisher_diagnostic.json

================================================================================
K = 30
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/1 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=4117, ortho_error=3.40e-10

  Aggregating results for k=30 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          88.74%     0.28%    15
  restricted_standard_mlp                                   83.02%     0.61%    15
  restricted_rownorm_mlp                                    80.67%     0.60%    15

  Framework Analysis (k=30):
    Part A (SGC+MLP - Restricted+Std): +5.712 pp
    Part B (RowNorm - Restricted+Std): -2.354 pp
    Remaining Gap:                     +8.066 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k30/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/k30/diagnostics/fisher_diagnostic.json

================================================================================
MASTER TRAINING EXPERIMENT COMPLETE
================================================================================
Results saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc
[2/2] Analytics: coauthor-cs fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER ANALYTICS (Exp 2 + Exp 8)
================================================================================
Dataset:       coauthor-cs
Split type:    fixed
Component:     lcc
k values:      [1, 2, 4, 6, 8, 10, 12, 20, 30]
Results dir:   /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc
================================================================================

[Step 1] Loading dataset and graph...
Creating 60/20/20 split for coauthor-cs...
Nodes: 18,333, Features: 6805, Classes: 15

[Step 2] Extracting LCC...
After LCC: nodes=18,333, classes=15

================================================================================
EXP 2: SPECTRAL ANALYSIS (all k values)
================================================================================

  k=1:
    WARNING: no cached matrices found, recomputing...
    d_effective=6803, ortho_error=2.2490143081199676e-10
    Condition U=12.0217  Condition X=inf  Separability=0.0660  SpanErr=8.21e-02
    Var ratio U=8.64  Var ratio X=2446.68  Reduction=283.25x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/analytics/exp2_spectral_analysis_k1.json

  k=2:
    WARNING: no cached matrices found, recomputing...
    d_effective=6803, ortho_error=3.1008839940227517e-10
    Condition U=30.2190  Condition X=inf  Separability=0.0662  SpanErr=9.75e-02
    Var ratio U=12.38  Var ratio X=5355.36  Reduction=432.42x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/analytics/exp2_spectral_analysis_k2.json

  k=4:
    WARNING: no cached matrices found, recomputing...
    d_effective=6803, ortho_error=3.1386182541837115e-10
    Condition U=206.0248  Condition X=inf  Separability=0.0660  SpanErr=1.26e-01
    Var ratio U=58.57  Var ratio X=14494.69  Reduction=247.46x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/analytics/exp2_spectral_analysis_k4.json

  k=6:
    WARNING: no cached matrices found, recomputing...
    d_effective=6803, ortho_error=3.4363212275678734e-10
    Condition U=320.8418  Condition X=inf  Separability=0.0660  SpanErr=1.48e-01
    Var ratio U=24.38  Var ratio X=28674.57  Reduction=1176.17x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/analytics/exp2_spectral_analysis_k6.json

  k=8:
    WARNING: no cached matrices found, recomputing...
    d_effective=6803, ortho_error=3.800301184853083e-10
    Condition U=355.3247  Condition X=inf  Separability=0.0660  SpanErr=1.66e-01
    Var ratio U=30.29  Var ratio X=54682.88  Reduction=1805.43x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/analytics/exp2_spectral_analysis_k8.json

  k=10:
    WARNING: no cached matrices found, recomputing...
    d_effective=6803, ortho_error=3.8698544368998e-10
    Condition U=440.9186  Condition X=inf  Separability=0.0660  SpanErr=1.83e-01
    Var ratio U=32.37  Var ratio X=89011.88  Reduction=2749.92x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/analytics/exp2_spectral_analysis_k10.json

  k=12:
    WARNING: no cached matrices found, recomputing...
    d_effective=6803, ortho_error=3.8640124433442224e-10
    Condition U=1266.9309  Condition X=inf  Separability=0.0660  SpanErr=1.99e-01
    Var ratio U=100.16  Var ratio X=128973.87  Reduction=1287.66x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/analytics/exp2_spectral_analysis_k12.json

  k=20:
    WARNING: no cached matrices found, recomputing...
    d_effective=6210, ortho_error=3.7297853694440164e-10
    Condition U=19467.1528  Condition X=inf  Separability=0.0678  SpanErr=2.77e-01
    Var ratio U=306.20  Var ratio X=372638.14  Reduction=1216.99x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/analytics/exp2_spectral_analysis_k20.json

  k=30:
    WARNING: no cached matrices found, recomputing...
    d_effective=4117, ortho_error=3.4034686180461904e-10
    Condition U=144.2469  Condition X=inf  Separability=0.0794  SpanErr=4.25e-01
    Var ratio U=25.07  Var ratio X=535196.42  Reduction=21350.97x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/analytics/exp2_spectral_analysis_k30.json

================================================================================
EXP 8: k-SENSITIVITY ANALYSIS
================================================================================

     k    SGC+MLP      R+Std       R+RN     Part A     Part B    Rem.Gap     Fisher   n_runs
  -----------------------------------------------------------------------------------------------
     1     93.27%     82.48%     80.93%    +10.792     -1.543    +12.335    0.25822       15
     2     92.85%     78.82%     78.91%    +14.031     +0.091    +13.940    0.24541       15
     4     91.84%     79.70%     74.99%    +12.143     -4.713    +16.856    0.21566       15
     6     91.27%     78.28%     72.78%    +12.999     -5.494    +18.493    0.21326       15
     8     91.05%     77.32%     71.74%    +13.720     -5.582    +19.302    0.21402       15
    10     90.83%     77.77%     72.68%    +13.062     -5.095    +18.157    0.21498       15
    12     90.59%     77.14%     71.17%    +13.448     -5.967    +19.415    0.21580       15
    20     89.85%     78.88%     72.17%    +10.972     -6.708    +17.681    0.22570       15
    30     88.73%     83.02%     80.67%     +5.713     -2.354     +8.066    0.23961       15

  Saved JSON: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/analytics/exp8_k_sensitivity.json
  Saved CSV:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/analytics/exp8_k_sensitivity.csv

================================================================================
MASTER ANALYTICS COMPLETE
================================================================================
Analytics saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_fixed_lcc/analytics
[1/2] Training: coauthor-cs random
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER TRAINING EXPERIMENT
================================================================================
Dataset:      coauthor-cs
k values:     [1, 2, 4, 6, 8, 10, 12, 20, 30]
Split type:   random  (5 split(s) x 15 seeds)
Component:    lcc
Device:       cuda
Output base:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc
================================================================================

[Step 1] Loading dataset...
Creating 60/20/20 split for coauthor-cs...
Nodes: 18,333, Features: 6805, Classes: 15

[Step 2] Building graph matrices...

[Step 3] Extracting largest connected component...
Rebuilding graph matrices for LCC...
After step 3: nodes=18,333, classes=15, disconnected_components_to_skip=0

[Step 4] Preparing splits...
Random split 0: Train=10999, Val=3666, Test=3668
Random split 1: Train=10999, Val=3666, Test=3668
Random split 2: Train=10999, Val=3666, Test=3668
Random split 3: Train=10999, Val=3666, Test=3668
Random split 4: Train=10999, Val=3666, Test=3668

[Step 5] Computing SGC normalized adjacency...
A_sgc = D^{-1/2}(A+I)D^{-1/2}

================================================================================
K = 1
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=2.25e-10

  --- Split 2/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=2.25e-10

  --- Split 3/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=2.25e-10

  --- Split 4/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=2.25e-10

  --- Split 5/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=2.25e-10

  Aggregating results for k=1 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          93.16%     0.34%    75
  restricted_standard_mlp                                   81.23%     1.73%    75
  restricted_rownorm_mlp                                    80.86%     1.95%    75

  Framework Analysis (k=1):
    Part A (SGC+MLP - Restricted+Std): +11.933 pp
    Part B (RowNorm - Restricted+Std): -0.370 pp
    Remaining Gap:                     +12.304 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k1/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k1/diagnostics/fisher_diagnostic.json

================================================================================
K = 2
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.10e-10

  --- Split 2/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.10e-10

  --- Split 3/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.10e-10

  --- Split 4/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.10e-10

  --- Split 5/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.10e-10

  Aggregating results for k=2 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          92.64%     0.41%    75
  restricted_standard_mlp                                   77.37%     2.67%    75
  restricted_rownorm_mlp                                    78.51%     2.07%    75

  Framework Analysis (k=2):
    Part A (SGC+MLP - Restricted+Std): +15.273 pp
    Part B (RowNorm - Restricted+Std): +1.139 pp
    Remaining Gap:                     +14.134 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k2/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k2/diagnostics/fisher_diagnostic.json

================================================================================
K = 4
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.14e-10

  --- Split 2/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.14e-10

  --- Split 3/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.14e-10

  --- Split 4/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.14e-10

  --- Split 5/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.14e-10

  Aggregating results for k=4 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          91.63%     0.47%    75
  restricted_standard_mlp                                   77.46%     2.35%    75
  restricted_rownorm_mlp                                    74.15%     2.60%    75

  Framework Analysis (k=4):
    Part A (SGC+MLP - Restricted+Std): +14.166 pp
    Part B (RowNorm - Restricted+Std): -3.316 pp
    Remaining Gap:                     +17.482 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k4/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k4/diagnostics/fisher_diagnostic.json

================================================================================
K = 6
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.44e-10

  --- Split 2/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.44e-10

  --- Split 3/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.44e-10

  --- Split 4/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.44e-10

  --- Split 5/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.44e-10

  Aggregating results for k=6 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          91.17%     0.41%    75
  restricted_standard_mlp                                   77.39%     2.12%    75
  restricted_rownorm_mlp                                    72.96%     2.17%    75

  Framework Analysis (k=6):
    Part A (SGC+MLP - Restricted+Std): +13.784 pp
    Part B (RowNorm - Restricted+Std): -4.433 pp
    Remaining Gap:                     +18.217 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k6/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k6/diagnostics/fisher_diagnostic.json

================================================================================
K = 8
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.80e-10

  --- Split 2/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.80e-10

  --- Split 3/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.80e-10

  --- Split 4/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.80e-10

  --- Split 5/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.80e-10

  Aggregating results for k=8 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          90.77%     0.42%    75
  restricted_standard_mlp                                   77.42%     2.49%    75
  restricted_rownorm_mlp                                    72.42%     2.35%    75

  Framework Analysis (k=8):
    Part A (SGC+MLP - Restricted+Std): +13.357 pp
    Part B (RowNorm - Restricted+Std): -4.995 pp
    Remaining Gap:                     +18.352 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k8/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k8/diagnostics/fisher_diagnostic.json

================================================================================
K = 10
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.87e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k10/training_curves/split0_dynamics.json

  --- Split 2/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.87e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k10/training_curves/split1_dynamics.json

  --- Split 3/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.87e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k10/training_curves/split2_dynamics.json

  --- Split 4/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.87e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k10/training_curves/split3_dynamics.json

  --- Split 5/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.87e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k10/training_curves/split4_dynamics.json

  Aggregating results for k=10 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          90.50%     0.40%    75
  restricted_standard_mlp                                   77.48%     2.02%    75
  restricted_rownorm_mlp                                    71.96%     2.32%    75
  log_magnitude                                             70.65%     0.49%    75
  dual_stream                                               70.15%     0.62%    75
  spectral_rownorm_alpha-1.0                                87.04%     0.56%    75
  spectral_rownorm_alpha-0.5                                82.96%     0.58%    75
  spectral_rownorm_alpha0.0                                 70.79%     0.64%    75
  spectral_rownorm_alpha0.5                                 57.83%     1.04%    75
  spectral_rownorm_alpha1.0                                 61.81%     0.98%    75
  nested_spheres_a-1.0_b-1.0                                87.19%     0.56%    75
  nested_spheres_a-1.0_b-0.5                                87.10%     0.54%    75
  nested_spheres_a-1.0_b0.0                                 87.13%     0.53%    75
  nested_spheres_a-1.0_b0.5                                 87.13%     0.53%    75
  nested_spheres_a-1.0_b1.0                                 87.14%     0.55%    75
  nested_spheres_a-0.5_b-1.0                                83.00%     0.57%    75
  nested_spheres_a-0.5_b-0.5                                83.01%     0.55%    75
  nested_spheres_a-0.5_b0.0                                 82.95%     0.64%    75
  nested_spheres_a-0.5_b0.5                                 82.96%     0.56%    75
  nested_spheres_a-0.5_b1.0                                 82.96%     0.56%    75
  nested_spheres_a0.0_b-1.0                                 70.65%     0.66%    75
  nested_spheres_a0.0_b-0.5                                 70.84%     0.61%    75
  nested_spheres_a0.0_b0.0                                  70.93%     0.56%    75
  nested_spheres_a0.0_b0.5                                  70.69%     0.61%    75
  nested_spheres_a0.0_b1.0                                  70.65%     0.49%    75
  nested_spheres_a0.5_b-1.0                                 56.59%     1.06%    75
  nested_spheres_a0.5_b-0.5                                 57.30%     0.97%    75
  nested_spheres_a0.5_b0.0                                  58.19%     0.98%    75
  nested_spheres_a0.5_b0.5                                  57.31%     0.88%    75
  nested_spheres_a0.5_b1.0                                  56.53%     1.07%    75
  nested_spheres_a1.0_b-1.0                                 58.63%     1.52%    75
  nested_spheres_a1.0_b-0.5                                 60.83%     1.09%    75
  nested_spheres_a1.0_b0.0                                  62.19%     0.93%    75
  nested_spheres_a1.0_b0.5                                  60.90%     1.13%    75
  nested_spheres_a1.0_b1.0                                  58.60%     1.36%    75

  Framework Analysis (k=10):
    Part A (SGC+MLP - Restricted+Std): +13.027 pp
    Part B (RowNorm - Restricted+Std): -5.518 pp
    Remaining Gap:                     +18.545 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k10/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k10/diagnostics/fisher_diagnostic.json

================================================================================
K = 12
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.86e-10

  --- Split 2/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.86e-10

  --- Split 3/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.86e-10

  --- Split 4/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.86e-10

  --- Split 5/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6803, ortho_error=3.86e-10

  Aggregating results for k=12 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          90.29%     0.44%    75
  restricted_standard_mlp                                   77.81%     2.13%    75
  restricted_rownorm_mlp                                    71.45%     2.21%    75

  Framework Analysis (k=12):
    Part A (SGC+MLP - Restricted+Std): +12.478 pp
    Part B (RowNorm - Restricted+Std): -6.359 pp
    Remaining Gap:                     +18.836 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k12/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k12/diagnostics/fisher_diagnostic.json

================================================================================
K = 20
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6210, ortho_error=3.73e-10

  --- Split 2/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6210, ortho_error=3.73e-10

  --- Split 3/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6210, ortho_error=3.73e-10

  --- Split 4/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6210, ortho_error=3.73e-10

  --- Split 5/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=6210, ortho_error=3.73e-10

  Aggregating results for k=20 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          89.70%     0.47%    75
  restricted_standard_mlp                                   77.79%     1.69%    75
  restricted_rownorm_mlp                                    72.59%     1.83%    75

  Framework Analysis (k=20):
    Part A (SGC+MLP - Restricted+Std): +11.904 pp
    Part B (RowNorm - Restricted+Std): -5.201 pp
    Remaining Gap:                     +17.105 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k20/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k20/diagnostics/fisher_diagnostic.json

================================================================================
K = 30
================================================================================
  X_diffused shape: (18333, 6805)

  --- Split 1/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=4117, ortho_error=3.40e-10

  --- Split 2/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=4117, ortho_error=3.40e-10

  --- Split 3/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=4117, ortho_error=3.40e-10

  --- Split 4/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=4117, ortho_error=3.40e-10

  --- Split 5/5 (train=10999, val=3666, test=3668) ---
  Computing restricted eigenvectors...
  d_effective=4117, ortho_error=3.40e-10

  Aggregating results for k=30 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          88.52%     0.58%    75
  restricted_standard_mlp                                   82.54%     0.57%    75
  restricted_rownorm_mlp                                    80.31%     0.59%    75

  Framework Analysis (k=30):
    Part A (SGC+MLP - Restricted+Std): +5.975 pp
    Part B (RowNorm - Restricted+Std): -2.234 pp
    Remaining Gap:                     +8.209 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k30/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/k30/diagnostics/fisher_diagnostic.json

================================================================================
MASTER TRAINING EXPERIMENT COMPLETE
================================================================================
Results saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc
[2/2] Analytics: coauthor-cs random
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER ANALYTICS (Exp 2 + Exp 8)
================================================================================
Dataset:       coauthor-cs
Split type:    random
Component:     lcc
k values:      [1, 2, 4, 6, 8, 10, 12, 20, 30]
Results dir:   /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc
================================================================================

[Step 1] Loading dataset and graph...
Creating 60/20/20 split for coauthor-cs...
Nodes: 18,333, Features: 6805, Classes: 15

[Step 2] Extracting LCC...
After LCC: nodes=18,333, classes=15

================================================================================
EXP 2: SPECTRAL ANALYSIS (all k values)
================================================================================

  k=1:
    WARNING: no cached matrices found, recomputing...
    d_effective=6803, ortho_error=2.2490143081199676e-10
    Condition U=12.7108  Condition X=inf  Separability=0.0664  SpanErr=8.19e-02
    Var ratio U=7.84  Var ratio X=6681.17  Reduction=851.79x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/analytics/exp2_spectral_analysis_k1.json

  k=2:
    WARNING: no cached matrices found, recomputing...
    d_effective=6803, ortho_error=3.1008839940227517e-10
    Condition U=35.5559  Condition X=inf  Separability=0.0668  SpanErr=9.67e-02
    Var ratio U=12.64  Var ratio X=19795.42  Reduction=1565.90x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/analytics/exp2_spectral_analysis_k2.json

  k=4:
    WARNING: no cached matrices found, recomputing...
    d_effective=6803, ortho_error=3.1386182541837115e-10
    Condition U=163.6497  Condition X=inf  Separability=0.0666  SpanErr=1.25e-01
    Var ratio U=16.47  Var ratio X=35514.13  Reduction=2156.60x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/analytics/exp2_spectral_analysis_k4.json

  k=6:
    WARNING: no cached matrices found, recomputing...
    d_effective=6803, ortho_error=3.4363212275678734e-10
    Condition U=918.6495  Condition X=inf  Separability=0.0666  SpanErr=1.46e-01
    Var ratio U=21.48  Var ratio X=50304.60  Reduction=2342.02x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/analytics/exp2_spectral_analysis_k6.json

  k=8:
    WARNING: no cached matrices found, recomputing...
    d_effective=6803, ortho_error=3.800301184853083e-10
    Condition U=1941.2540  Condition X=inf  Separability=0.0666  SpanErr=1.64e-01
    Var ratio U=27.71  Var ratio X=66714.67  Reduction=2407.47x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/analytics/exp2_spectral_analysis_k8.json

  k=10:
    WARNING: no cached matrices found, recomputing...
    d_effective=6803, ortho_error=3.8698544368998e-10
    Condition U=2545.8148  Condition X=inf  Separability=0.0666  SpanErr=1.81e-01
    Var ratio U=39.02  Var ratio X=109592.03  Reduction=2808.54x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/analytics/exp2_spectral_analysis_k10.json

  k=12:
    WARNING: no cached matrices found, recomputing...
    d_effective=6803, ortho_error=3.8640124433442224e-10
    Condition U=3323.5092  Condition X=inf  Separability=0.0665  SpanErr=1.96e-01
    Var ratio U=52.38  Var ratio X=157815.25  Reduction=3013.08x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/analytics/exp2_spectral_analysis_k12.json

  k=20:
    WARNING: no cached matrices found, recomputing...
    d_effective=6210, ortho_error=3.7297853694440164e-10
    Condition U=26084.5352  Condition X=inf  Separability=0.0684  SpanErr=2.73e-01
    Var ratio U=227.01  Var ratio X=350315.27  Reduction=1543.20x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/analytics/exp2_spectral_analysis_k20.json

  k=30:
    WARNING: no cached matrices found, recomputing...
    d_effective=4117, ortho_error=3.4034686180461904e-10
    Condition U=821.5112  Condition X=inf  Separability=0.0796  SpanErr=4.22e-01
    Var ratio U=327.58  Var ratio X=526991.29  Reduction=1608.75x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/analytics/exp2_spectral_analysis_k30.json

================================================================================
EXP 8: k-SENSITIVITY ANALYSIS
================================================================================

     k    SGC+MLP      R+Std       R+RN     Part A     Part B    Rem.Gap     Fisher   n_runs
  -----------------------------------------------------------------------------------------------
     1     93.16%     81.23%     80.86%    +11.934     -0.370    +12.303    0.25549       75
     2     92.64%     77.37%     78.51%    +15.273     +1.139    +14.134    0.23688       75
     4     91.63%     77.46%     74.15%    +14.166     -3.316    +17.482    0.20563       75
     6     91.17%     77.39%     72.96%    +13.784     -4.433    +18.217    0.20225       75
     8     90.77%     77.42%     72.42%    +13.357     -4.995    +18.352    0.20255       75
    10     90.50%     77.48%     71.96%    +13.027     -5.518    +18.545    0.20329       75
    12     90.29%     77.81%     71.45%    +12.478     -6.359    +18.836    0.20399       75
    20     89.70%     77.79%     72.59%    +11.904     -5.201    +17.105    0.21227       75
    30     88.52%     82.54%     80.31%     +5.975     -2.234     +8.209    0.22766       75

  Saved JSON: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/analytics/exp8_k_sensitivity.json
  Saved CSV:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/analytics/exp8_k_sensitivity.csv

================================================================================
MASTER ANALYTICS COMPLETE
================================================================================
Analytics saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-cs_random_lcc/analytics
   coauthor-cs complete  |  Mon Feb 23 06:17:05 AM EST 2026

--------------------------------------------------------
 DATASET: pubmed  |  Mon Feb 23 06:17:05 AM EST 2026
--------------------------------------------------------
[1/2] Training: pubmed fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER TRAINING EXPERIMENT
================================================================================
Dataset:      pubmed
k values:     [1, 2, 4, 6, 8, 10, 12, 20, 30]
Split type:   fixed  (1 split(s) x 15 seeds)
Component:    lcc
Device:       cuda
Output base:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc
================================================================================

[Step 1] Loading dataset...
Nodes: 19,717, Features: 500, Classes: 3

[Step 2] Building graph matrices...

[Step 3] Extracting largest connected component...
Rebuilding graph matrices for LCC...
After step 3: nodes=19,717, classes=3, disconnected_components_to_skip=0

[Step 4] Preparing splits...
Fixed split: Train=60, Val=500, Test=1000

[Step 5] Computing SGC normalized adjacency...
A_sgc = D^{-1/2}(A+I)D^{-1/2}

================================================================================
K = 1
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/1 (train=60, val=500, test=1000) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.28e-10

  Aggregating results for k=1 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          68.69%     0.92%    15
  restricted_standard_mlp                                   42.31%     1.45%    15
  restricted_rownorm_mlp                                    42.35%     1.27%    15

  Framework Analysis (k=1):
    Part A (SGC+MLP - Restricted+Std): +26.387 pp
    Part B (RowNorm - Restricted+Std): +0.040 pp
    Remaining Gap:                     +26.347 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k1/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k1/diagnostics/fisher_diagnostic.json

================================================================================
K = 2
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/1 (train=60, val=500, test=1000) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.23e-10

  Aggregating results for k=2 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          73.52%     1.76%    15
  restricted_standard_mlp                                   46.55%     0.86%    15
  restricted_rownorm_mlp                                    45.73%     1.71%    15

  Framework Analysis (k=2):
    Part A (SGC+MLP - Restricted+Std): +26.967 pp
    Part B (RowNorm - Restricted+Std): -0.820 pp
    Remaining Gap:                     +27.787 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k2/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k2/diagnostics/fisher_diagnostic.json

================================================================================
K = 4
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/1 (train=60, val=500, test=1000) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.53e-10

  Aggregating results for k=4 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          74.93%     1.48%    15
  restricted_standard_mlp                                   45.27%     1.29%    15
  restricted_rownorm_mlp                                    44.39%     1.59%    15

  Framework Analysis (k=4):
    Part A (SGC+MLP - Restricted+Std): +29.653 pp
    Part B (RowNorm - Restricted+Std): -0.880 pp
    Remaining Gap:                     +30.533 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k4/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k4/diagnostics/fisher_diagnostic.json

================================================================================
K = 6
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/1 (train=60, val=500, test=1000) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.75e-10

  Aggregating results for k=6 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          74.46%     1.49%    15
  restricted_standard_mlp                                   47.05%     1.04%    15
  restricted_rownorm_mlp                                    46.42%     1.70%    15

  Framework Analysis (k=6):
    Part A (SGC+MLP - Restricted+Std): +27.413 pp
    Part B (RowNorm - Restricted+Std): -0.627 pp
    Remaining Gap:                     +28.040 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k6/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k6/diagnostics/fisher_diagnostic.json

================================================================================
K = 8
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/1 (train=60, val=500, test=1000) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.83e-10

  Aggregating results for k=8 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          74.94%     1.35%    15
  restricted_standard_mlp                                   46.90%     1.38%    15
  restricted_rownorm_mlp                                    46.26%     1.62%    15

  Framework Analysis (k=8):
    Part A (SGC+MLP - Restricted+Std): +28.040 pp
    Part B (RowNorm - Restricted+Std): -0.640 pp
    Remaining Gap:                     +28.680 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k8/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k8/diagnostics/fisher_diagnostic.json

================================================================================
K = 10
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/1 (train=60, val=500, test=1000) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.93e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k10/training_curves/split0_dynamics.json

  Aggregating results for k=10 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          75.16%     1.29%    15
  restricted_standard_mlp                                   47.59%     0.65%    15
  restricted_rownorm_mlp                                    47.72%     2.28%    15
  log_magnitude                                             48.79%     1.75%    15
  dual_stream                                               47.96%     1.03%    15
  spectral_rownorm_alpha-1.0                                51.83%     1.30%    15
  spectral_rownorm_alpha-0.5                                50.06%     1.78%    15
  spectral_rownorm_alpha0.0                                 48.36%     1.14%    15
  spectral_rownorm_alpha0.5                                 46.19%     1.62%    15
  spectral_rownorm_alpha1.0                                 44.63%     1.99%    15
  nested_spheres_a-1.0_b-1.0                                52.52%     1.30%    15
  nested_spheres_a-1.0_b-0.5                                51.92%     0.88%    15
  nested_spheres_a-1.0_b0.0                                 51.03%     1.55%    15
  nested_spheres_a-1.0_b0.5                                 52.75%     1.56%    15
  nested_spheres_a-1.0_b1.0                                 51.91%     1.70%    15
  nested_spheres_a-0.5_b-1.0                                51.13%     1.87%    15
  nested_spheres_a-0.5_b-0.5                                50.57%     1.28%    15
  nested_spheres_a-0.5_b0.0                                 49.91%     1.58%    15
  nested_spheres_a-0.5_b0.5                                 50.24%     1.44%    15
  nested_spheres_a-0.5_b1.0                                 49.97%     1.34%    15
  nested_spheres_a0.0_b-1.0                                 48.24%     1.73%    15
  nested_spheres_a0.0_b-0.5                                 48.23%     1.44%    15
  nested_spheres_a0.0_b0.0                                  47.05%     1.63%    15
  nested_spheres_a0.0_b0.5                                  48.11%     1.70%    15
  nested_spheres_a0.0_b1.0                                  48.79%     1.75%    15
  nested_spheres_a0.5_b-1.0                                 46.73%     1.52%    15
  nested_spheres_a0.5_b-0.5                                 46.87%     1.66%    15
  nested_spheres_a0.5_b0.0                                  45.38%     1.32%    15
  nested_spheres_a0.5_b0.5                                  46.59%     1.64%    15
  nested_spheres_a0.5_b1.0                                  46.58%     1.79%    15
  nested_spheres_a1.0_b-1.0                                 44.59%     1.15%    15
  nested_spheres_a1.0_b-0.5                                 44.78%     1.45%    15
  nested_spheres_a1.0_b0.0                                  44.15%     2.01%    15
  nested_spheres_a1.0_b0.5                                  44.83%     1.21%    15
  nested_spheres_a1.0_b1.0                                  44.58%     1.20%    15

  Framework Analysis (k=10):
    Part A (SGC+MLP - Restricted+Std): +27.567 pp
    Part B (RowNorm - Restricted+Std): +0.127 pp
    Remaining Gap:                     +27.440 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k10/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k10/diagnostics/fisher_diagnostic.json

================================================================================
K = 12
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/1 (train=60, val=500, test=1000) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.90e-10

  Aggregating results for k=12 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          75.95%     1.51%    15
  restricted_standard_mlp                                   47.85%     0.68%    15
  restricted_rownorm_mlp                                    47.69%     1.83%    15

  Framework Analysis (k=12):
    Part A (SGC+MLP - Restricted+Std): +28.100 pp
    Part B (RowNorm - Restricted+Std): -0.160 pp
    Remaining Gap:                     +28.260 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k12/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k12/diagnostics/fisher_diagnostic.json

================================================================================
K = 20
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/1 (train=60, val=500, test=1000) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=2.07e-10

  Aggregating results for k=20 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          75.57%     1.04%    15
  restricted_standard_mlp                                   48.23%     1.68%    15
  restricted_rownorm_mlp                                    50.93%     1.33%    15

  Framework Analysis (k=20):
    Part A (SGC+MLP - Restricted+Std): +27.333 pp
    Part B (RowNorm - Restricted+Std): +2.693 pp
    Remaining Gap:                     +24.640 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k20/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k20/diagnostics/fisher_diagnostic.json

================================================================================
K = 30
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/1 (train=60, val=500, test=1000) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=2.09e-10

  Aggregating results for k=30 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          75.53%     1.09%    15
  restricted_standard_mlp                                   50.04%     1.54%    15
  restricted_rownorm_mlp                                    52.18%     2.04%    15

  Framework Analysis (k=30):
    Part A (SGC+MLP - Restricted+Std): +25.493 pp
    Part B (RowNorm - Restricted+Std): +2.140 pp
    Remaining Gap:                     +23.353 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k30/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/k30/diagnostics/fisher_diagnostic.json

================================================================================
MASTER TRAINING EXPERIMENT COMPLETE
================================================================================
Results saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc
[2/2] Analytics: pubmed fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER ANALYTICS (Exp 2 + Exp 8)
================================================================================
Dataset:       pubmed
Split type:    fixed
Component:     lcc
k values:      [1, 2, 4, 6, 8, 10, 12, 20, 30]
Results dir:   /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc
================================================================================

[Step 1] Loading dataset and graph...
Nodes: 19,717, Features: 500, Classes: 3

[Step 2] Extracting LCC...
After LCC: nodes=19,717, classes=3

================================================================================
EXP 2: SPECTRAL ANALYSIS (all k values)
================================================================================

  k=1:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=1.2808332172653536e-10
    Condition U=4.7846  Condition X=15.8755  Separability=0.2297  SpanErr=1.87e-15
    Var ratio U=8.15  Var ratio X=3055.54  Reduction=375.02x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/analytics/exp2_spectral_analysis_k1.json

  k=2:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=1.2347300959447693e-10
    Condition U=6.4321  Condition X=20.1957  Separability=0.2323  SpanErr=1.75e-15
    Var ratio U=12.95  Var ratio X=1655.03  Reduction=127.82x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/analytics/exp2_spectral_analysis_k2.json

  k=4:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=1.5269252529037658e-10
    Condition U=9.2625  Condition X=38.5033  Separability=0.2364  SpanErr=1.86e-15
    Var ratio U=48.30  Var ratio X=2501.46  Reduction=51.79x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/analytics/exp2_spectral_analysis_k4.json

  k=6:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=1.7536239127480258e-10
    Condition U=11.9104  Condition X=71.3901  Separability=0.2397  SpanErr=1.98e-15
    Var ratio U=49.38  Var ratio X=2800.27  Reduction=56.71x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/analytics/exp2_spectral_analysis_k6.json

  k=8:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=1.827447082547451e-10
    Condition U=18.5791  Condition X=137.4262  Separability=0.2419  SpanErr=1.97e-15
    Var ratio U=59.69  Var ratio X=2788.38  Reduction=46.72x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/analytics/exp2_spectral_analysis_k8.json

  k=10:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=1.9289214669981902e-10
    Condition U=27.9445  Condition X=250.5753  Separability=0.2434  SpanErr=2.31e-15
    Var ratio U=170.52  Var ratio X=2695.30  Reduction=15.81x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/analytics/exp2_spectral_analysis_k10.json

  k=12:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=1.899543855543584e-10
    Condition U=39.6165  Condition X=437.2974  Separability=0.2449  SpanErr=2.24e-15
    Var ratio U=214.00  Var ratio X=2495.12  Reduction=11.66x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/analytics/exp2_spectral_analysis_k12.json

  k=20:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=2.0747326079373352e-10
    Condition U=99.2163  Condition X=2716.6208  Separability=0.2497  SpanErr=5.35e-15
    Var ratio U=771.76  Var ratio X=2011.94  Reduction=2.61x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/analytics/exp2_spectral_analysis_k20.json

  k=30:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=2.0932788835636984e-10
    Condition U=190.1400  Condition X=10668.1826  Separability=0.2528  SpanErr=3.83e-15
    Var ratio U=4889.14  Var ratio X=1484.23  Reduction=0.30x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/analytics/exp2_spectral_analysis_k30.json

================================================================================
EXP 8: k-SENSITIVITY ANALYSIS
================================================================================

     k    SGC+MLP      R+Std       R+RN     Part A     Part B    Rem.Gap     Fisher   n_runs
  -----------------------------------------------------------------------------------------------
     1     68.69%     42.31%     42.35%    +26.387     +0.040    +26.347    0.00668       15
     2     73.52%     46.55%     45.73%    +26.967     -0.820    +27.787    0.00979       15
     4     74.93%     45.27%     44.39%    +29.653     -0.880    +30.533    0.01649       15
     6     74.46%     47.05%     46.42%    +27.413     -0.627    +28.040    0.02259       15
     8     74.94%     46.90%     46.26%    +28.040     -0.640    +28.680    0.02642       15
    10     75.16%     47.59%     47.72%    +27.567     +0.127    +27.440    0.02931       15
    12     75.95%     47.85%     47.69%    +28.100     -0.160    +28.260    0.03170       15
    20     75.57%     48.23%     50.93%    +27.333     +2.693    +24.640    0.03766       15
    30     75.53%     50.04%     52.18%    +25.493     +2.140    +23.353    0.04011       15

  Saved JSON: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/analytics/exp8_k_sensitivity.json
  Saved CSV:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/analytics/exp8_k_sensitivity.csv

================================================================================
MASTER ANALYTICS COMPLETE
================================================================================
Analytics saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_fixed_lcc/analytics
[1/2] Training: pubmed random
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER TRAINING EXPERIMENT
================================================================================
Dataset:      pubmed
k values:     [1, 2, 4, 6, 8, 10, 12, 20, 30]
Split type:   random  (5 split(s) x 15 seeds)
Component:    lcc
Device:       cuda
Output base:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc
================================================================================

[Step 1] Loading dataset...
Nodes: 19,717, Features: 500, Classes: 3

[Step 2] Building graph matrices...

[Step 3] Extracting largest connected component...
Rebuilding graph matrices for LCC...
After step 3: nodes=19,717, classes=3, disconnected_components_to_skip=0

[Step 4] Preparing splits...
Random split 0: Train=11830, Val=3943, Test=3944
Random split 1: Train=11830, Val=3943, Test=3944
Random split 2: Train=11830, Val=3943, Test=3944
Random split 3: Train=11830, Val=3943, Test=3944
Random split 4: Train=11830, Val=3943, Test=3944

[Step 5] Computing SGC normalized adjacency...
A_sgc = D^{-1/2}(A+I)D^{-1/2}

================================================================================
K = 1
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.28e-10

  --- Split 2/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.28e-10

  --- Split 3/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.28e-10

  --- Split 4/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.28e-10

  --- Split 5/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.28e-10

  Aggregating results for k=1 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          87.47%     0.53%    75
  restricted_standard_mlp                                   86.65%     0.53%    75
  restricted_rownorm_mlp                                    86.14%     0.51%    75

  Framework Analysis (k=1):
    Part A (SGC+MLP - Restricted+Std): +0.820 pp
    Part B (RowNorm - Restricted+Std): -0.503 pp
    Remaining Gap:                     +1.323 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k1/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k1/diagnostics/fisher_diagnostic.json

================================================================================
K = 2
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.23e-10

  --- Split 2/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.23e-10

  --- Split 3/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.23e-10

  --- Split 4/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.23e-10

  --- Split 5/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.23e-10

  Aggregating results for k=2 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          87.41%     0.45%    75
  restricted_standard_mlp                                   86.42%     0.54%    75
  restricted_rownorm_mlp                                    86.72%     0.59%    75

  Framework Analysis (k=2):
    Part A (SGC+MLP - Restricted+Std): +0.987 pp
    Part B (RowNorm - Restricted+Std): +0.293 pp
    Remaining Gap:                     +0.693 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k2/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k2/diagnostics/fisher_diagnostic.json

================================================================================
K = 4
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.53e-10

  --- Split 2/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.53e-10

  --- Split 3/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.53e-10

  --- Split 4/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.53e-10

  --- Split 5/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.53e-10

  Aggregating results for k=4 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          85.39%     0.44%    75
  restricted_standard_mlp                                   83.99%     0.69%    75
  restricted_rownorm_mlp                                    84.36%     0.58%    75

  Framework Analysis (k=4):
    Part A (SGC+MLP - Restricted+Std): +1.406 pp
    Part B (RowNorm - Restricted+Std): +0.374 pp
    Remaining Gap:                     +1.033 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k4/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k4/diagnostics/fisher_diagnostic.json

================================================================================
K = 6
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.75e-10

  --- Split 2/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.75e-10

  --- Split 3/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.75e-10

  --- Split 4/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.75e-10

  --- Split 5/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.75e-10

  Aggregating results for k=6 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          84.44%     0.45%    75
  restricted_standard_mlp                                   83.10%     0.64%    75
  restricted_rownorm_mlp                                    83.49%     0.53%    75

  Framework Analysis (k=6):
    Part A (SGC+MLP - Restricted+Std): +1.342 pp
    Part B (RowNorm - Restricted+Std): +0.390 pp
    Remaining Gap:                     +0.951 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k6/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k6/diagnostics/fisher_diagnostic.json

================================================================================
K = 8
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.83e-10

  --- Split 2/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.83e-10

  --- Split 3/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.83e-10

  --- Split 4/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.83e-10

  --- Split 5/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.83e-10

  Aggregating results for k=8 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          84.07%     0.45%    75
  restricted_standard_mlp                                   82.91%     0.60%    75
  restricted_rownorm_mlp                                    83.21%     0.51%    75

  Framework Analysis (k=8):
    Part A (SGC+MLP - Restricted+Std): +1.167 pp
    Part B (RowNorm - Restricted+Std): +0.305 pp
    Remaining Gap:                     +0.862 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k8/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k8/diagnostics/fisher_diagnostic.json

================================================================================
K = 10
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.93e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k10/training_curves/split0_dynamics.json

  --- Split 2/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.93e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k10/training_curves/split1_dynamics.json

  --- Split 3/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.93e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k10/training_curves/split2_dynamics.json

  --- Split 4/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.93e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k10/training_curves/split3_dynamics.json

  --- Split 5/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.93e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k10/training_curves/split4_dynamics.json

  Aggregating results for k=10 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          83.78%     0.44%    75
  restricted_standard_mlp                                   82.77%     0.59%    75
  restricted_rownorm_mlp                                    83.11%     0.49%    75
  log_magnitude                                             83.50%     0.38%    75
  dual_stream                                               83.52%     0.37%    75
  spectral_rownorm_alpha-1.0                                83.30%     0.37%    75
  spectral_rownorm_alpha-0.5                                83.30%     0.37%    75
  spectral_rownorm_alpha0.0                                 83.33%     0.36%    75
  spectral_rownorm_alpha0.5                                 83.37%     0.41%    75
  spectral_rownorm_alpha1.0                                 83.24%     0.41%    75
  nested_spheres_a-1.0_b-1.0                                83.33%     0.43%    75
  nested_spheres_a-1.0_b-0.5                                83.30%     0.42%    75
  nested_spheres_a-1.0_b0.0                                 83.31%     0.37%    75
  nested_spheres_a-1.0_b0.5                                 83.28%     0.41%    75
  nested_spheres_a-1.0_b1.0                                 83.33%     0.40%    75
  nested_spheres_a-0.5_b-1.0                                83.40%     0.36%    75
  nested_spheres_a-0.5_b-0.5                                83.39%     0.35%    75
  nested_spheres_a-0.5_b0.0                                 83.30%     0.35%    75
  nested_spheres_a-0.5_b0.5                                 83.40%     0.30%    75
  nested_spheres_a-0.5_b1.0                                 83.45%     0.40%    75
  nested_spheres_a0.0_b-1.0                                 83.52%     0.40%    75
  nested_spheres_a0.0_b-0.5                                 83.46%     0.37%    75
  nested_spheres_a0.0_b0.0                                  83.32%     0.41%    75
  nested_spheres_a0.0_b0.5                                  83.46%     0.38%    75
  nested_spheres_a0.0_b1.0                                  83.50%     0.38%    75
  nested_spheres_a0.5_b-1.0                                 83.53%     0.39%    75
  nested_spheres_a0.5_b-0.5                                 83.50%     0.41%    75
  nested_spheres_a0.5_b0.0                                  83.32%     0.42%    75
  nested_spheres_a0.5_b0.5                                  83.50%     0.40%    75
  nested_spheres_a0.5_b1.0                                  83.59%     0.35%    75
  nested_spheres_a1.0_b-1.0                                 83.52%     0.37%    75
  nested_spheres_a1.0_b-0.5                                 83.45%     0.38%    75
  nested_spheres_a1.0_b0.0                                  83.28%     0.41%    75
  nested_spheres_a1.0_b0.5                                  83.45%     0.39%    75
  nested_spheres_a1.0_b1.0                                  83.53%     0.41%    75

  Framework Analysis (k=10):
    Part A (SGC+MLP - Restricted+Std): +1.009 pp
    Part B (RowNorm - Restricted+Std): +0.336 pp
    Remaining Gap:                     +0.673 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k10/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k10/diagnostics/fisher_diagnostic.json

================================================================================
K = 12
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.90e-10

  --- Split 2/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.90e-10

  --- Split 3/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.90e-10

  --- Split 4/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.90e-10

  --- Split 5/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=1.90e-10

  Aggregating results for k=12 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          83.56%     0.43%    75
  restricted_standard_mlp                                   82.82%     0.57%    75
  restricted_rownorm_mlp                                    83.07%     0.54%    75

  Framework Analysis (k=12):
    Part A (SGC+MLP - Restricted+Std): +0.740 pp
    Part B (RowNorm - Restricted+Std): +0.252 pp
    Remaining Gap:                     +0.488 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k12/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k12/diagnostics/fisher_diagnostic.json

================================================================================
K = 20
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=2.07e-10

  --- Split 2/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=2.07e-10

  --- Split 3/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=2.07e-10

  --- Split 4/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=2.07e-10

  --- Split 5/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=2.07e-10

  Aggregating results for k=20 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          83.09%     0.48%    75
  restricted_standard_mlp                                   82.97%     0.52%    75
  restricted_rownorm_mlp                                    83.04%     0.49%    75

  Framework Analysis (k=20):
    Part A (SGC+MLP - Restricted+Std): +0.123 pp
    Part B (RowNorm - Restricted+Std): +0.072 pp
    Remaining Gap:                     +0.051 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k20/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k20/diagnostics/fisher_diagnostic.json

================================================================================
K = 30
================================================================================
  X_diffused shape: (19717, 500)

  --- Split 1/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=2.09e-10

  --- Split 2/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=2.09e-10

  --- Split 3/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=2.09e-10

  --- Split 4/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=2.09e-10

  --- Split 5/5 (train=11830, val=3943, test=3944) ---
  Computing restricted eigenvectors...
  d_effective=500, ortho_error=2.09e-10

  Aggregating results for k=30 (5 splits x 15 seeds = 75 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          82.70%     0.41%    75
  restricted_standard_mlp                                   83.11%     0.54%    75
  restricted_rownorm_mlp                                    83.06%     0.40%    75

  Framework Analysis (k=30):
    Part A (SGC+MLP - Restricted+Std): -0.413 pp
    Part B (RowNorm - Restricted+Std): -0.057 pp
    Remaining Gap:                     -0.356 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k30/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/k30/diagnostics/fisher_diagnostic.json

================================================================================
MASTER TRAINING EXPERIMENT COMPLETE
================================================================================
Results saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc
[2/2] Analytics: pubmed random
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER ANALYTICS (Exp 2 + Exp 8)
================================================================================
Dataset:       pubmed
Split type:    random
Component:     lcc
k values:      [1, 2, 4, 6, 8, 10, 12, 20, 30]
Results dir:   /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc
================================================================================

[Step 1] Loading dataset and graph...
Nodes: 19,717, Features: 500, Classes: 3

[Step 2] Extracting LCC...
After LCC: nodes=19,717, classes=3

================================================================================
EXP 2: SPECTRAL ANALYSIS (all k values)
================================================================================

  k=1:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=1.2808332172653536e-10
    Condition U=2.8479  Condition X=64.9533  Separability=0.0495  SpanErr=1.55e-01
    Var ratio U=4.42  Var ratio X=78.46  Reduction=17.75x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/analytics/exp2_spectral_analysis_k1.json

  k=2:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=1.2347300959447693e-10
    Condition U=2.7967  Condition X=110.8063  Separability=0.0602  SpanErr=1.59e-01
    Var ratio U=4.61  Var ratio X=112.92  Reduction=24.50x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/analytics/exp2_spectral_analysis_k2.json

  k=4:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=1.5269252529037658e-10
    Condition U=2.9764  Condition X=221.0482  Separability=0.0623  SpanErr=2.28e-01
    Var ratio U=3.41  Var ratio X=202.13  Reduction=59.20x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/analytics/exp2_spectral_analysis_k4.json

  k=6:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=1.7536239127480258e-10
    Condition U=3.1422  Condition X=345.8158  Separability=0.0660  SpanErr=2.69e-01
    Var ratio U=4.03  Var ratio X=251.94  Reduction=62.59x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/analytics/exp2_spectral_analysis_k6.json

  k=8:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=1.827447082547451e-10
    Condition U=3.2771  Condition X=498.9820  Separability=0.0707  SpanErr=3.01e-01
    Var ratio U=5.45  Var ratio X=283.78  Reduction=52.07x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/analytics/exp2_spectral_analysis_k8.json

  k=10:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=1.9289214669981902e-10
    Condition U=3.3779  Condition X=696.3292  Separability=0.0755  SpanErr=3.28e-01
    Var ratio U=6.03  Var ratio X=305.52  Reduction=50.66x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/analytics/exp2_spectral_analysis_k10.json

  k=12:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=1.899543855543584e-10
    Condition U=3.4577  Condition X=952.0900  Separability=0.0800  SpanErr=3.53e-01
    Var ratio U=6.79  Var ratio X=320.03  Reduction=47.14x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/analytics/exp2_spectral_analysis_k12.json

  k=20:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=2.0747326079373352e-10
    Condition U=4.8239  Condition X=2983.9924  Separability=0.0946  SpanErr=4.35e-01
    Var ratio U=8.74  Var ratio X=333.19  Reduction=38.11x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/analytics/exp2_spectral_analysis_k20.json

  k=30:
    WARNING: no cached matrices found, recomputing...
    d_effective=500, ortho_error=2.0932788835636984e-10
    Condition U=6.9990  Condition X=11406.3979  Separability=0.1070  SpanErr=5.14e-01
    Var ratio U=10.10  Var ratio X=311.99  Reduction=30.89x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/analytics/exp2_spectral_analysis_k30.json

================================================================================
EXP 8: k-SENSITIVITY ANALYSIS
================================================================================

     k    SGC+MLP      R+Std       R+RN     Part A     Part B    Rem.Gap     Fisher   n_runs
  -----------------------------------------------------------------------------------------------
     1     87.47%     86.65%     86.14%     +0.821     -0.503     +1.323    0.02632       75
     2     87.41%     86.42%     86.72%     +0.987     +0.293     +0.693    0.02479       75
     4     85.39%     83.99%     84.36%     +1.406     +0.374     +1.033    0.02232       75
     6     84.44%     83.10%     83.49%     +1.342     +0.391     +0.951    0.02314       75
     8     84.07%     82.91%     83.21%     +1.167     +0.305     +0.862    0.02376       75
    10     83.78%     82.77%     83.11%     +1.009     +0.336     +0.673    0.02407       75
    12     83.56%     82.82%     83.07%     +0.740     +0.252     +0.488    0.02420       75
    20     83.09%     82.97%     83.04%     +0.123     +0.072     +0.051    0.02436       75
    30     82.70%     83.11%     83.06%     -0.413     -0.057     -0.356    0.02460       75

  Saved JSON: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/analytics/exp8_k_sensitivity.json
  Saved CSV:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/analytics/exp8_k_sensitivity.csv

================================================================================
MASTER ANALYTICS COMPLETE
================================================================================
Analytics saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/pubmed_random_lcc/analytics
   pubmed complete  |  Mon Feb 23 06:39:53 AM EST 2026

--------------------------------------------------------
 DATASET: coauthor-physics  |  Mon Feb 23 06:39:53 AM EST 2026
--------------------------------------------------------
[1/2] Training: coauthor-physics fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER TRAINING EXPERIMENT
================================================================================
Dataset:      coauthor-physics
k values:     [1, 2, 4, 6, 8, 10, 12, 20, 30]
Split type:   fixed  (1 split(s) x 15 seeds)
Component:    lcc
Device:       cuda
Output base:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc
================================================================================

[Step 1] Loading dataset...
Creating 60/20/20 split for coauthor-physics...
Nodes: 34,493, Features: 8415, Classes: 5

[Step 2] Building graph matrices...

[Step 3] Extracting largest connected component...
Rebuilding graph matrices for LCC...
After step 3: nodes=34,493, classes=5, disconnected_components_to_skip=0

[Step 4] Preparing splits...
Fixed split: Train=20695, Val=6898, Test=6900

[Step 5] Computing SGC normalized adjacency...
A_sgc = D^{-1/2}(A+I)D^{-1/2}

================================================================================
K = 1
================================================================================
  X_diffused shape: (34493, 8415)

  --- Split 1/1 (train=20695, val=6898, test=6900) ---
  Computing restricted eigenvectors...
  d_effective=7697, ortho_error=5.81e-10

  Aggregating results for k=1 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          95.55%     0.10%    15
  restricted_standard_mlp                                   88.69%     2.05%    15
  restricted_rownorm_mlp                                    92.10%     0.66%    15

  Framework Analysis (k=1):
    Part A (SGC+MLP - Restricted+Std): +6.856 pp
    Part B (RowNorm - Restricted+Std): +3.413 pp
    Remaining Gap:                     +3.443 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k1/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k1/diagnostics/fisher_diagnostic.json

================================================================================
K = 2
================================================================================
  X_diffused shape: (34493, 8415)

  --- Split 1/1 (train=20695, val=6898, test=6900) ---
  Computing restricted eigenvectors...
  d_effective=7697, ortho_error=5.86e-10

  Aggregating results for k=2 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          95.50%     0.13%    15
  restricted_standard_mlp                                   89.34%     1.18%    15
  restricted_rownorm_mlp                                    91.85%     0.68%    15

  Framework Analysis (k=2):
    Part A (SGC+MLP - Restricted+Std): +6.152 pp
    Part B (RowNorm - Restricted+Std): +2.502 pp
    Remaining Gap:                     +3.649 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k2/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k2/diagnostics/fisher_diagnostic.json

================================================================================
K = 4
================================================================================
  X_diffused shape: (34493, 8415)

  --- Split 1/1 (train=20695, val=6898, test=6900) ---
  Computing restricted eigenvectors...
  d_effective=7697, ortho_error=5.39e-10

  Aggregating results for k=4 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          95.30%     0.05%    15
  restricted_standard_mlp                                   85.89%     2.34%    15
  restricted_rownorm_mlp                                    89.90%     1.08%    15

  Framework Analysis (k=4):
    Part A (SGC+MLP - Restricted+Std): +9.415 pp
    Part B (RowNorm - Restricted+Std): +4.014 pp
    Remaining Gap:                     +5.402 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k4/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k4/diagnostics/fisher_diagnostic.json

================================================================================
K = 6
================================================================================
  X_diffused shape: (34493, 8415)

  --- Split 1/1 (train=20695, val=6898, test=6900) ---
  Computing restricted eigenvectors...
  d_effective=7697, ortho_error=5.24e-10

  Aggregating results for k=6 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          95.06%     0.14%    15
  restricted_standard_mlp                                   86.10%     1.58%    15
  restricted_rownorm_mlp                                    89.28%     1.11%    15

  Framework Analysis (k=6):
    Part A (SGC+MLP - Restricted+Std): +8.969 pp
    Part B (RowNorm - Restricted+Std): +3.182 pp
    Remaining Gap:                     +5.787 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k6/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k6/diagnostics/fisher_diagnostic.json

================================================================================
K = 8
================================================================================
  X_diffused shape: (34493, 8415)

  --- Split 1/1 (train=20695, val=6898, test=6900) ---
  Computing restricted eigenvectors...
  d_effective=7697, ortho_error=5.19e-10

  Aggregating results for k=8 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          95.00%     0.11%    15
  restricted_standard_mlp                                   86.64%     1.12%    15
  restricted_rownorm_mlp                                    87.96%     0.94%    15

  Framework Analysis (k=8):
    Part A (SGC+MLP - Restricted+Std): +8.359 pp
    Part B (RowNorm - Restricted+Std): +1.320 pp
    Remaining Gap:                     +7.040 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k8/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k8/diagnostics/fisher_diagnostic.json

================================================================================
K = 10
================================================================================
  X_diffused shape: (34493, 8415)

  --- Split 1/1 (train=20695, val=6898, test=6900) ---
  Computing restricted eigenvectors...
  d_effective=7697, ortho_error=5.18e-10
  Saved dynamics: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k10/training_curves/split0_dynamics.json

  Aggregating results for k=10 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          94.88%     0.11%    15
  restricted_standard_mlp                                   86.86%     1.10%    15
  restricted_rownorm_mlp                                    88.69%     1.10%    15
  log_magnitude                                             89.19%     0.25%    15
  dual_stream                                               89.46%     0.36%    15
  spectral_rownorm_alpha-1.0                                94.32%     0.15%    15
  spectral_rownorm_alpha-0.5                                92.67%     0.16%    15
  spectral_rownorm_alpha0.0                                 89.13%     0.29%    15
  spectral_rownorm_alpha0.5                                 85.95%     0.27%    15
  spectral_rownorm_alpha1.0                                 84.81%     0.31%    15
  nested_spheres_a-1.0_b-1.0                                94.41%     0.09%    15
  nested_spheres_a-1.0_b-0.5                                94.39%     0.10%    15
  nested_spheres_a-1.0_b0.0                                 94.26%     0.16%    15
  nested_spheres_a-1.0_b0.5                                 94.36%     0.10%    15
  nested_spheres_a-1.0_b1.0                                 94.36%     0.08%    15
  nested_spheres_a-0.5_b-1.0                                93.14%     0.12%    15
  nested_spheres_a-0.5_b-0.5                                93.13%     0.14%    15
  nested_spheres_a-0.5_b0.0                                 92.55%     0.20%    15
  nested_spheres_a-0.5_b0.5                                 93.13%     0.14%    15
  nested_spheres_a-0.5_b1.0                                 93.12%     0.15%    15
  nested_spheres_a0.0_b-1.0                                 89.22%     0.13%    15
  nested_spheres_a0.0_b-0.5                                 89.35%     0.19%    15
  nested_spheres_a0.0_b0.0                                  89.16%     0.42%    15
  nested_spheres_a0.0_b0.5                                  89.32%     0.20%    15
  nested_spheres_a0.0_b1.0                                  89.19%     0.25%    15
  nested_spheres_a0.5_b-1.0                                 84.00%     0.80%    15
  nested_spheres_a0.5_b-0.5                                 84.73%     0.99%    15
  nested_spheres_a0.5_b0.0                                  85.84%     0.45%    15
  nested_spheres_a0.5_b0.5                                  85.24%     0.38%    15
  nested_spheres_a0.5_b1.0                                  84.10%     0.78%    15
  nested_spheres_a1.0_b-1.0                                 80.78%     1.31%    15
  nested_spheres_a1.0_b-0.5                                 82.93%     1.66%    15
  nested_spheres_a1.0_b0.0                                  84.78%     0.37%    15
  nested_spheres_a1.0_b0.5                                  81.35%     1.91%    15
  nested_spheres_a1.0_b1.0                                  80.77%     1.11%    15

  Framework Analysis (k=10):
    Part A (SGC+MLP - Restricted+Std): +8.021 pp
    Part B (RowNorm - Restricted+Std): +1.838 pp
    Remaining Gap:                     +6.184 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k10/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k10/diagnostics/fisher_diagnostic.json

================================================================================
K = 12
================================================================================
  X_diffused shape: (34493, 8415)

  --- Split 1/1 (train=20695, val=6898, test=6900) ---
  Computing restricted eigenvectors...
  d_effective=7697, ortho_error=5.17e-10

  Aggregating results for k=12 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          94.80%     0.13%    15
  restricted_standard_mlp                                   86.32%     0.99%    15
  restricted_rownorm_mlp                                    88.65%     1.24%    15

  Framework Analysis (k=12):
    Part A (SGC+MLP - Restricted+Std): +8.480 pp
    Part B (RowNorm - Restricted+Std): +2.324 pp
    Remaining Gap:                     +6.157 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k12/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k12/diagnostics/fisher_diagnostic.json

================================================================================
K = 20
================================================================================
  X_diffused shape: (34493, 8415)

  --- Split 1/1 (train=20695, val=6898, test=6900) ---
  Computing restricted eigenvectors...
  d_effective=7264, ortho_error=5.12e-10

  Aggregating results for k=20 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          94.56%     0.15%    15
  restricted_standard_mlp                                   88.31%     1.10%    15
  restricted_rownorm_mlp                                    88.41%     1.39%    15

  Framework Analysis (k=20):
    Part A (SGC+MLP - Restricted+Std): +6.256 pp
    Part B (RowNorm - Restricted+Std): +0.100 pp
    Remaining Gap:                     +6.157 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k20/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k20/diagnostics/fisher_diagnostic.json

================================================================================
K = 30
================================================================================
  X_diffused shape: (34493, 8415)

  --- Split 1/1 (train=20695, val=6898, test=6900) ---
  Computing restricted eigenvectors...
  d_effective=4968, ortho_error=4.85e-10

  Aggregating results for k=30 (1 splits x 15 seeds = 15 runs/method)...

  Method                                                 Test Acc       Std     n
  ------------------------------------------------------------------------------
  sgc_mlp_baseline                                          94.05%     0.16%    15
  restricted_standard_mlp                                   91.16%     0.65%    15
  restricted_rownorm_mlp                                    91.40%     0.30%    15

  Framework Analysis (k=30):
    Part A (SGC+MLP - Restricted+Std): +2.891 pp
    Part B (RowNorm - Restricted+Std): +0.236 pp
    Remaining Gap:                     +2.655 pp

  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k30/metrics/results.json
  Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/k30/diagnostics/fisher_diagnostic.json

================================================================================
MASTER TRAINING EXPERIMENT COMPLETE
================================================================================
Results saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc
[2/2] Analytics: coauthor-physics fixed
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
================================================================================
MASTER ANALYTICS (Exp 2 + Exp 8)
================================================================================
Dataset:       coauthor-physics
Split type:    fixed
Component:     lcc
k values:      [1, 2, 4, 6, 8, 10, 12, 20, 30]
Results dir:   /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc
================================================================================

[Step 1] Loading dataset and graph...
Creating 60/20/20 split for coauthor-physics...
Nodes: 34,493, Features: 8415, Classes: 5

[Step 2] Extracting LCC...
After LCC: nodes=34,493, classes=5

================================================================================
EXP 2: SPECTRAL ANALYSIS (all k values)
================================================================================

  k=1:
    WARNING: no cached matrices found, recomputing...
    d_effective=7697, ortho_error=5.807385683453958e-10
    Condition U=662.8935  Condition X=inf  Separability=0.0301  SpanErr=1.43e-01
    Var ratio U=9.85  Var ratio X=113931447101.79  Reduction=11572463043.15x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/analytics/exp2_spectral_analysis_k1.json

  k=2:
    WARNING: no cached matrices found, recomputing...
    d_effective=7697, ortho_error=5.863356467017411e-10
    Condition U=456.1601  Condition X=inf  Separability=0.0307  SpanErr=1.37e-01
    Var ratio U=14.11  Var ratio X=99705997021.58  Reduction=7064960535.58x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/analytics/exp2_spectral_analysis_k2.json

  k=4:
    WARNING: no cached matrices found, recomputing...
    d_effective=7697, ortho_error=5.388897106328727e-10
    Condition U=805.0113  Condition X=inf  Separability=0.0302  SpanErr=1.68e-01
    Var ratio U=27.54  Var ratio X=85834495185.52  Reduction=3117233197.57x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/analytics/exp2_spectral_analysis_k4.json

  k=6:
    WARNING: no cached matrices found, recomputing...
    d_effective=7697, ortho_error=5.244266132464759e-10
    Condition U=599.1430  Condition X=inf  Separability=0.0302  SpanErr=1.96e-01
    Var ratio U=37.36  Var ratio X=76617914467.08  Reduction=2050736573.16x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/analytics/exp2_spectral_analysis_k6.json

  k=8:
    WARNING: no cached matrices found, recomputing...
    d_effective=7697, ortho_error=5.193449004181616e-10
    Condition U=761.3918  Condition X=inf  Separability=0.0303  SpanErr=2.19e-01
    Var ratio U=39.93  Var ratio X=69234964692.68  Reduction=1734028763.09x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/analytics/exp2_spectral_analysis_k8.json

  k=10:
    WARNING: no cached matrices found, recomputing...
    d_effective=7697, ortho_error=5.175198047879803e-10
    Condition U=809.4802  Condition X=inf  Separability=0.0303  SpanErr=2.38e-01
    Var ratio U=104.04  Var ratio X=62955541026.81  Reduction=605080031.97x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/analytics/exp2_spectral_analysis_k10.json

  k=12:
    WARNING: no cached matrices found, recomputing...
    d_effective=7697, ortho_error=5.173373951450344e-10
    Condition U=807.8270  Condition X=inf  Separability=0.0303  SpanErr=2.55e-01
    Var ratio U=44.13  Var ratio X=57472555344.88  Reduction=1302395911.46x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/analytics/exp2_spectral_analysis_k12.json

  k=20:
    WARNING: no cached matrices found, recomputing...
    d_effective=7264, ortho_error=5.121186807954814e-10
    Condition U=763.5556  Condition X=inf  Separability=0.0311  SpanErr=3.19e-01
    Var ratio U=70.61  Var ratio X=40905002585.72  Reduction=579310546.42x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/analytics/exp2_spectral_analysis_k20.json

  k=30:
    WARNING: no cached matrices found, recomputing...
    d_effective=4968, ortho_error=4.851697932295451e-10
    Condition U=910.4257  Condition X=inf  Separability=0.0374  SpanErr=4.14e-01
    Var ratio U=174.42  Var ratio X=27854869394.09  Reduction=159695477.00x
    Saved: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/analytics/exp2_spectral_analysis_k30.json

================================================================================
EXP 8: k-SENSITIVITY ANALYSIS
================================================================================

     k    SGC+MLP      R+Std       R+RN     Part A     Part B    Rem.Gap     Fisher   n_runs
  -----------------------------------------------------------------------------------------------
     1     95.55%     88.69%     92.10%     +6.856     +3.413     +3.443    0.53662       15
     2     95.50%     89.34%     91.85%     +6.152     +2.502     +3.649    0.47120       15
     4     95.30%     85.89%     89.90%     +9.415     +4.013     +5.402    0.37483       15
     6     95.06%     86.10%     89.28%     +8.969     +3.182     +5.787    0.32806       15
     8     95.00%     86.64%     87.96%     +8.359     +1.320     +7.040    0.30307       15
    10     94.88%     86.86%     88.69%     +8.021     +1.838     +6.184    0.28897       15
    12     94.80%     86.32%     88.65%     +8.480     +2.324     +6.157    0.28057       15
    20     94.56%     88.31%     88.41%     +6.256     +0.100     +6.157    0.26131       15
    30     94.05%     91.16%     91.40%     +2.891     +0.236     +2.655    0.25349       15

  Saved JSON: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/analytics/exp8_k_sensitivity.json
  Saved CSV:  /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/analytics/exp8_k_sensitivity.csv

================================================================================
MASTER ANALYTICS COMPLETE
================================================================================
Analytics saved to: /home/md724/Spectral-Basis/PAPER_EXPERIMENTS/PAPER_RESULTS/coauthor-physics_fixed_lcc/analytics
[1/2] Training: coauthor-physics random
/home/md724/Spectral-Basis/venv/lib/python3.12/site-packages/outdated/__init__.py:36: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
